!function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=27)}([,,function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}},,,function(t,e,n){!function(t,e,n,s){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=i(e),r=i(n),a=i(s),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},h=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},u=function(t,e){return{startTime:e,type:"setValue",value:t}},l=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},d=function(t,e,n){var s=n.startTime,i=n.target,o=n.timeConstant;return i+(e-i)*Math.exp((s-t)/o)},p=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return p(t)||f(t)},_=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},y=function t(e,n,s,i){var o=e[n];return void 0===o?i:m(o)||_(o)?o.value:g(o)?o.values[o.values.length-1]:d(s,t(e,n-1,o.startTime,i),o)},v=function(t,e,n,s,i){return void 0===n?[s.insertTime,i]:m(n)?[n.endTime,n.value]:_(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(t,e-1,n.startTime,i)]},x=function(t){return"cancelAndHold"===t.type},b=function(t){return"cancelScheduledValues"===t.type},w=function(t){return x(t)||b(t)?t.cancelTime:p(t)||f(t)?t.endTime:t.startTime},T=function(t,e,n,s){var i=s.endTime,o=s.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(t-e)/(i-e)):0},M=function(t,e,n,s){return n+(t-e)/(s.endTime-e)*(s.value-n)},S=function(t,e){var n=e.duration,s=e.startTime,i=e.values;return function(t,e){var n=Math.floor(e),s=Math.ceil(e);return n===s?t[n]:(1-(e-n))*t[n]+(1-(s-e))*t[s]}(i,(t-s)/n*(i.length-1))},A=function(t){return"setTarget"===t.type},k=function(){function t(e){r.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=w(t);if(x(t)||b(t)){var n=this._automationEvents.findIndex((function(n){return b(t)&&g(n)?n.startTime+n.duration>=e:w(n)>=e})),s=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),x(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==s&&m(s)){if(A(i))throw new Error("The internal list is malformed.");var o=g(i)?i.startTime+i.duration:w(i),r=g(i)?i.values[i.values.length-1]:i.value,a=p(s)?T(e,o,r,s):M(e,o,r,s),d=p(s)?c(a,e,this._currenTime):h(a,e,this._currenTime);this._automationEvents.push(d)}void 0!==i&&A(i)&&this._automationEvents.push(u(this.getValue(e),e)),void 0!==i&&g(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=l(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var _=this._automationEvents.findIndex((function(t){return w(t)>e})),y=-1===_?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[_-1];if(void 0!==y&&g(y)&&w(y)+y.duration>e)return!1;var v=p(t)?c(t.value,t.endTime,this._currenTime):f(t)?h(t.value,e,this._currenTime):t;if(-1===_)this._automationEvents.push(v);else{if(g(t)&&e+t.duration>w(this._automationEvents[_]))return!1;this._automationEvents.splice(_,0,v)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return w(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),s=n[0];A(s)&&n.unshift(u(y(this._automationEvents,e-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(e){return w(e)>t})),s=this._automationEvents[n],i=w(e)<=t?e:this._automationEvents[n-1];if(void 0!==i&&A(i)&&(void 0===s||!m(s)||s.insertTime>t))return d(t,y(this._automationEvents,n-2,i.startTime,this._defaultValue),i);if(void 0!==i&&_(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==i&&g(i)&&(void 0===s||!m(s)||i.startTime+i.duration>t))return t<i.startTime+i.duration?S(t,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==s&&p(s)){var r=v(this._automationEvents,n-1,i,s,this._defaultValue),a=o.default(r,2),c=a[0],h=a[1];return T(t,c,h,s)}if(void 0!==s&&f(s)){var u=v(this._automationEvents,n-1,i,s,this._defaultValue),l=o.default(u,2),x=l[0],b=l[1];return M(t,x,b,s)}return this._defaultValue}}]),t}();t.AutomationEventList=k,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=u,t.createSetValueCurveAutomationEvent=l,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(22),n(2),n(3))},,function(t,e,n){!function(t,e){for(var n in e)t[n]=e[n]}(e,function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNote=function(t){return/^[a-gA-G](?:#|b)?\d$/.test(t)},e.expandStr=function(t){return t=(t=(t=(t=JSON.stringify(t.split(""))).replace(/,"\[",/g,", [")).replace(/"\[",/g,"[")).replace(/,"\]"/g,"]"),JSON.parse(t)},e.shuffle=function(t){var e=t.length-1;return t.forEach((function(n,s){var i=Math.round(Math.random()*e);t[s]=t[i],t[i]=n})),t},e.sizzleMap=function(t){void 0===t&&(t=127);var e=Math.PI,n=[e/6,e/4,e/3,e/2,2*e/3,3*e/4,5*e/6,e],s=[0,e/6,e/4,e/3,e/2,2*e/3,3*e/4,5*e/6];return s.reverse(),n.concat(s).map((function(e){return Math.round(Math.sin(e)*t)}))},e.pickOne=function(t){return t.length>1?t[Math.round(Math.random())]:t[0]},e.dice=function(){return!!Math.round(Math.random())},e.flat=function(t){return t.reduce((function(t,e){return t.concat(e)}),[])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),i=n(0),o=s.ChordType.all(),r=i.flat(o.map((function(t){return t.aliases.concat([t.name])}))).filter(Boolean);e.getChord=function(t){if(i.isNote(t))throw new Error(t+" is not a chord!");var e=t.split("-"),n=s.Chord.tokenize(e[0]),o=n[0],r=n[1];"4"!==o[1]&&"5"!==o[1]||(r=o[1],o=o.replace(/\d/,""));var a={"4th":"4","5th":"5","7th":"7","9th":"9","11th":"11","13th":"13"};if(a[r]&&(r=a[r]),!s.ChordType.get(r))throw new TypeError("Invalid chord name: "+r);var c=s.Chord.get(o+r),h=o+(e[1]||4);return(c.intervals||[]).map((function(t){var e=s.Note.transpose(h,t);return s.Note.simplify(e)}))},e.chords=function(){var t={4:"4th",5:"5th",7:"7th",9:"9th",11:"11th",13:"13th"};return r.map((function(e){return/^\d+$/.test(e)&&t[e]?t[e]:e}))},e.addChord=function(t,e,n){s.ChordType.add(t,e,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(5);e.getScale=function(t){t=(t=(t=t&&t.toLowerCase()).replace("#5p","#5P")).replace("#7m","#7M");var e=s.Scale.tokenize(t)[1];if(!s.ScaleType.get(e))throw new Error(t+" does not exist!");return s.Scale.get(t).notes.map(s.Note.simplify)},e.scales=function(){return s.Scale.names()}},function(t,e,n){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(1),r="undefined"!=typeof window&&n(7).browserClip,a={"1m":2048,"2m":4096,"3m":6144,"4m":8192,"1n":512,"2n":256,"4n":128,"8n":64,"16n":32},c=function(t){if(i.isNote(t))return[t];if(Array.isArray(t))return t.forEach((function(t){if(!i.isNote(t))throw new TypeError("array must comprise valid notes")})),t;if(!Array.isArray(t)){var e=o.getChord(t);if(e&&e.length)return e}throw new Error("Chord "+t+" not found")};e.clip=function(t){if("string"==typeof(t=s(s({},{notes:["C4"],pattern:"x",shuffle:!1,sizzle:!1,sizzleReps:1,arpegiate:!1,subdiv:"4n",amp:100,accentLow:70,randomNotes:null,effects:[],offlineRendering:!1}),t||{})).notes&&(t.notes=t.notes.replace(/\s{2,}/g," "),t.notes=t.notes.split(" ")),t.notes=t.notes.map(c),/[^x\-_\[\]R]/.test(t.pattern))throw new TypeError("pattern can only comprise x - _ [ ], found "+t.pattern);if(t.shuffle&&(t.notes=i.shuffle(t.notes)),t.randomNotes&&"string"==typeof t.randomNotes&&(t.randomNotes=t.randomNotes.replace(/\s{2,}/g," ").split(/\s/)),t.randomNotes&&(t.randomNotes=t.randomNotes.map(c)),t.synth||t.instrument||t.sample||t.buffer||t.player||t.samples||t.sampler)return r(t);var e=[],n=0,o=function(s,i){s.forEach((function(s){if("string"==typeof s){var r=null;"x"===s&&(r=t.notes[n],n++),"R"===s&&(Math.round(Math.random())||t.randomNotes)&&(r=t.randomNotes?t.randomNotes[Math.round(Math.random()*(t.randomNotes.length-1))]:t.notes[n],n++),"x"!==s&&"-"!==s&&"R"!==s||e.push({note:r,length:i,level:"R"!==s||t.randomNotes?t.amp:t.accentLow}),"_"===s&&e.length&&(e[e.length-1].length+=i),n===t.notes.length&&(n=0)}Array.isArray(s)&&o(s,i/s.length)}))};if(o(i.expandStr(t.pattern),a[t.subdiv]||a["4n"]),t.sizzle){var h=[],u=!0===t.sizzle?"sin":t.sizzle,l=e.length,d=t.amp,p=t.sizzleReps,f=d/(l/p);if("sin"===u||"cos"===u)for(var m=0;m<l;m++){var _=Math[u](m*Math.PI/(l/p))*d;h.push(Math.round(Math.abs(_)))}if("rampUp"===u)for(_=0,m=0;m<l;m++)m%(l/p)==0?_=0:_+=f,h.push(Math.round(Math.abs(_)));if("rampDown"===u)for(_=d,m=0;m<l;m++)m%(l/p)==0?_=d:_-=f,h.push(Math.round(Math.abs(_)));for(m=0;m<h.length;m++)e[m].level=h[m]?h[m]:1}if(t.accent){if(/[^x\-]/.test(t.accent))throw new TypeError("Accent can only have x and - characters");for(var g=0,y=0,v=e;y<v.length;y++){var x=v[y];_="x"===t.accent[g]?t.amp:t.accentLow,t.sizzle&&(_=(x.level+_)/2),x.level=Math.round(_),(g+=1)===t.accent.length&&(g=0)}}return e}},function(t,e,n){(function(t){var n={};!function(t){var e=t.DEFAULT_VOLUME=90,n=(t.DEFAULT_DURATION=128,t.DEFAULT_CHANNEL=0,{midi_letter_pitches:{a:21,b:23,c:12,d:14,e:16,f:17,g:19},midiPitchFromNote:function(t){var e=/([a-g])(#+|b+)?([0-9]+)$/i.exec(t),s=e[1].toLowerCase(),i=e[2]||"";return 12*parseInt(e[3],10)+n.midi_letter_pitches[s]+("#"==i.substr(0,1)?1:-1)*i.length},ensureMidiPitch:function(t){return"number"!=typeof t&&/[^0-9]/.test(t)?n.midiPitchFromNote(t):parseInt(t,10)},midi_pitches_letter:{12:"c",13:"c#",14:"d",15:"d#",16:"e",17:"f",18:"f#",19:"g",20:"g#",21:"a",22:"a#",23:"b"},midi_flattened_notes:{"a#":"bb","c#":"db","d#":"eb","f#":"gb","g#":"ab"},noteFromMidiPitch:function(t,e){var s,i=0,o=t;return e=e||!1,t>23&&(o=t-12*(i=Math.floor(t/12)-1)),s=n.midi_pitches_letter[o],e&&s.indexOf("#")>0&&(s=n.midi_flattened_notes[s]),s+i},mpqnFromBpm:function(t){var e=Math.floor(6e7/t),n=[];do{n.unshift(255&e),e>>=8}while(e);for(;n.length<3;)n.push(0);return n},bpmFromMpqn:function(t){if(void 0!==t[0])for(var e=0,n=t.length-1;n>=0;++e,--n)t[e];return Math.floor(6e7/t)},codes2Str:function(t){return String.fromCharCode.apply(null,t)},str2Bytes:function(t,e){if(e)for(;t.length/2<e;)t="0"+t;for(var n=[],s=t.length-1;s>=0;s-=2){var i=0===s?t[s]:t[s-1]+t[s];n.unshift(parseInt(i,16))}return n},translateTickTime:function(t){for(var e=127&t;t>>=7;)e<<=8,e|=127&t|128;for(var n=[];n.push(255&e),128&e;)e>>=8;return n}}),s=function(t){if(!this)return new s(t);!t||null===t.type&&void 0===t.type||null===t.channel&&void 0===t.channel||null===t.param1&&void 0===t.param1||(this.setTime(t.time),this.setType(t.type),this.setChannel(t.channel),this.setParam1(t.param1),this.setParam2(t.param2))};s.NOTE_OFF=128,s.NOTE_ON=144,s.AFTER_TOUCH=160,s.CONTROLLER=176,s.PROGRAM_CHANGE=192,s.CHANNEL_AFTERTOUCH=208,s.PITCH_BEND=224,s.prototype.setTime=function(t){this.time=n.translateTickTime(t||0)},s.prototype.setType=function(t){if(t<s.NOTE_OFF||t>s.PITCH_BEND)throw new Error("Trying to set an unknown event: "+t);this.type=t},s.prototype.setChannel=function(t){if(t<0||t>15)throw new Error("Channel is out of bounds.");this.channel=t},s.prototype.setParam1=function(t){this.param1=t},s.prototype.setParam2=function(t){this.param2=t},s.prototype.toBytes=function(){var t=[],e=this.type|15&this.channel;return t.push.apply(t,this.time),t.push(e),t.push(this.param1),void 0!==this.param2&&null!==this.param2&&t.push(this.param2),t};var i=function(t){if(!this)return new i(t);this.setTime(t.time),this.setType(t.type),this.setData(t.data)};i.SEQUENCE=0,i.TEXT=1,i.COPYRIGHT=2,i.TRACK_NAME=3,i.INSTRUMENT=4,i.LYRIC=5,i.MARKER=6,i.CUE_POINT=7,i.CHANNEL_PREFIX=32,i.END_OF_TRACK=47,i.TEMPO=81,i.SMPTE=84,i.TIME_SIG=88,i.KEY_SIG=89,i.SEQ_EVENT=127,i.prototype.setTime=function(t){this.time=n.translateTickTime(t||0)},i.prototype.setType=function(t){this.type=t},i.prototype.setData=function(t){this.data=t},i.prototype.toBytes=function(){if(!this.type)throw new Error("Type for meta-event not specified.");var t=[];if(t.push.apply(t,this.time),t.push(255,this.type),Array.isArray(this.data))t.push(this.data.length),t.push.apply(t,this.data);else if("number"==typeof this.data)t.push(1,this.data);else if(null!==this.data&&void 0!==this.data){t.push(this.data.length);var e=this.data.split("").map((function(t){return t.charCodeAt(0)}));t.push.apply(t,e)}else t.push(0);return t};var o=function(t){if(!this)return new o(t);var e=t||{};this.events=e.events||[]};o.START_BYTES=[77,84,114,107],o.END_BYTES=[0,255,47,0],o.prototype.addEvent=function(t){return this.events.push(t),this},o.prototype.addNoteOn=o.prototype.noteOn=function(t,i,o,r){return this.events.push(new s({type:s.NOTE_ON,channel:t,param1:n.ensureMidiPitch(i),param2:r||e,time:o||0})),this},o.prototype.addNoteOff=o.prototype.noteOff=function(t,i,o,r){return this.events.push(new s({type:s.NOTE_OFF,channel:t,param1:n.ensureMidiPitch(i),param2:r||e,time:o||0})),this},o.prototype.addNote=o.prototype.note=function(t,e,n,s,i){return this.noteOn(t,e,s,i),n&&this.noteOff(t,e,n,i),this},o.prototype.addChord=o.prototype.chord=function(t,e,n,s){if(!Array.isArray(e)&&!e.length)throw new Error("Chord must be an array of pitches");return e.forEach((function(e){this.noteOn(t,e,0,s)}),this),e.forEach((function(e,s){0===s?this.noteOff(t,e,n):this.noteOff(t,e)}),this),this},o.prototype.setInstrument=o.prototype.instrument=function(t,e,n){return this.events.push(new s({type:s.PROGRAM_CHANGE,channel:t,param1:e,time:n||0})),this},o.prototype.setTempo=o.prototype.tempo=function(t,e){return this.events.push(new i({type:i.TEMPO,data:n.mpqnFromBpm(t),time:e||0})),this},o.prototype.toBytes=function(){var t=0,e=[],s=o.START_BYTES,i=o.END_BYTES;this.events.forEach((function(n){var s=n.toBytes();t+=s.length,e.push.apply(e,s)})),t+=i.length;var r=n.str2Bytes(t.toString(16),4);return s.concat(r,e,i)};var r=function(t){if(!this)return new r(t);var e=t||{};if(e.ticks){if("number"!=typeof e.ticks)throw new Error("Ticks per beat must be a number!");if(e.ticks<=0||e.ticks>=32768||e.ticks%1!=0)throw new Error("Ticks per beat must be an integer between 1 and 32767!")}this.ticks=e.ticks||128,this.tracks=e.tracks||[]};r.HDR_CHUNKID="MThd",r.HDR_CHUNK_SIZE="\0\0\0",r.HDR_TYPE0="\0\0",r.HDR_TYPE1="\0",r.prototype.addTrack=function(t){return t?(this.tracks.push(t),this):(t=new o,this.tracks.push(t),t)},r.prototype.toBytes=function(){var t=this.tracks.length.toString(16),e=r.HDR_CHUNKID+r.HDR_CHUNK_SIZE;return parseInt(t,16)>1?e+=r.HDR_TYPE1:e+=r.HDR_TYPE0,e+=n.codes2Str(n.str2Bytes(t,2)),e+=String.fromCharCode(this.ticks/256,this.ticks%256),this.tracks.forEach((function(t){e+=n.codes2Str(t.toBytes())})),e},t.Util=n,t.File=r,t.Track=o,t.Event=s,t.MetaEvent=i}(n),null!==t?t.exports=n:null!==e?e=n:this.Midi=n}).call(this,n(12)(t))},function(t,e,n){"use strict";n.r(e),n.d(e,"AbcNotation",(function(){return N})),n.d(e,"Array",(function(){return i})),n.d(e,"Chord",(function(){return Ft})),n.d(e,"ChordType",(function(){return vt})),n.d(e,"Collection",(function(){return X})),n.d(e,"accToAlt",(function(){return y})),n.d(e,"altToAcc",(function(){return g})),n.d(e,"coordToInterval",(function(){return O})),n.d(e,"coordToNote",(function(){return w})),n.d(e,"decode",(function(){return p})),n.d(e,"deprecate",(function(){return r})),n.d(e,"distance",(function(){return E})),n.d(e,"encode",(function(){return l})),n.d(e,"fillStr",(function(){return o})),n.d(e,"interval",(function(){return C})),n.d(e,"isNamed",(function(){return a})),n.d(e,"isPitch",(function(){return c})),n.d(e,"note",(function(){return v})),n.d(e,"stepToLetter",(function(){return _})),n.d(e,"tokenizeInterval",(function(){return A})),n.d(e,"tokenizeNote",(function(){return b})),n.d(e,"transpose",(function(){return P})),n.d(e,"Core",(function(){return s})),n.d(e,"DurationValue",(function(){return zt})),n.d(e,"Interval",(function(){return Xt})),n.d(e,"Key",(function(){return Ge})),n.d(e,"Midi",(function(){return ie})),n.d(e,"Mode",(function(){return Je})),n.d(e,"Note",(function(){return Te})),n.d(e,"Pcset",(function(){return ut})),n.d(e,"Progression",(function(){return Ke})),n.d(e,"Range",(function(){return en})),n.d(e,"RomanNumeral",(function(){return Ee})),n.d(e,"Scale",(function(){return rn})),n.d(e,"ScaleType",(function(){return Ot})),n.d(e,"TimeSignature",(function(){return dn})),n.d(e,"ChordDictionary",(function(){return mn})),n.d(e,"PcSet",(function(){return fn})),n.d(e,"ScaleDictionary",(function(){return _n})),n.d(e,"Tonal",(function(){return pn}));var s={};n.r(s),n.d(s,"accToAlt",(function(){return y})),n.d(s,"altToAcc",(function(){return g})),n.d(s,"coordToInterval",(function(){return O})),n.d(s,"coordToNote",(function(){return w})),n.d(s,"decode",(function(){return p})),n.d(s,"deprecate",(function(){return r})),n.d(s,"distance",(function(){return E})),n.d(s,"encode",(function(){return l})),n.d(s,"fillStr",(function(){return o})),n.d(s,"interval",(function(){return C})),n.d(s,"isNamed",(function(){return a})),n.d(s,"isPitch",(function(){return c})),n.d(s,"note",(function(){return v})),n.d(s,"stepToLetter",(function(){return _})),n.d(s,"tokenizeInterval",(function(){return A})),n.d(s,"tokenizeNote",(function(){return b})),n.d(s,"transpose",(function(){return P}));var i={};n.r(i),n.d(i,"compact",(function(){return z})),n.d(i,"permutations",(function(){return G})),n.d(i,"range",(function(){return j})),n.d(i,"rotate",(function(){return L})),n.d(i,"shuffle",(function(){return U})),n.d(i,"sortedNoteNames",(function(){return B})),n.d(i,"sortedUniqNoteNames",(function(){return W}));const o=(t,e)=>Array(Math.abs(e)+1).join(t);function r(t,e,n){return function(...s){return console.warn(`${t} is deprecated. Use ${e}.`),n.apply(this,s)}}function a(t){return null!==t&&"object"==typeof t&&"string"==typeof t.name}function c(t){return null!==t&&"object"==typeof t&&"number"==typeof t.step&&"number"==typeof t.alt}const h=[0,2,4,-1,1,3,5],u=h.map(t=>Math.floor(7*t/12));function l(t){const{step:e,alt:n,oct:s,dir:i=1}=t,o=h[e]+7*n;return void 0===s?[i*o]:[i*o,i*(s-u[e]-4*n)]}const d=[3,0,4,1,5,2,6];function p(t){const[e,n,s]=t,i=d[function(t){const e=(t+1)%7;return e<0?7+e:e}(e)],o=Math.floor((e+1)/7);return void 0===n?{step:i,alt:o,dir:s}:{step:i,alt:o,oct:n+4*o+u[i],dir:s}}const f={empty:!0,name:"",pc:"",acc:""},m=new Map,_=t=>"CDEFGAB".charAt(t),g=t=>t<0?o("b",-t):o("#",t),y=t=>"b"===t[0]?-t.length:t.length;function v(t){const e=m.get(t);if(e)return e;const n="string"==typeof t?function(t){const e=b(t);if(""===e[0]||""!==e[3])return f;const n=e[0],s=e[1],i=e[2],o=(n.charCodeAt(0)+3)%7,r=y(s),a=i.length?+i:void 0,c=l({step:o,alt:r,oct:a}),h=n+s+i,u=n+s,d=(T[o]+r+120)%12,p=void 0===a?(12,((T[o]+r)%12+12)%12-1188):T[o]+r+12*(a+1),m=p>=0&&p<=127?p:null;return{empty:!1,acc:s,alt:r,chroma:d,coord:c,freq:void 0===a?null:440*Math.pow(2,(p-69)/12),height:p,letter:n,midi:m,name:h,oct:a,pc:u,step:o}}(t):c(t)?v(function(t){const{step:e,alt:n,oct:s}=t,i=_(e);if(!i)return"";const o=i+g(n);return s||0===s?o+s:o}(t)):a(t)?v(t.name):f;return m.set(t,n),n}const x=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function b(t){const e=x.exec(t);return[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]}function w(t){return v(p(t))}const T=[0,2,4,5,7,9,11],M={empty:!0,name:"",acc:""},S=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$");function A(t){const e=S.exec(""+t);return null===e?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}const k={};function C(t){return"string"==typeof t?k[t]||(k[t]=function(t){const e=A(t);if(""===e[0])return M;const n=+e[0],s=e[1],i=(Math.abs(n)-1)%7,o="PMMPPMM"[i];if("M"===o&&"P"===s)return M;const r="M"===o?"majorable":"perfectable",a=""+n+s,c=n<0?-1:1,h=8===n||-8===n?n:c*(i+1),u=function(t,e){return"M"===e&&"majorable"===t||"P"===e&&"perfectable"===t?0:"m"===e&&"majorable"===t?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*("perfectable"===t?e.length:e.length+1):0}(r,s),d=Math.floor((Math.abs(n)-1)/7);return{empty:!1,name:a,num:n,q:s,step:i,alt:u,dir:c,type:r,simple:h,semitones:c*(D[i]+u+12*d),chroma:(c*(D[i]+u)%12+12)%12,coord:l({step:i,alt:u,oct:d,dir:c}),oct:d}}(t)):c(t)?C(function(t){const{step:e,alt:n,oct:s=0,dir:i}=t;return i?(i<0?"-":"")+(e+1+7*s)+function(t,e){return 0===e?"majorable"===t?"M":"P":-1===e&&"majorable"===t?"m":e>0?o("A",e):o("d","perfectable"===t?e:e+1)}("M"==="PMMPPMM"[e]?"majorable":"perfectable",n):""}(t)):a(t)?C(t.name):M}const D=[0,2,4,5,7,9,11];function O(t){const[e,n=0]=t;return C(p(7*e+12*n<0?[-e,-n,-1]:[e,n,1]))}function P(t,e){const n=v(t),s=C(e);if(n.empty||s.empty)return"";const i=n.coord,o=s.coord;return w(1===i.length?[i[0]+o[0]]:[i[0]+o[0],i[1]+o[1]]).name}function E(t,e){const n=v(t),s=v(e);if(n.empty||s.empty)return"";const i=n.coord,o=s.coord,r=o[0]-i[0];return O([r,2===i.length&&2===o.length?o[1]-i[1]:-Math.floor(7*r/12)]).name}const R=(t,e)=>Array(e+1).join(t),I=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function q(t){const e=I.exec(t);return e?[e[1],e[2],e[3]]:["","",""]}function F(t){const[e,n,s]=q(t);if(""===n)return"";let i=4;for(let t=0;t<s.length;t++)i+=","===s.charAt(t)?-1:1;const o="_"===e[0]?e.replace(/_/g,"b"):"^"===e[0]?e.replace(/\^/g,"#"):"";return n.charCodeAt(0)>96?n.toUpperCase()+o+(i+1):n+o+i}function V(t){const e=v(t);if(e.empty||!e.oct)return"";const{letter:n,acc:s,oct:i}=e;return("b"===s[0]?s.replace(/b/g,"_"):s.replace(/#/g,"^"))+(i>4?n.toLowerCase():n)+(5===i?"":i>4?R("'",i-5):R(",",4-i))}var N={abcToScientificNotation:F,scientificToAbcNotation:V,tokenize:q,transpose:function(t,e){return V(P(F(t),e))},distance:function(t,e){return E(F(t),F(e))}};function j(t,e){return t<e?function(t,e){const n=[];for(;e--;n[e]=e+t);return n}(t,e-t+1):function(t,e){const n=[];for(;e--;n[e]=t-e);return n}(t,t-e+1)}function L(t,e){const n=e.length,s=(t%n+n)%n;return e.slice(s,n).concat(e.slice(0,s))}function z(t){return t.filter(t=>0===t||t)}function B(t){return t.map(t=>v(t)).filter(t=>!t.empty).sort((t,e)=>t.height-e.height).map(t=>t.name)}function W(t){return B(t).filter((t,e,n)=>0===e||t!==n[e-1])}function U(t,e=Math.random){let n,s,i=t.length;for(;i;)n=Math.floor(e()*i--),s=t[i],t[i]=t[n],t[n]=s;return t}function G(t){return 0===t.length?[[]]:G(t.slice(1)).reduce((e,n)=>e.concat(t.map((e,s)=>{const i=n.slice();return i.splice(s,0,t[0]),i})),[])}function Y(t,e){return t<e?function(t,e){const n=[];for(;e--;n[e]=e+t);return n}(t,e-t+1):function(t,e){const n=[];for(;e--;n[e]=t-e);return n}(t,t-e+1)}function Q(t,e){const n=e.length,s=(t%n+n)%n;return e.slice(s,n).concat(e.slice(0,s))}function Z(t){return t.filter(t=>0===t||t)}var X={compact:Z,permutations:function t(e){return 0===e.length?[[]]:t(e.slice(1)).reduce((t,n)=>t.concat(e.map((t,s)=>{const i=n.slice();return i.splice(s,0,e[0]),i})),[])},range:Y,rotate:Q,shuffle:function(t,e=Math.random){let n,s,i=t.length;for(;i;)n=Math.floor(e()*i--),s=t[i],t[i]=t[n],t[n]=s;return t}};const H={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},$=t=>Number(t).toString(2),J=t=>parseInt(t,2),K=/^[01]{12}$/;function tt(t){return K.test(t)}const et={[H.chroma]:H};function nt(t){const e=tt(t)?t:"number"==typeof(n=t)&&n>=0&&n<=4095?$(t):Array.isArray(t)?function(t){if(0===t.length)return H.chroma;let e;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let s=0;s<t.length;s++)e=v(t[s]),e.empty&&(e=C(t[s])),e.empty||(n[e.chroma]=1);return n.join("")}(t):(t=>t&&tt(t.chroma))(t)?t.chroma:H.chroma;var n;return et[e]=et[e]||function(t){const e=J(t),n=function(t){const e=t.split("");return e.map((t,n)=>Q(n,e).join(""))}(t).map(J).filter(t=>t>=2048).sort()[0];return{empty:!1,name:"",setNum:e,chroma:t,normalized:$(n),intervals:ot(t)}}(e)}const st=r("Pcset.pcset","Pcset.get",nt),it=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function ot(t){const e=[];for(let n=0;n<12;n++)"1"===t.charAt(n)&&e.push(it[n]);return e}function rt(t,e=!0){const n=nt(t).chroma.split("");return Z(n.map((t,s)=>{const i=Q(s,n);return e&&"0"===i[0]?null:i.join("")}))}function at(t){const e=nt(t).setNum;return t=>{const n=nt(t).setNum;return e&&e!==n&&(n&e)===n}}function ct(t){const e=nt(t).setNum;return t=>{const n=nt(t).setNum;return e&&e!==n&&(n|e)===n}}function ht(t){const e=nt(t);return t=>{const n=v(t);return e&&!n.empty&&"1"===e.chroma.charAt(n.chroma)}}var ut={get:nt,chroma:t=>nt(t).chroma,num:t=>nt(t).setNum,intervals:t=>nt(t).intervals,chromas:function(){return Y(2048,4095).map($)},isSupersetOf:ct,isSubsetOf:at,isNoteIncludedIn:ht,isEqual:function(t,e){return nt(t).setNum===nt(e).setNum},filter:function(t){const e=ht(t);return t=>t.filter(e)},modes:rt,pcset:st};const lt={...H,name:"",quality:"Unknown",intervals:[],aliases:[]};let dt=[],pt={};function ft(t){return pt[t]||lt}const mt=r("ChordType.chordType","ChordType.get",ft);function _t(){return dt.slice()}const gt=r("ChordType.entries","ChordType.all",_t);function yt(t,e,n){const s=function(t){const e=e=>-1!==t.indexOf(e);return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}(t),i={...nt(t),name:n||"",quality:s,intervals:t,aliases:e};dt.push(i),i.name&&(pt[i.name]=i),pt[i.setNum]=i,pt[i.chroma]=i,i.aliases.forEach(t=>function(t,e){pt[e]=t}(i,t))}[["1P 3M 5P","major","M "],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth/ninth","6/9 69"],["1P 3M 5P 7M 11A","lydian","maj#4 Δ#4 Δ#11"],["1P 3M 6m 7M","major seventh flat sixth","M7b6"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ"],["1P 3m 5P 6M","minor sixth","m6"],["1P 3m 5P 7m 9M","minor ninth","m9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 13m","","Mb6"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5A","","m#5 m+ mb6"],["1P 3m 5P 6M 9M","","m69"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7M 9M","","mMaj9"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 6m 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]].forEach(([t,e,n])=>yt(t.split(" "),n.split(" "),e)),dt.sort((t,e)=>t.setNum-e.setNum);var vt={names:function(){return dt.map(t=>t.name).filter(t=>t)},symbols:function(){return dt.map(t=>t.aliases[0]).filter(t=>t)},get:ft,all:_t,add:yt,removeAll:function(){dt=[],pt={}},keys:function(){return Object.keys(pt)},entries:gt,chordType:mt};const xt={weight:0,name:""};const bt={...H,intervals:[],aliases:[]};let wt=[],Tt={};function Mt(){return wt.map(t=>t.name)}function St(t){return Tt[t]||bt}const At=r("ScaleDictionary.scaleType","ScaleType.get",St);function kt(){return wt.slice()}const Ct=r("ScaleDictionary.entries","ScaleType.all",kt);function Dt(t,e,n=[]){const s={...nt(t),name:e,intervals:t,aliases:n};return wt.push(s),Tt[s.name]=s,Tt[s.setNum]=s,Tt[s.chroma]=s,s.aliases.forEach(t=>function(t,e){Tt[e]=t}(s,t)),s}[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 7m","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2m 3m 3M 5d 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","·superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 5d 5P 6M 7m","romanian minor"],["1P 2M 3m 4A 5P 6M 7m","dorian #4"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3m 4P 5P 6m 7m","aeolian","minor"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]].forEach(([t,e,...n])=>Dt(t.split(" "),e,n));var Ot={names:Mt,get:St,all:kt,add:Dt,removeAll:function(){wt=[],Tt={}},keys:function(){return Object.keys(Tt)},entries:Ct,scaleType:At};const Pt={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]},Et=/^(6|64|7|9|11|13)$/;function Rt(t){const[e,n,s,i]=b(t);return""===e?["",t]:"A"===e&&"ug"===i?["","aug"]:i||"4"!==s&&"5"!==s?Et.test(s)?[e+n,s+i]:[e+n+s,i]:[e+n,s]}function It(t){if(""===t)return Pt;if(Array.isArray(t)&&2===t.length)return qt(t[1],t[0]);{const[e,n]=Rt(t),s=qt(n,e);return s.empty?qt(t):s}}function qt(t,e,n){const s=ft(t),i=v(e||""),o=v(n||"");if(s.empty||e&&i.empty||n&&o.empty)return Pt;const r=E(i.pc,o.pc),a=s.intervals.indexOf(r)+1;if(!o.empty&&!a)return Pt;const c=i.empty?[]:s.intervals.map(t=>P(i,t));t=-1!==s.aliases.indexOf(t)?t:s.aliases[0];const h=`${i.empty?"":i.pc}${t}${o.empty?"":"/"+o.pc}`,u=`${e?i.pc+" ":""}${s.name}${n?" over "+o.pc:""}`;return{...s,name:u,symbol:h,type:s.name,root:o.name,rootDegree:a,tonic:i.name,notes:c}}var Ft={getChord:qt,get:It,detect:function(t){const e=t.map(t=>v(t).pc).filter(t=>t);return 0===v.length?[]:function(t,e){const n=t[0],s=v(n).chroma,i=(t=>{const e=t.reduce((t,e)=>{const n=v(e).chroma;return void 0!==n&&(t[n]=t[n]||v(e).name),t},{});return t=>e[t]})(t);return rt(t,!1).map((t,e)=>{const o=ft(t).aliases[0];if(!o)return xt;const r=i(e);return e!==s?{weight:.5,name:`${r}${o}/${n}`}:{weight:1,name:`${r}${o}`}})}(e).filter(t=>t.weight).sort((t,e)=>e.weight-t.weight).map(t=>t.name)},chordScales:function(t){const e=ct(It(t).chroma);return kt().filter(t=>e(t.chroma)).map(t=>t.name)},extended:function(t){const e=It(t),n=ct(e.chroma);return _t().filter(t=>n(t.chroma)).map(t=>e.tonic+t.aliases[0])},reduced:function(t){const e=It(t),n=at(e.chroma);return _t().filter(t=>n(t.chroma)).map(t=>e.tonic+t.aliases[0])},tokenize:Rt,transpose:function(t,e){const[n,s]=Rt(t);return n?P(n,e)+s:t},chord:r("Chord.chord","Chord.get",It)};const Vt=[];[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]].forEach(([t,e,n])=>function(t,e,n){Vt.push({empty:!1,dots:"",name:"",value:1/t,fraction:t<1?[1/t,1]:[1,t],shorthand:e,names:n})}(t,e,n));const Nt={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]},jt=/^([^.]+)(\.*)$/;function Lt(t){const[e,n,s]=jt.exec(t)||[],i=Vt.find(t=>t.shorthand===n||t.names.includes(n));if(!i)return Nt;const o=function(t,e){const n=Math.pow(2,e);let s=t[0]*n,i=t[1]*n;const o=s;for(let t=0;t<e;t++)s+=o/Math.pow(2,t+1);for(;s%2==0&&i%2==0;)s/=2,i/=2;return[s,i]}(i.fraction,s.length),r=o[0]/o[1];return{...i,name:t,dots:s,value:r,fraction:o}}var zt={names:function(){return Vt.reduce((t,e)=>(e.names.forEach(e=>t.push(e)),t),[])},shorthands:function(){return Vt.map(t=>t.shorthand)},get:Lt,value:t=>Lt(t).value,fraction:t=>Lt(t).fraction};const Bt=C,Wt=[1,2,2,3,3,4,5,5,6,6,7,7],Ut="P m M m M P d P m M m M".split(" "),Gt=E,Yt=Zt((t,e)=>[t[0]+e[0],t[1]+e[1]]),Qt=Zt((t,e)=>[t[0]-e[0],t[1]-e[1]]);function Zt(t){return(e,n)=>{const s=C(e).coord,i=C(n).coord;if(s&&i)return O(t(s,i)).name}}var Xt={names:function(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")},get:Bt,name:t=>C(t).name,num:t=>C(t).num,semitones:t=>C(t).semitones,quality:t=>C(t).q,fromSemitones:function(t){const e=t<0?-1:1,n=Math.abs(t),s=n%12,i=Math.floor(n/12);return e*(Wt[s]+7*i)+Ut[s]},distance:Gt,invert:function(t){const e=C(t);return e.empty?"":C({step:(7-e.step)%7,alt:"perfectable"===e.type?-e.alt:-(e.alt+1),oct:e.oct,dir:e.dir}).name},simplify:function(t){const e=C(t);return e.empty?"":e.simple+e.q},add:Yt,addTo:t=>e=>Yt(t,e),substract:Qt};function Ht(t){return+t>=0&&+t<=127}function $t(t){if(Ht(t))return+t;const e=v(t);return e.empty?null:e.midi}const Jt=Math.log(2),Kt=Math.log(440);function te(t){const e=12*(Math.log(t)-Kt)/Jt+69;return Math.round(100*e)/100}const ee="C C# D D# E F F# G G# A A# B".split(" "),ne="C Db D Eb E F Gb G Ab A Bb B".split(" ");function se(t,e={}){if(isNaN(t)||t===-1/0||t===1/0)return"";t=Math.round(t);const n=(!0===e.sharps?ee:ne)[t%12];return e.pitchClass?n:n+(Math.floor(t/12)-1)}var ie={isMidi:Ht,toMidi:$t,midiToFreq:function(t,e=440){return Math.pow(2,(t-69)/12)*e},midiToNoteName:se,freqToMidi:te};const oe=["C","D","E","F","G","A","B"],re=t=>t.name,ae=t=>t.map(v).filter(t=>!t.empty),ce=v,he=P,ue=P,le=t=>e=>he(e,t),de=le,pe=t=>e=>he(t,e),fe=pe;function me(t,e){const n=ce(t);if(n.empty)return"";const[s,i]=n.coord;return w(void 0===i?[s+e]:[s+e,i]).name}const _e=me,ge=(t,e)=>t.height-e.height;function ye(t,e){return e=e||ge,ae(t).sort(e).map(re)}function ve(t){return ye(t,ge).filter((t,e,n)=>0===e||t!==n[e-1])}const xe=we(!0),be=we(!1);function we(t){return e=>{const n=ce(e);if(n.empty)return"";const s=t?n.alt>0:n.alt<0,i=null===n.midi;return se(n.midi||n.chroma,{sharps:s,pitchClass:i})}}var Te={names:function(t){return void 0===t?oe.slice():Array.isArray(t)?ae(t).map(re):[]},get:ce,name:t=>ce(t).name,pitchClass:t=>ce(t).pc,accidentals:t=>ce(t).acc,octave:t=>ce(t).oct,midi:t=>ce(t).midi,ascending:ge,descending:(t,e)=>e.height-t.height,sortedNames:ye,sortedUniqNames:ve,fromMidi:function(t){return se(t)},fromMidiSharps:function(t){return se(t,{sharps:!0})},freq:t=>ce(t).freq,fromFreq:function(t){return se(te(t))},fromFreqSharps:function(t){return se(te(t),{sharps:!0})},chroma:t=>ce(t).chroma,transpose:he,tr:ue,transposeBy:le,trBy:de,transposeFrom:pe,trFrom:fe,transposeFifths:me,trFifths:_e,simplify:xe,enharmonic:be};const Me={empty:!0,name:"",chordType:""},Se={};function Ae(t){return"string"==typeof t?Se[t]||(Se[t]=function(t){const[e,n,s,i]=(o=t,Ce.exec(o)||["","","",""]);var o;if(!s)return Me;const r=s.toUpperCase(),a=Oe.indexOf(r),c=y(n);return{empty:!1,name:e,roman:s,interval:C({step:a,alt:c,dir:1}).name,acc:n,chordType:i,alt:c,step:a,major:s===r,oct:0,dir:1}}(t)):"number"==typeof t?Ae(Oe[t]||""):c(t)?Ae(g((e=t).alt)+Oe[e.step]):a(t)?Ae(t.name):Me;var e}const ke=r("RomanNumeral.romanNumeral","RomanNumeral.get",Ae),Ce=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/,De="I II III IV V VI VII",Oe=De.split(" "),Pe=De.toLowerCase().split(" ");var Ee={names:function(t=!0){return(t?Oe:Pe).slice()},get:Ae,romanNumeral:ke};const Re=Object.freeze([]),Ie={type:"major",tonic:"",alteration:0,keySignature:""},qe={tonic:"",grades:Re,intervals:Re,scale:Re,chords:Re,chordsHarmonicFunction:Re,chordScales:Re},Fe={...Ie,...qe,type:"major",minorRelative:"",scale:Re,secondaryDominants:Re,secondaryDominantsMinorRelative:Re,substituteDominants:Re,substituteDominantsMinorRelative:Re},Ve={...Ie,type:"minor",relativeMajor:"",natural:qe,harmonic:qe,melodic:qe},Ne=(t,e,n="")=>e.map((e,s)=>`${t[s]}${n}${e}`);function je(t,e,n,s){return i=>{const o=t.map(t=>Ae(t).interval||""),r=o.map(t=>P(i,t));return{tonic:i,grades:t,intervals:o,scale:r,chords:Ne(r,e),chordsHarmonicFunction:Ne(r,n),chordScales:Ne(r,s," ")}}}const Le=(t,e)=>{const n=v(t),s=v(e);return n.empty||s.empty?0:s.coord[0]-n.coord[0]},ze=je("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),Be=je("I II bIII IV V bVI bVII".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),We=je("I II bIII IV V bVI VII".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),Ue=je("I II bIII IV V VI VII".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D - -".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));var Ge={majorKey:function(t){const e=v(t).pc;if(!e)return Fe;const n=ze(e),s=Le("C",e),i=e=>{const n=Ae(e);return n.empty?"":P(t,n.interval)+n.chordType};return{...n,type:"major",minorRelative:P(e,"-3m"),alteration:s,keySignature:g(s),secondaryDominants:"- VI7 VII7 I7 II7 III7 -".split(" ").map(i),secondaryDominantsMinorRelative:"- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ").map(i),substituteDominants:"- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ").map(i),substituteDominantsMinorRelative:"- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" ").map(i)}},majorTonicFromKeySignature:function(t){return"number"==typeof t?me("C",t):"string"==typeof t&&/^b+|#+$/.test(t)?me("C",y(t)):null},minorKey:function(t){const e=v(t).pc;if(!e)return Ve;const n=Le("C",e)-3;return{type:"minor",tonic:e,relativeMajor:P(e,"3m"),alteration:n,keySignature:g(n),natural:Be(e),harmonic:We(e),melodic:Ue(e)}}};const Ye={...H,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},Qe=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]].map((function(t){const[e,n,s,i,o,r,a]=t,c=a?[a]:[],h=Number(n).toString(2);return{empty:!1,intervals:ot(h),modeNum:e,chroma:h,normalized:h,name:i,setNum:n,alt:s,triad:o,seventh:r,aliases:c}})),Ze={};function Xe(t){return"string"==typeof t?Ze[t.toLowerCase()]||Ye:t&&t.name?Xe(t.name):Ye}Qe.forEach(t=>{Ze[t.name]=t,t.aliases.forEach(e=>{Ze[e]=t})});const He=r("Mode.mode","Mode.get",Xe);function $e(){return Qe.slice()}var Je={get:Xe,names:function(){return Qe.map(t=>t.name)},all:$e,entries:r("Mode.mode","Mode.all",$e),mode:He},Ke={fromRomanNumerals:function(t,e){return e.map(Ae).map(e=>P(t,C(e))+e.chordType)},toRomanNumerals:function(t,e){return e.map(e=>{const[n,s]=Rt(e);return Ae(C(E(t,n))).name+s})}};function tn(t){const e=Z(t.map($t));return t.length&&e.length===t.length?e.reduce((t,e)=>{const n=t[t.length-1];return t.concat(Y(n,e).slice(1))},[e[0]]):[]}var en={numeric:tn,chromatic:function(t,e){return tn(t).map(t=>se(t,e))}};const nn={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function sn(t){if("string"!=typeof t)return["",""];const e=t.indexOf(" "),n=v(t.substring(0,e));if(n.empty){const e=v(t);return e.empty?["",t]:[e.name,""]}const s=t.substring(n.name.length+1);return[n.name,s.length?s:""]}function on(t){const e=Array.isArray(t)?t:sn(t),n=v(e[0]).name,s=St(e[1]);if(s.empty)return nn;const i=s.name,o=n?s.intervals.map(t=>P(n,t)):[],r=n?n+" "+i:i;return{...s,name:r,type:i,tonic:n,notes:o}}var rn={get:on,names:Mt,extended:function(t){const e=ct(on(t).chroma);return kt().filter(t=>e(t.chroma)).map(t=>t.name)},modeNames:function(t){const e=on(t);if(e.empty)return[];const n=e.tonic?e.notes:e.intervals;return rt(e.chroma).map((t,e)=>{const s=on(t).name;return s?[n[e],s]:["",""]}).filter(t=>t[0])},reduced:function(t){const e=at(on(t).chroma);return kt().filter(t=>e(t.chroma)).map(t=>t.name)},scaleChords:function(t){const e=at(on(t).chroma);return _t().filter(t=>e(t.chroma)).map(t=>t.aliases[0])},scaleNotes:function(t){const e=t.map(t=>v(t).pc).filter(t=>t),n=e[0],s=ve(e);return Q(s.indexOf(n),s)},tokenize:sn,scale:r("Scale.scale","Scale.get",on)};const an={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},cn=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"],hn=/^(\d?\d(?:\+\d)*)\/(\d)$/,un=new Map;function ln(t){if("string"==typeof t){const[e,n,s]=hn.exec(t)||[];return ln([n,s])}const[e,n]=t,s=+n;if("number"==typeof e)return[e,s];const i=e.split("+").map(t=>+t);return 1===i.length?[i[0],s]:[i,s]}var dn={names:function(){return cn.slice()},parse:ln,get:function(t){const e=un.get(t);if(e)return e;const n=function([t,e]){const n=Array.isArray(t)?t.reduce((t,e)=>t+e,0):t,s=e;if(0===n||0===s)return an;return{empty:!1,name:Array.isArray(t)?`${t.join("+")}/${e}`:`${t}/${e}`,type:4===s||2===s?"simple":8===s&&n%3==0?"compound":"irregular",upper:n,lower:s,additive:Array.isArray(t)?t:[]}}(ln(t));return un.set(t,n),n}};const pn=s,fn=ut,mn=vt,_n=Ot},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(2);e.scale=s.getScale,e.mode=s.getScale,e.scales=s.scales,e.modes=s.scales;var i=n(1);e.addChord=i.addChord,e.chord=i.getChord,e.chords=i.chords;var o=n(3);e.clip=o.clip;var r=n(8);e.getChordDegrees=r.getChordDegrees,e.getChordsByProgression=r.getChordsByProgression,e.progression=r.progression;var a=n(9);e.arp=a.arp;var c=n(10);e.midi=c.midi;var h=n(13);e.Session=h.Session;var u=n(15);e.max=u.max},function(t,e,n){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,s,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=2&o[0]?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(6===o[0]&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],s=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),a=function(t,e,n){return"R"===t&&e.randomNotes?e.randomNotes[(s=e.randomNotes.length-1,void 0===s&&(s=1),Math.round(Math.random()*s))]:e.notes[n%e.notes.length];var s},c=function(t,e){return t.durations?t.durations[e%t.durations.length]:t.dur||t.subdiv||"8n"},h=function(t){var e=0;return t.instrument instanceof Tone.Player?function(n,s){"x"!==s&&"R"!==s||(t.instrument.start(n),e++)}:t.instrument instanceof Tone.PolySynth||t.instrument instanceof Tone.Sampler?function(n,s){"x"!==s&&"R"!==s||(t.instrument.triggerAttackRelease(a(s,t,e),c(t,e),n),e++)}:t.instrument instanceof Tone.NoiseSynth?function(n,s){"x"!==s&&"R"!==s||(t.instrument.triggerAttackRelease(c(t,e),n),e++)}:function(n,s){"x"!==s&&"R"!==s||(t.instrument.triggerAttackRelease(a(s,t,e)[0],c(t,e),n),e++)}};e.recursivelyApplyPatternToDurations=function(t,n,s){return void 0===s&&(s=[]),t.forEach((function(t){"string"==typeof t&&("x"!==t&&"R"!==t||s.push(n),"_"===t&&s.length&&(s[s.length-1]+=n)),Array.isArray(t)&&e.recursivelyApplyPatternToDurations(t,n/t.length,s)})),s};var u=function(t,n){var s;if(n=n||Tone.getContext(),!t.pattern)throw new Error("No pattern provided!");if(!(t.player||t.instrument||t.sample||t.buffer||t.synth||t.sampler||t.samples))throw new Error("No player or instrument provided!");t.durations||t.dur||(t.durations=e.recursivelyApplyPatternToDurations(r.expandStr(t.pattern),Tone.Ticks(t.subdiv||"4n").toSeconds()));var i=[];return t.effects&&(Array.isArray(t.effects)||(t.effects=[t.effects]),i=t.effects.map((function(t){return("string"==typeof t?new Tone[t]({context:n}):t.context!==n?p(t,n):t).toDestination()})).map((function(t){return"function"==typeof t.start?t.start():t}))),t.synth&&!t.instrument&&(t.instrument=t.synth,console.warn('The "synth" parameter will be deprecated in the future. Please use the "instrument" parameter instead.')),t.instrument=t.sample||t.buffer?new Tone.Player({url:t.sample||t.buffer,context:n}):t.sampler?t.sampler:t.player?t.player:t.samples?new Tone.Sampler({url:t.samples,context:n}):"string"==typeof t.instrument?new Tone[t.instrument]({context:n}):t.instrument,t.instrument.context!==n&&(t.instrument=p(t.instrument,n)),t.volume&&(t.instrument.volume.value=t.volume),(s=t.instrument).chain.apply(s,i).toDestination(),new Tone.Sequence({callback:h(t),events:r.expandStr(t.pattern),subdivision:t.subdiv||"4n",context:n})};e.totalPatternDuration=function(t,e){return"number"==typeof e?e*r.expandStr(t).length:Tone.Ticks(e).toSeconds()*r.expandStr(t).length},e.renderingDuration=function(t,n,s,i){var o,r=t.split("").filter((function(t){return"x"===t})).length,a=t.split("").filter((function(t){return"R"===t})).length,c=(null===(o=i)||void 0===o?void 0:o.length)?r:r+a,h=s.length||1;return e.totalPatternDuration(t,n)/c*function(t,e){for(var n=t<e?[t,e]:[e,t],s=n[0],i=n[1],o=i;o%s!=0;)o+=i;return o}(h,c)};var l,d=0,p=function(t,e){if(t instanceof Tone.PolySynth)return new Tone.PolySynth(Tone[t._dummyVoice.name],s(s({},t.get()),{context:e}));if(t instanceof Tone.Player)return new Tone.Player({url:t._buffer,context:e});if(t instanceof Tone.Sampler){var n=t.get(),i={attack:n.attack,curve:n.curve,release:n.release,volume:n.volume},o={baseUrl:t._buffers.baseUrl,urls:Object.fromEntries(t._buffers._buffers.entries())};return new Tone.Sampler(s(s(s({},i),o),{context:e}))}return new Tone[t.name](s(s({},t.get()),{context:e}))};e.browserClip=function(t){return t.offlineRendering?function(t,e){l||(l=Tone.getContext()),d++;var n=new Tone.Player({context:l,loop:!0});return Tone.Offline((function(e){return i(void 0,void 0,void 0,(function(){var n;return o(this,(function(s){switch(s.label){case 0:return n=u(t,e),[4,Tone.loaded()];case 1:return s.sent(),n.start(),e.transport.start(),[2]}}))}))}),e).then((function(e){var s,i;n.buffer=e,0==--d&&(Tone.setContext(l),null===(i=(s=t).offlineRenderingCallback)||void 0===i||i.call(s))})),n.toDestination(),n.sync(),n}(t,e.renderingDuration(t.pattern,t.subdiv||"4n",t.notes,t.randomNotes)):u(t,l)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(2),i=n(0);e.getChordDegrees=function(t){var e={ionian:["I","ii","iii","IV","V","vi","vii°"],dorian:["i","ii","III","IV","v","vi°","VII"],phrygian:["i","II","III","iv","v°","VI","vii"],lydian:["I","II","iii","iv°","V","vi","vii"],mixolydian:["I","ii","iii°","IV","v","vi","VII"],aeolian:["i","ii°","III","iv","v","VI","VII"],locrian:["i°","II","iii","iv","V","VI","vii"],"melodic minor":["i","ii","III+","IV","V","vi°","vii°"],"harmonic minor":["i","ii°","III+","iv","V","VI","vii°"]};return e.major=e.ionian,e.minor=e.aeolian,e[t]||[]};var o={i:0,ii:1,iii:2,iv:3,v:4,vi:5,vii:6};e.getChordsByProgression=function(t,e){var n=t.split(" ");n[0].match(/\d/)||(n[0]+="4",t=n.join(" "));var i=s.getScale(t);return e.replace(/\s*,+\s*/g," ").split(" ").map((function(t,e){var n=function(t){var e=t.replace(/\W/g,""),n="M";return e.toLowerCase()===e&&(n="m"),t.indexOf("°")>-1?n+"7b5":t.indexOf("+")>-1?n+"#5":t.indexOf("7")>-1?"M"===n?"Maj7":"m7":n}(t),s=o[t.replace(/\W|\d/g,"").toLowerCase()],r=i[s],a=r.replace(/\D+/,"");return r.replace(/\d/,"")+n+"-"+a})).toString().replace(/,/g," ")};var r=function(t){var e=t.T,n=t.P,s=t.D;return function(t){void 0===t&&(t=4);var o=[];o.push(i.pickOne(e));var r=1;for(r<t-1&&(o.push(i.pickOne(n)),r++),r<t-1&&i.dice()&&(o.push(i.pickOne(n)),r++),r<t-1&&(o.push(i.pickOne(s)),r++),r<t-1&&(o.push(i.pickOne(n)),r++),r<t-1&&(o.push(i.pickOne(s)),r++),r<t-1&&i.dice()&&(o.push(i.pickOne(n)),r++);r<t;)o.push(i.pickOne(s)),r++;return o}},a=r({T:["I","vi"],P:["ii","IV"],D:["V"]}),c=r({T:["i","VI"],P:["ii","iv"],D:["V"]});e.progression=function(t,e){return void 0===e&&(e=4),"major"===t||"M"===t?a(e):"minor"===t||"m"===t?c(e):void 0}},function(t,e,n){"use strict";var s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],r=0,a=o.length;r<a;r++,i++)s[i]=o[r];return s};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=function(t,e){var n=function(t){return t.replace(/\d/,"")+(+t.replace(/\D/g,"")+1)},i=t.map(n),o=i.map(n);return s(t,i,o).slice(0,e)};e.arp=function(t){var e=[],n={count:4,order:"0123",chords:""};if("string"==typeof t)n.chords=t;else{if(t.order&&t.order.match(/\D/g))throw new TypeError("Invalid value for order");if(t.count>8||t.count<2)throw new TypeError("Invalid value for count");t.count&&!t.order&&(n.order=Array.from(Array(t.count).keys()).join("")),Object.assign(n,t)}if("string"==typeof n.chords)for(var r=function(t){var r=o(i.getChord(t),n.count),a=n.order.split("").map((function(t){return r[t]}));e=s(e,a)},a=0,c=n.chords.split(" ");a<c.length;a++)r(c[a]);else{if(!Array.isArray(n.chords))throw new TypeError("Invalid value for chords");for(var h=function(t){var i=o(t,n.count),r=n.order.split("").map((function(t){return i[t]}));e=s(e,r)},u=0,l=n.chords;u<l.length;u++)h(l[u])}return e}},function(t,e,n){"use strict";var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=s(n(11)),r=i(n(4));e.midi=function(t,e,n){void 0===e&&(e="music.mid");var s=c(t,n).toBytes();return null===e?s:(e.endsWith(".mid")||(e+=".mid"),"undefined"!=typeof window&&window.URL&&window.URL.createObjectURL?a(s,e):(o.default.writeFileSync(e,s,"binary"),void console.log("MIDI file generated: "+e+".")))};var a=function(t,e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++){var i=t.charCodeAt(s);n[s]=i}var o=new Blob([n],{type:"audio/midi"}),r=document.createElement("a");return r.href="undefined"!=typeof window&&void 0!==window.URL&&void 0!==window.URL.createObjectURL&&window.URL.createObjectURL(o)||"",r.download=e,r.innerText="Download MIDI file",r},c=function(t,e){var n=new r.File,s=new r.Track;"number"==typeof e&&s.setTempo(e),n.addTrack(s);for(var i=0,o=t;i<o.length;i++){var a=o[i],c=a.level||127;a.note?"string"==typeof a.note?(s.noteOn(0,a.note,a.length,c),s.noteOff(0,a.note,a.length,c)):s.addChord(0,a.note,a.length,c):s.noteOff(0,"",a.length)}return n}},function(t,e){t.exports=n(26)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(14),i=function(){function t(t){t=t||[],this.sessionChannels=t.map((function(t,e){return t.idx=t.idx||e,new s.Channel(t)}))}return t.prototype.createChannel=function(t){t.idx=t.idx||this.sessionChannels.length;var e=new s.Channel(t);return this.sessionChannels.push(e),e},Object.defineProperty(t.prototype,"channels",{get:function(){return this.sessionChannels},enumerable:!0,configurable:!0}),t.prototype.startRow=function(t){this.sessionChannels.forEach((function(e){e.startClip(t)}))},t.prototype.play=function(t){var e=this,n=t.channelPatterns,s=t.clipDuration||"4:0:0",i=Tone.Time(s).toSeconds(),o=function(t,e){t.map((function(t){return t.stop(e)}))};n.forEach((function(t){var n=t.channelIdx,s=t.pattern,r=[],a=0,c="-";s.split("").forEach((function(t){t!==c&&"_"!==t&&(o(r,a),r=function(t,n,s){return"-"===n?[]:e.channels.filter((function(e){return e.idx===t})).map((function(t){return t.clips[n].start(s)}))}(n,t,a)),c=t,a+=i})),o(r,a)}))},t}();e.Session=i},function(t,e,n){"use strict";var s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=this&&this.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){var t=Tone.Transport.position.split(":");return"0"===t[0]&&"0"===t[1]?0:+t[0]+1+":0:0"},a=function(){function t(t){var e=this;this.idx=t.idx||0,this.activePatternIdx=-1,this.channelClips=[],t.sample&&(this.player=new Tone.Player(t.sample)),t.synth&&(this.instrument=new Tone[t.synth]),t.samples&&(this.sampler=new Tone.Sampler(t.samples)),t.clips,t.samples,t.sample,t.synth;var n=i(t,["clips","samples","sample","synth"]);t.clips.forEach((function(t){e.addClip(s(s({},t),n))}),this)}return Object.defineProperty(t.prototype,"clips",{get:function(){return this.channelClips},enumerable:!0,configurable:!0}),t.prototype.startClip=function(t){this.activePatternIdx>-1&&this.activePatternIdx!==t&&this.stopClip(this.activePatternIdx),this.channelClips[t]&&"started"!==this.channelClips[t].state&&(this.activePatternIdx=t,this.channelClips[t].start(r()))},t.prototype.stopClip=function(t){this.channelClips[t].stop(r())},t.prototype.addClip=function(t,e){e=e||this.channelClips.length,t.pattern?this.channelClips[e]=o.clip(s({player:this.player,instrument:this.instrument,sampler:this.sampler},t)):this.channelClips[e]=null},Object.defineProperty(t.prototype,"activeClipIdx",{get:function(){return this.activePatternIdx},enumerable:!0,configurable:!0}),t}();e.Channel=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(4);e.max=function(t,e){void 0===e&&(e="live_set view highlighted_clip_slot clip");var n=new LiveAPI(e),i=t.reduce((function(t,e){return t+e.length}),0);n.set("loop_end",i/512),n.call("remove_notes",0,1,258,127),n.call("set_notes");var o=t.reduce((function(t,e){return t+(e.note?e.note.length:0)}),0);n.call("notes",o);var r=0;t.forEach((function(t){t.note?(t.note.forEach((function(e){n.call("note",s.Util.midiPitchFromNote(e),r.toFixed(2).toString(),(t.length/512).toFixed(2).toString(),t.level||100,0)})),r+=t.length/512):r+=t.length/512})),n.call("done")}}]))},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}},,function(t,e,n){var s=n(9);t.exports=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}},,,,,,,,,,,function(t,e,n){var s=n(23),i=n(24),o=n(11),r=n(25);t.exports=function(t,e){return s(t)||i(t,e)||o(t,e)||r()}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],s=!0,i=!1,o=void 0;try{for(var r,a=t[Symbol.iterator]();!(s=(r=a.next()).done)&&(n.push(r.value),!e||n.length!==e);s=!0);}catch(t){i=!0,o=t}finally{try{s||null==a.return||a.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){console.log("I'm `fs` modules")},function(t,e,n){"use strict";n.r(e);var s={};n.r(s),n.d(s,"assert",(function(){return ti})),n.d(s,"assertRange",(function(){return ei})),n.d(s,"assertContextRunning",(function(){return ni})),n.d(s,"setLogger",(function(){return ii})),n.d(s,"log",(function(){return oi})),n.d(s,"warn",(function(){return ri}));var i={};n.r(i);var o={};n.r(o),n.d(o,"getContext",(function(){return Ji})),n.d(o,"setContext",(function(){return Ki})),n.d(o,"Clock",(function(){return Ro})),n.d(o,"Context",(function(){return Ui})),n.d(o,"BaseContext",(function(){return Wi})),n.d(o,"Delay",(function(){return Io})),n.d(o,"Gain",(function(){return So})),n.d(o,"Offline",(function(){return qo})),n.d(o,"OfflineContext",(function(){return Xi})),n.d(o,"Param",(function(){return xo})),n.d(o,"ToneAudioBuffer",(function(){return Zi})),n.d(o,"ToneAudioBuffers",(function(){return Fo})),n.d(o,"ToneAudioNode",(function(){return bo})),n.d(o,"connectSeries",(function(){return wo})),n.d(o,"connect",(function(){return To})),n.d(o,"disconnect",(function(){return Mo})),n.d(o,"FrequencyClass",(function(){return lo})),n.d(o,"Frequency",(function(){return mo})),n.d(o,"MidiClass",(function(){return Vo})),n.d(o,"Midi",(function(){return No})),n.d(o,"TimeClass",(function(){return ho})),n.d(o,"Time",(function(){return uo})),n.d(o,"TicksClass",(function(){return jo})),n.d(o,"Ticks",(function(){return Lo})),n.d(o,"TransportTimeClass",(function(){return _o})),n.d(o,"TransportTime",(function(){return go})),n.d(o,"Emitter",(function(){return Bi})),n.d(o,"IntervalTimeline",(function(){return Bo})),n.d(o,"StateTimeline",(function(){return vo})),n.d(o,"Timeline",(function(){return Vi})),n.d(o,"isUndef",(function(){return ai})),n.d(o,"isDefined",(function(){return ci})),n.d(o,"isFunction",(function(){return hi})),n.d(o,"isNumber",(function(){return ui})),n.d(o,"isObject",(function(){return li})),n.d(o,"isBoolean",(function(){return di})),n.d(o,"isArray",(function(){return pi})),n.d(o,"isString",(function(){return fi})),n.d(o,"isNote",(function(){return mi})),n.d(o,"dbToGain",(function(){return eo})),n.d(o,"gainToDb",(function(){return no})),n.d(o,"intervalToFrequencyRatio",(function(){return so})),n.d(o,"ftom",(function(){return oo})),n.d(o,"mtof",(function(){return ao})),n.d(o,"optionsFromArguments",(function(){return Ci})),n.d(o,"defaultArg",(function(){return Di})),n.d(o,"Unit",(function(){return i})),n.d(o,"debug",(function(){return s})),n.d(o,"Noise",(function(){return Jo})),n.d(o,"UserMedia",(function(){return er})),n.d(o,"Oscillator",(function(){return ir})),n.d(o,"AMOscillator",(function(){return hr})),n.d(o,"FMOscillator",(function(){return ur})),n.d(o,"PulseOscillator",(function(){return lr})),n.d(o,"FatOscillator",(function(){return dr})),n.d(o,"PWMOscillator",(function(){return pr})),n.d(o,"OmniOscillator",(function(){return mr})),n.d(o,"ToneOscillatorNode",(function(){return sr})),n.d(o,"LFO",(function(){return vr})),n.d(o,"ToneBufferSource",(function(){return $o})),n.d(o,"Player",(function(){return wr})),n.d(o,"Players",(function(){return Tr})),n.d(o,"GrainPlayer",(function(){return Mr})),n.d(o,"Add",(function(){return _r})),n.d(o,"Abs",(function(){return Sr})),n.d(o,"AudioToGain",(function(){return ar})),n.d(o,"GainToAudio",(function(){return Ar})),n.d(o,"GreaterThan",(function(){return Or})),n.d(o,"GreaterThanZero",(function(){return Dr})),n.d(o,"Multiply",(function(){return cr})),n.d(o,"Negate",(function(){return kr})),n.d(o,"Pow",(function(){return Pr})),n.d(o,"Signal",(function(){return Co})),n.d(o,"connectSignal",(function(){return Do})),n.d(o,"Scale",(function(){return gr})),n.d(o,"ScaleExp",(function(){return Er})),n.d(o,"Subtract",(function(){return Cr})),n.d(o,"SyncedSignal",(function(){return Rr})),n.d(o,"WaveShaper",(function(){return rr})),n.d(o,"Zero",(function(){return yr})),n.d(o,"AMSynth",(function(){return zr})),n.d(o,"DuoSynth",(function(){return Yr})),n.d(o,"FMSynth",(function(){return Qr})),n.d(o,"MetalSynth",(function(){return Xr})),n.d(o,"MembraneSynth",(function(){return Hr})),n.d(o,"MonoSynth",(function(){return Gr})),n.d(o,"NoiseSynth",(function(){return $r})),n.d(o,"PluckSynth",(function(){return oa})),n.d(o,"PolySynth",(function(){return ra})),n.d(o,"Sampler",(function(){return aa})),n.d(o,"Synth",(function(){return jr})),n.d(o,"Loop",(function(){return ha})),n.d(o,"Part",(function(){return ua})),n.d(o,"Pattern",(function(){return xa})),n.d(o,"Sequence",(function(){return ba})),n.d(o,"ToneEvent",(function(){return ca})),n.d(o,"AutoFilter",(function(){return Sa})),n.d(o,"AutoPanner",(function(){return ka})),n.d(o,"AutoWah",(function(){return Da})),n.d(o,"BitCrusher",(function(){return Oa})),n.d(o,"Chebyshev",(function(){return Ea})),n.d(o,"Chorus",(function(){return Va})),n.d(o,"Distortion",(function(){return Na})),n.d(o,"FeedbackDelay",(function(){return La})),n.d(o,"FrequencyShifter",(function(){return Ba})),n.d(o,"Freeverb",(function(){return Ga})),n.d(o,"JCReverb",(function(){return Xa})),n.d(o,"PingPongDelay",(function(){return $a})),n.d(o,"PitchShift",(function(){return Ja})),n.d(o,"Phaser",(function(){return Ka})),n.d(o,"Reverb",(function(){return tc})),n.d(o,"StereoWidener",(function(){return ic})),n.d(o,"Tremolo",(function(){return oc})),n.d(o,"Vibrato",(function(){return rc})),n.d(o,"Analyser",(function(){return ac})),n.d(o,"Meter",(function(){return hc})),n.d(o,"FFT",(function(){return uc})),n.d(o,"DCMeter",(function(){return lc})),n.d(o,"Waveform",(function(){return dc})),n.d(o,"Follower",(function(){return Ca})),n.d(o,"Channel",(function(){return mc})),n.d(o,"CrossFade",(function(){return wa})),n.d(o,"Merge",(function(){return Ia})),n.d(o,"MidSideMerge",(function(){return nc})),n.d(o,"MidSideSplit",(function(){return ec})),n.d(o,"MultibandSplit",(function(){return _c})),n.d(o,"Panner",(function(){return Aa})),n.d(o,"Panner3D",(function(){return yc})),n.d(o,"PanVol",(function(){return fc})),n.d(o,"Recorder",(function(){return vc})),n.d(o,"Solo",(function(){return pc})),n.d(o,"Split",(function(){return Ra})),n.d(o,"Volume",(function(){return Uo})),n.d(o,"Compressor",(function(){return xc})),n.d(o,"Gate",(function(){return bc})),n.d(o,"Limiter",(function(){return wc})),n.d(o,"MidSideCompressor",(function(){return Tc})),n.d(o,"MultibandCompressor",(function(){return Mc})),n.d(o,"AmplitudeEnvelope",(function(){return Nr})),n.d(o,"Envelope",(function(){return Ir})),n.d(o,"FrequencyEnvelope",(function(){return Ur})),n.d(o,"EQ3",(function(){return Sc})),n.d(o,"Filter",(function(){return Wr})),n.d(o,"OnePoleFilter",(function(){return sa})),n.d(o,"FeedbackCombFilter",(function(){return na})),n.d(o,"LowpassCombFilter",(function(){return ia})),n.d(o,"Convolver",(function(){return Ac})),n.d(o,"BiquadFilter",(function(){return Br})),n.d(o,"version",(function(){return r})),n.d(o,"start",(function(){return to})),n.d(o,"supported",(function(){return Ks})),n.d(o,"now",(function(){return kc})),n.d(o,"immediate",(function(){return Cc})),n.d(o,"Transport",(function(){return Dc})),n.d(o,"getTransport",(function(){return Oc})),n.d(o,"Destination",(function(){return Pc})),n.d(o,"Master",(function(){return Ec})),n.d(o,"getDestination",(function(){return Rc})),n.d(o,"Listener",(function(){return Ic})),n.d(o,"getListener",(function(){return qc})),n.d(o,"Draw",(function(){return Fc})),n.d(o,"getDraw",(function(){return Vc})),n.d(o,"context",(function(){return Nc})),n.d(o,"loaded",(function(){return jc})),n.d(o,"Buffer",(function(){return Lc})),n.d(o,"Buffers",(function(){return zc})),n.d(o,"BufferSource",(function(){return Bc}));const r="14.7.58";var a=n(6);const c=new WeakSet,h=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,_=new WeakMap,g=new WeakMap,y={construct:()=>y},v=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,x=(t,e)=>{const n=[];let s=t.replace(/^[\s]+/,""),i=s.match(v);for(;null!==i;){const t=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(o),s=s.slice(i[0].length).replace(/^[\s]+/,""),i=s.match(v)}return[n.join(";"),s]},b=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},w=t=>{if(!(t=>{try{new new Proxy(t,y)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},T=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},M=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[s]=n;return t.delete(s),s},S=(t,e,n,s)=>{const i=T(t,e),o=M(i,t=>t[0]===n&&t[1]===s);return 0===i.size&&t.delete(e),o},A=t=>T(f,t),k=t=>{if(c.has(t))throw new Error("The AudioNode is already stored.");c.add(t),A(t).forEach(t=>t(!0))},C=t=>"port"in t,D=t=>{if(!c.has(t))throw new Error("The AudioNode is not stored.");c.delete(t),A(t).forEach(t=>t(!1))},O=(t,e)=>{!C(t)&&e.every(t=>0===t.size)&&D(t)},P={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},E=(t,e)=>t.context===e,R=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},I=()=>new DOMException("","IndexSizeError"),q=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw I();throw t}})},F={numberOfChannels:1},V=-34028234663852886e22,N=-V,j=t=>c.has(t),L={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},z=t=>T(h,t),B=t=>T(l,t),W=(t,e)=>{const{activeInputs:n}=z(t);n.forEach(n=>n.forEach(([n])=>{e.includes(t)||W(n,[...e,t])}));const s=(t=>"playbackRate"in t)(t)?[t.playbackRate]:C(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of s){const n=B(t);void 0!==n&&n.activeInputs.forEach(([t])=>W(t,e))}j(t)&&D(t)},U=t=>{W(t.destination,[])},G=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),Y=t=>"context"in t,Q=t=>Y(t[0]),Z=(t,e,n,s)=>{for(const e of t)if(n(e)){if(s)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},X=(t,e,[n,s],i)=>{Z(t,[e,n,s],t=>t[0]===e&&t[1]===n,i)},H=(t,[e,n,s],i)=>{const o=t.get(e);void 0===o?t.set(e,new Set([[n,s]])):Z(o,[n,s],t=>t[0]===n,i)},$=t=>"inputs"in t,J=(t,e,n,s)=>{if($(e)){const i=e.inputs[s];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,s),[e,n,s]},K=(t,e,n)=>{for(const s of t)if(s[0]===e&&s[1]===n)return t.delete(s),s;return null},tt=(t,e)=>{if(!A(t).delete(e))throw new Error("Missing the expected event listener.")},et=(t,e,n)=>{const s=T(t,e),i=M(s,t=>t[0]===n);return 0===s.size&&t.delete(e),i},nt=(t,e,n,s)=>{$(e)?t.disconnect(e.inputs[s],n,0):t.disconnect(e,n,s)},st=t=>T(u,t),it=t=>T(d,t),ot=t=>m.has(t),rt=t=>!c.has(t),at=t=>new Promise(e=>{const n=t.createScriptProcessor(256,1,1),s=t.createGain(),i=t.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const r=t.createBufferSource();r.buffer=i,r.loop=!0,r.connect(n).connect(t.destination),r.connect(s),r.disconnect(s),n.onaudioprocess=s=>{const i=s.inputBuffer.getChannelData(0);Array.prototype.some.call(i,t=>1===t)?e(!0):e(!1),r.stop(),n.onaudioprocess=null,r.disconnect(n),n.disconnect(t.destination)},r.start()}),ct=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach((t,n)=>e(n,t))},ht=t=>"context"in t,ut=(t,e,n,s)=>{const{activeInputs:i,passiveInputs:o}=B(e),{outputs:r}=z(t),a=A(t),c=r=>{const a=st(t),c=it(e);if(r){const e=et(o,t,n);X(i,t,e,!1),s||ot(t)||a.connect(c,n)}else{const e=((t,e,n)=>M(t,t=>t[0]===e&&t[1]===n))(i,t,n);H(o,e,!1),s||ot(t)||a.disconnect(c,n)}};return!!Z(r,[e,n],t=>t[0]===e&&t[1]===n,!0)&&(a.add(c),j(t)?X(i,t,[n,c],!0):H(o,[t,n,c],!0),!0)},lt=(t,e,n,s,i)=>{const[o,r]=((t,e,n,s)=>{const{activeInputs:i,passiveInputs:o}=z(e),r=K(i[s],t,n);if(null===r){return[S(o,t,n,s)[2],!1]}return[r[2],!0]})(t,n,s,i);if(null!==o&&(tt(t,o),!r||e||ot(t)||nt(st(t),st(n),s,i)),j(n)){const{activeInputs:t}=z(n);O(n,t)}},dt=(t,e,n,s)=>{const[i,o]=((t,e,n)=>{const{activeInputs:s,passiveInputs:i}=B(e),o=K(s,t,n);if(null===o){return[et(i,t,n)[1],!1]}return[o[2],!0]})(t,n,s);null!==i&&(tt(t,i),!o||e||ot(t)||st(t).disconnect(it(n),s))};class pt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,s)=>t.call(e,n,s,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const ft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function mt(t,e,n,s,i){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],s,i);else{const o=t.getChannelData(s);if(0===e[n].byteLength)e[n]=o.slice(i,i+128);else{const t=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const _t=(t,e,n,s,i)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],s,i):0!==e[n].byteLength&&t.getChannelData(s).set(e[n],i)},gt=(t,e)=>{const n=[];for(let s=0;s<t;s+=1){const t=[],i="number"==typeof e?e:e[s];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));n.push(t)}return n},yt=async(t,e,n,s,i,o,r)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=s.channelCount*s.numberOfInputs,h=i.reduce((t,e)=>t+e,0),u=0===h?null:n.createBuffer(h,a,n.sampleRate);if(void 0===o)throw new Error("Missing the processor constructor.");const l=z(t),d=await((t,e)=>{const n=T(g,t),s=st(e);return T(n,s)})(n,t),p=gt(s.numberOfInputs,s.channelCount),f=gt(s.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let h=0;h<a;h+=128){if(s.numberOfInputs>0&&null!==e)for(let t=0;t<s.numberOfInputs;t+=1)for(let n=0;n<s.channelCount;n+=1)mt(e,p[t],n,n,h);void 0!==o.parameterDescriptors&&null!==e&&o.parameterDescriptors.forEach(({name:t},n)=>{mt(e,m,t,c+n,h)});for(let t=0;t<s.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=p.map((t,e)=>0===l.activeInputs[e].size?[]:t),e=r(h/n.sampleRate,n.sampleRate,()=>d.process(t,f,m));if(null!==u)for(let t=0,e=0;t<s.numberOfOutputs;t+=1){for(let n=0;n<i[t];n+=1)_t(u,f[t],n,e+n,h);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return u},vt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},xt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},bt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},wt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Tt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Mt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},St=(t,e,n)=>{const s=e[n];if(void 0===s)throw t();return s},At={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},kt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Ct=()=>new DOMException("","InvalidStateError"),Dt=()=>new DOMException("","InvalidAccessError"),Ot={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Pt=(t,e,n,s,i,o,r,a,c,h,u)=>{const l=h.length;let d=a;for(let a=0;a<l;a+=1){let l=n[0]*h[a];for(let e=1;e<i;e+=1){const s=d-e&c-1;l+=n[e]*o[s],l-=t[e]*r[s]}for(let t=i;t<s;t+=1)l+=n[t]*o[d-t&c-1];for(let n=i;n<e;n+=1)l-=t[n]*r[d-n&c-1];o[d]=h[a],r[d]=l,d=d+1&c-1,u[a]=l}return d},Et={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Rt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return void 0!==n&&(n.catch(()=>{}),!0)}catch{}return!1},It={numberOfChannels:1},qt=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n]&&(t[n]=s)},Ft=(t,e)=>{qt(t,e,"channelCount"),qt(t,e,"channelCountMode"),qt(t,e,"channelInterpretation")},Vt=t=>"function"==typeof t.getFloatTimeDomainData,Nt=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n].value&&(t[n].value=s)},jt=t=>{var e;t.start=(e=t.start,(n=0,s=0,i)=>{if("number"==typeof i&&i<0||s<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,s,i)})},Lt=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},zt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Bt=async(t,e)=>new t(await(t=>new Promise((e,n)=>{const{port1:s,port2:i}=new MessageChannel;s.onmessage=({data:t})=>{s.close(),i.close(),e(t)},s.onmessageerror=({data:t})=>{s.close(),i.close(),n(t)},i.postMessage(t)}))(e)),Wt=(t,e)=>{const n=t.createBiquadFilter();return Ft(n,e),Nt(n,e,"Q"),Nt(n,e,"detune"),Nt(n,e,"frequency"),Nt(n,e,"gain"),qt(n,e,"type"),n},Ut=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ft(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Ct()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Ct()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Ct()}})})(n),n},Gt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Yt=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Ft(n,e),Nt(n,e,"delayTime"),n},Qt=(t,e)=>{const n=t.createGain();return Ft(n,e),Nt(n,e,"gain"),n};function Zt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Xt(t,e){let n=[0,0];for(let o=t.length-1;o>=0;o-=1)i=e,n=[(s=n)[0]*i[0]-s[1]*i[1],s[0]*i[1]+s[1]*i[0]],n[0]+=t[o];var s,i;return n}const Ht=(t,e,n,s)=>t.createScriptProcessor(e,n,s),$t=()=>new DOMException("","NotSupportedError"),Jt={numberOfChannels:1},Kt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},te={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},ee={disableNormalization:!1},ne={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},se=()=>new DOMException("","UnknownError"),ie={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},oe=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},re=(t,e,n,s)=>{let i=Object.getPrototypeOf(t);for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:o,set:r}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(o),set:s(r)})},ae=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ce=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},he=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ue=()=>{try{new DOMException}catch{return!1}return!0},le=()=>new Promise(t=>{const e=new ArrayBuffer(0),{port1:n,port2:s}=new MessageChannel;n.onmessage=({data:e})=>t(null!==e),s.postMessage(e,[e])}),de=(t,e)=>{const n=e.createGain();t.connect(n);const s=(i=t.disconnect,()=>{i.call(t,n),t.removeEventListener("ended",s)});var i;t.addEventListener("ended",s),Gt(t,n),t.stop=(e=>{let s=!1;return(i=0)=>{if(s)try{e.call(t,i)}catch{n.gain.setValueAtTime(0,i)}else e.call(t,i),s=!0}})(t.stop)},pe=(t,e)=>n=>{const s={value:t};return Object.defineProperties(n,{currentTarget:s,target:s}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},fe=(me=Z,(t,e,[n,s,i],o)=>{me(t[s],[e,n,i],t=>t[0]===e&&t[1]===n,o)});var me;const _e=(t=>(e,n,[s,i,o],r)=>{const a=e.get(s);void 0===a?e.set(s,new Set([[i,n,o]])):t(a,[i,n,o],t=>t[0]===i&&t[1]===n,r)})(Z),ge=(t=>(e,n,s,i)=>t(e[i],t=>t[0]===n&&t[1]===s))(M),ye=new WeakMap,ve=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(ye),xe=(be=new Map,we=new WeakMap,(t,e)=>{const n=we.get(t);if(void 0!==n)return n;const s=be.get(t);if(void 0!==s)return s;try{const n=e();return n instanceof Promise?(be.set(t,n),n.catch(()=>!1).then(e=>(be.delete(t),we.set(t,e),e))):(we.set(t,n),n)}catch{return we.set(t,!1),!1}});var be,we;const Te="undefined"==typeof window?null:window,Me=(Se=xe,Ae=I,(t,e)=>{const n=t.createAnalyser();if(Ft(n,e),!(e.maxDecibels>e.minDecibels))throw Ae();return qt(n,e,"fftSize"),qt(n,e,"maxDecibels"),qt(n,e,"minDecibels"),qt(n,e,"smoothingTimeConstant"),Se(Vt,()=>Vt(n))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const s=Math.max(n.length,t.fftSize);for(let t=0;t<s;t+=1)e[t]=.0078125*(n[t]-128);return e}})(n),n});var Se,Ae;const ke=(Ce=z,t=>{const e=Ce(t);if(null===e.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer});var Ce;const De=((t,e,n)=>async(s,i,o,r)=>{const a=t(s),c=[...r,s];await Promise.all(a.activeInputs.map((t,r)=>Array.from(t).filter(([t])=>!c.includes(t)).map(async([t,a])=>{const h=e(t),u=await h.render(t,i,c),l=s.context.destination;n(t)||s===l&&n(s)||u.connect(o,a,r)})).reduce((t,e)=>[...t,...e],[]))})(z,ke,ot),Oe=(Pe=Me,Ee=st,Re=De,()=>{const t=new WeakMap;return{render(e,n,s){const i=t.get(n);return void 0!==i?Promise.resolve(i):(async(e,n,s)=>{let i=Ee(e);if(!E(i,n)){const t={channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant};i=Pe(n,t)}return t.set(n,i),await Re(e,n,i,s),i})(e,n,s)}}});var Pe,Ee,Re;const Ie=(qe=p,t=>{const e=qe.get(t);if(void 0===e)throw Ct();return e});var qe;const Fe=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Te),Ve=(Ne=Fe,t=>null!==Ne&&t instanceof Ne);var Ne;const je=new WeakMap,Le=(ze=pe,class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,e,n){if(null!==e){let s=this._listeners.get(e);void 0===s&&(s=ze(this,e),"function"==typeof e&&this._listeners.set(e,s)),this._nativeEventTarget.addEventListener(t,s,n)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const s=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===s?null:s,n)}});var ze;const Be=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Te),We=(Ue=Be,t=>null!==Ue&&t instanceof Ue);var Ue;const Ge=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Te),Ye=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Te),Qe=((t,e,n,s,i,o,r,a,c,h,l,d,p,m,_)=>class extends h{constructor(e,s,i,o){super(i),this._context=e,this._nativeAudioNode=i;const r=l(e);d(r)&&!0!==n(at,()=>at(r))&&(t=>{const e=new Map;var n,s;t.connect=(n=t.connect.bind(t),(t,s=0,i=0)=>{const o=ht(t)?n(t,s,i):n(t,s),r=e.get(t);return void 0===r?e.set(t,[{input:i,output:s}]):r.every(t=>t.input!==i||t.output!==s)&&r.push({input:i,output:s}),o}),t.disconnect=(s=t.disconnect,(n,i,o)=>{if(s.apply(t),void 0===n)e.clear();else if("number"==typeof n)for(const[t,s]of e){const i=s.filter(t=>t.output!==n);0===i.length?e.delete(t):e.set(t,i)}else if(e.has(n))if(void 0===i)e.delete(n);else{const t=e.get(n);if(void 0!==t){const s=t.filter(t=>t.output!==i&&(t.input!==o||void 0===o));0===s.length?e.delete(n):e.set(n,s)}}for(const[n,s]of e)s.forEach(e=>{ht(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)})})})(i),u.set(this,i),f.set(this,new Set),"closed"!==e.state&&s&&k(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw i();const h=l(this._context),u=_(h);if(p(t)||m(t))throw o();if(Y(t)){const i=st(t);try{const e=J(this._nativeAudioNode,i,n,a),s=rt(this);(u||s)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!s&&rt(t)&&k(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,n,a,u)){const e=c([this],t);ct(e,s(u))}return t}const d=it(t);if("playbackRate"===d.name)throw r();try{this._nativeAudioNode.connect(d,n),(u||rt(this))&&this._nativeAudioNode.disconnect(d,n)}catch(t){if(12===t.code)throw o();throw t}if(ut(this,t,n,u)){const e=c([this],t);ct(e,s(u))}}disconnect(t,e,n){let s;const r=l(this._context),h=_(r);if(void 0===t)s=((t,e)=>{const n=z(t),s=[];for(const i of n.outputs)Q(i)?lt(t,e,...i):dt(t,e,...i),s.push(i[0]);return n.outputs.clear(),s})(this,h);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();s=((t,e,n)=>{const s=z(t),i=[];for(const o of s.outputs)o[1]===n&&(Q(o)?lt(t,e,...o):dt(t,e,...o),i.push(o[0]),s.outputs.delete(o));return i})(this,h,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(Y(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw i();if(s=((t,e,n,s,i)=>{const o=z(t);return Array.from(o.outputs).filter(t=>!(t[0]!==n||void 0!==s&&t[1]!==s||void 0!==i&&t[2]!==i)).map(n=>(Q(n)?lt(t,e,...n):dt(t,e,...n),o.outputs.delete(n),n[0]))})(this,h,t,e,n),0===s.length)throw o()}for(const t of s){const e=c([this],t);ct(e,a)}}})((Ze=h,(t,e,n)=>{const s=[];for(let t=0;t<n.numberOfInputs;t+=1)s.push(new Set);Ze.set(t,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,s,i,o,r,a,c,h,u,l,d)=>(p,f,m,_,g)=>{const{activeInputs:y,passiveInputs:v}=o(f),{outputs:x}=o(p),b=a(p),w=o=>{const a=c(f),h=c(p);if(o){const e=S(v,p,m,_);t(y,p,e,!1),g||l(p)||n(h,a,m,_),d(f)&&k(f)}else{const t=s(y,p,m,_);e(v,_,t,!1),g||l(p)||i(h,a,m,_);const n=r(f);0===n?u(f)&&O(f,y):setTimeout(()=>{u(f)&&O(f,y)},1e3*n)}};return!!h(x,[f,m,_],t=>t[0]===f&&t[1]===m&&t[2]===_,!0)&&(b.add(w),u(p)?t(y,p,[m,_,w],!0):e(v,_,[p,m,w],!0),!0)})(fe,_e,J,ge,nt,z,ve,A,st,Z,j,ot,rt),xe,((t,e,n,s,i,o)=>r=>(a,c)=>{const h=t.get(a);if(void 0===h){if(!r&&o(a)){const t=s(a),{outputs:o}=n(a);for(const n of o)if(Q(n)){const i=s(n[0]);e(t,i,n[1],n[2])}else{const e=i(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,h+c)})(m,nt,z,st,it,j),I,Dt,$t,((t,e,n,s,i,o,r,a)=>(c,h)=>{const u=e.get(c);if(void 0===u)throw new Error("Missing the expected cycle count.");const l=o(c.context),d=a(l);if(u===h){if(e.delete(c),!d&&r(c)){const e=s(c),{outputs:o}=n(c);for(const n of o)if(Q(n)){const i=s(n[0]);t(e,i,n[1],n[2])}else{const t=i(n[0]);e.connect(t,n[1])}}}else e.set(c,u-h)})(J,m,z,st,it,Ie,j,Ve),((t,e,n)=>function s(i,o){const r=Y(o)?o:n(t,o);if((t=>"delayTime"in t)(r))return[];if(i[0]===r)return[i];if(i.includes(r))return[];const{outputs:a}=e(r);return Array.from(a).map(t=>s([...i,r],t[0])).reduce((t,e)=>t.concat(e),[])})(je,z,T),Le,Ie,We,Ge,Ye,Ve);var Ze;const Xe=((t,e,n,s,i,o)=>class extends t{constructor(t,n){const r=i(t),a={...P,...n},c=s(r,a);super(t,!1,c,o(r)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Qe,Oe,I,Me,Ie,Ve),He=new WeakSet,$e=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Te),Je=(Ke=new Uint32Array(1),t=>(Ke[0]=t,Ke[0]));var Ke;const tn=((t,e)=>n=>{n.copyFromChannel=(s,i,o=0)=>{const r=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,h=n.getChannelData(a),u=s.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)s[t]=h[t+r]},n.copyToChannel=(s,i,o=0)=>{const r=t(o),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,h=n.getChannelData(a),u=s.length;for(let t=r<0?-r:0;t+r<c&&t<u;t+=1)h[t+r]=s[t]}})(Je,I),en=(t=>e=>{e.copyFromChannel=(n=>(s,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return n.call(e,s,a,r)})(e.copyFromChannel),e.copyToChannel=(n=>(s,i,o=0)=>{const r=t(o),a=t(i);if(r<e.length)return n.call(e,s,a,r)})(e.copyToChannel)})(Je),nn=((t,e,n,s,i,o,r,a)=>{let c=null;return class h{constructor(h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:l,sampleRate:d}={...F,...h};null===c&&(c=new i(1,1,44100));const p=null!==s&&e(o,o)?new s({length:u,numberOfChannels:l,sampleRate:d}):c.createBuffer(l,u,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(r(p),q(p)):e(R,()=>R(p))||a(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===h.prototype||t.has(e)}}})(He,xe,$t,$e,Fe,(sn=$e,()=>{if(null===sn)return!1;try{new sn({length:1,sampleRate:44100})}catch{return!1}return!0}),tn,en);var sn;const on=(rn=Qt,(t,e)=>{const n=rn(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);const s=()=>{e.removeEventListener("ended",s),e.disconnect(n),n.disconnect()};e.addEventListener("ended",s)});var rn;const an=((t,e,n)=>async(s,i,o,r)=>{const a=e(s);await Promise.all(Array.from(a.activeInputs).map(async([e,s])=>{const a=t(e),c=await a.render(e,i,r);n(e)||c.connect(o,s)}))})(ke,B,ot),cn=(t=>(e,n,s,i)=>t(n,e,s,i))(an),hn=((t,e,n,s,i,o,r,a,c,h,u)=>(l,d)=>{const p=l.createBufferSource();return Ft(p,d),Nt(p,d,"playbackRate"),qt(p,d,"buffer"),qt(p,d,"loop"),qt(p,d,"loopEnd"),qt(p,d,"loopStart"),e(n,()=>n(l))||(t=>{t.start=(e=>{let n=!1;return(s=0,i=0,o)=>{if(n)throw Ct();e.call(t,s,i,o),n=!0}})(t.start)})(p),e(s,()=>s(l))||c(p),e(i,()=>i(l))||h(p,l),e(o,()=>o(l))||jt(p),e(r,()=>r(l))||u(p,l),e(a,()=>a(l))||Lt(p),t(l,p),p})(on,xe,t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},ae,ce,he,t=>{var e;t.start=(e=t.start,(n=0,s=0,i)=>{const o=t.buffer,r=null===o?s:Math.min(o.duration,s);null!==o&&r>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,r,i)})},(un=re,(t,e)=>{const n=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),un(t,"buffer",e=>()=>{const s=e.call(t);return s===n?null:s},e=>s=>e.call(t,null===s?n:s))}),de);var un;const ln=((t,e)=>(n,s,i,o)=>(t(s).replay(i),e(s,n,i,o)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(B),an),dn=((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=n(c);const d=E(l,h);if(!d){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(h,t),null!==r&&l.start(...r),null!==a&&l.stop(a)}return o.set(h,l),d?await t(h,c.playbackRate,l.playbackRate,u):await s(h,c.playbackRate,l.playbackRate,u),await i(c,h,l,u),l})(c,h,u)}}})(cn,hn,st,ln,De),pn=((t,e,n,s,i,o,r,c,h,u,l,d)=>(p,f,m,_=null,g=null)=>{const y=new a.AutomationEventList(m.defaultValue),v=f?s(y):null,x={get defaultValue(){return m.defaultValue},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,x.setValueAtTime(t,p.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===v&&y.flush(p.context.currentTime),y.add(i(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(y).pop();null===v&&y.flush(p.context.currentTime),y.add(i(t));const n=Array.from(y).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return x},cancelScheduledValues:t=>(null===v&&y.flush(p.context.currentTime),y.add(o(t)),m.cancelScheduledValues(t),x),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===v&&y.flush(p.context.currentTime),y.add(r(t,e)),m.exponentialRampToValueAtTime(t,e),x},linearRampToValueAtTime:(t,e)=>(null===v&&y.flush(p.context.currentTime),y.add(c(t,e)),m.linearRampToValueAtTime(t,e),x),setTargetAtTime:(t,e,n)=>(null===v&&y.flush(p.context.currentTime),y.add(h(t,e,n)),m.setTargetAtTime(t,e,n),x),setValueAtTime:(t,e)=>(null===v&&y.flush(p.context.currentTime),y.add(u(t,e)),m.setValueAtTime(t,e),x),setValueCurveAtTime(t,e,n){const s=t instanceof Float32Array?t:new Float32Array(t);if(null!==d&&"webkitAudioContext"===d.name){const t=e+n,i=p.context.sampleRate,o=Math.ceil(e*i),r=Math.floor(t*i),a=r-o,c=new Float32Array(a);for(let t=0;t<a;t+=1){const r=(s.length-1)/n*((o+t)/i-e),a=Math.floor(r),h=Math.ceil(r);c[t]=a===h?s[a]:(1-(r-a))*s[a]+(1-(h-r))*s[h]}null===v&&y.flush(p.context.currentTime),y.add(l(c,e,n)),m.setValueCurveAtTime(c,e,n);const h=r/i;h<t&&x.setValueAtTime(c[c.length-1],h),x.setValueAtTime(s[s.length-1],t)}else null===v&&y.flush(p.context.currentTime),y.add(l(s,e,n)),m.setValueCurveAtTime(s,e,n);return x}};return n.set(x,m),e.set(x,p),t(x,v),x})((fn=l,(t,e)=>{fn.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),je,d,t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:s}=n;e.exponentialRampToValueAtTime(s,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:s}=n;e.linearRampToValueAtTime(s,t)}else if("setTarget"===n.type){const{startTime:t,target:s,timeConstant:i}=n;e.setTargetAtTime(s,t,i)}else if("setValue"===n.type){const{startTime:t,value:s}=n;e.setValueAtTime(s,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:s,values:i}=n;e.setValueCurveAtTime(i,s,t)}}}}),a.createCancelAndHoldAutomationEvent,a.createCancelScheduledValuesAutomationEvent,a.createExponentialRampToValueAutomationEvent,a.createLinearRampToValueAutomationEvent,a.createSetTargetAutomationEvent,a.createSetValueAutomationEvent,a.createSetValueCurveAutomationEvent,Be);var fn;const mn=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,s){const a=o(t),c={...L,...s},h=i(a,c),u=r(a),l=u?e():null;super(t,!1,h,l),this._audioBufferSourceNodeRenderer=l,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=n(this,u,h.playbackRate,N,V)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){k(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),j(this)&&D(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Qe,dn,pn,Ct,hn,Ie,Ve,pe),_n=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,n){const s=o(t),c=r(s),h=i(s,n,c);super(t,!1,h,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Qe,t=>{let e=null;return{render:(n,s,i)=>(null===e&&(e=(async(e,n,s)=>{const i=n.destination;return await t(e,n,i,s),i})(n,s,i)),e)}},I,Ct,((t,e)=>(n,s,i)=>{const o=n.destination;if(o.channelCount!==s)try{o.channelCount=s}catch{}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:s});const r=t(n,{channelCount:s,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(r,"channelCount",t=>()=>t.call(r),t=>e=>{t.call(r,e);try{o.channelCount=e}catch(t){if(e>o.maxChannelCount)throw t}}),e(r,"channelCountMode",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelCountMode=e}),e(r,"channelInterpretation",t=>()=>t.call(r),t=>e=>{t.call(r,e),o.channelInterpretation=e}),Object.defineProperty(r,"maxChannelCount",{get:()=>o.maxChannelCount}),r.connect(o),r})(Qt,re),Ie,Ve,De),gn=((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=n(r);const u=E(h,a);if(!u){const t={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=e(a,t)}return o.set(a,h),u?(await t(a,r.Q,h.Q,c),await t(a,r.detune,h.detune,c),await t(a,r.frequency,h.frequency,c),await t(a,r.gain,h.gain,c)):(await s(a,r.Q,h.Q,c),await s(a,r.detune,h.detune,c),await s(a,r.frequency,h.frequency,c),await s(a,r.gain,h.gain,c)),await i(r,a,h,c),h})(r,a,c)}}})(cn,Wt,st,ln,De),yn=(t=>(e,n)=>t.set(e,n))(ye),vn=(xn=Qe,bn=pn,wn=gn,Tn=Dt,Mn=Wt,Sn=Ie,An=Ve,kn=yn,class extends xn{constructor(t,e){const n=Sn(t),s={...vt,...e},i=Mn(n,s),o=An(n);super(t,!1,i,o?wn():null),this._Q=bn(this,o,i.Q,N,V),this._detune=bn(this,o,i.detune,1200*Math.log2(N),-1200*Math.log2(N)),this._frequency=bn(this,o,i.frequency,t.sampleRate/2,0),this._gain=bn(this,o,i.gain,40*Math.log10(N),V),this._nativeBiquadFilterNode=i,kn(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n),t.length!==e.length||e.length!==n.length)throw Tn()}});var xn,bn,wn,Tn,Mn,Sn,An,kn;const Cn=((t,e)=>(n,s,i)=>{const o=new Set;var r,a;return n.connect=(r=n.connect,(i,a=0,c=0)=>{const h=0===o.size;if(e(i))return r.call(n,i,a,c),t(o,[i,a,c],t=>t[0]===i&&t[1]===a&&t[2]===c,!0),h&&s(),i;r.call(n,i,a),t(o,[i,a],t=>t[0]===i&&t[1]===a,!0),h&&s()}),n.disconnect=(a=n.disconnect,(t,s,r)=>{const c=o.size>0;if(void 0===t)a.apply(n),o.clear();else if("number"==typeof t){a.call(n,t);for(const e of o)e[1]===t&&o.delete(e)}else{e(t)?a.call(n,t,s,r):a.call(n,t,s);for(const e of o)e[0]!==t||void 0!==s&&e[1]!==s||void 0!==r&&e[2]!==r||o.delete(e)}const h=0===o.size;c&&h&&i()}),n})(Z,Ge),Dn=(On=Ct,Pn=Cn,(t,e)=>{e.channelCount=1,e.channelCountMode="explicit",Object.defineProperty(e,"channelCount",{get:()=>1,set:()=>{throw On()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:()=>{throw On()}});const n=t.createBufferSource();Pn(e,()=>{const t=e.numberOfInputs;for(let s=0;s<t;s+=1)n.connect(e,0,s)},()=>n.disconnect(e))});var On,Pn;const En=((t,e)=>(n,s)=>{const i=n.createChannelMerger(s.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,i),Ft(i,s),i})(Be,Dn),Rn=((t,e,n,s,i)=>class extends t{constructor(t,o){const r=s(t),a={...xt,...o};super(t,!1,n(r,a),i(r)?e():null)}})(Qe,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,e)}return s.set(o,a),await n(i,o,a,r),a})(i,o,r)}}})(En,st,De),En,Ie,Ve),In=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c=o({...bt,...r});super(t,!1,n(a,c),i(a)?e():null)}})(Qe,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,e)}return s.set(o,a),await n(i,o,a,r),a})(i,o,r)}}})(Ut,st,De),Ut,Ie,Ve,t=>({...t,channelCount:t.numberOfOutputs})),qn=((t,e,n,s)=>(i,{offset:o,...r})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),h=n(i,{...r,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const l={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get offset(){return h.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),s(Gt(l,h),()=>c.connect(h),()=>c.disconnect(h))})(on,hn,Qt,Cn),Fn=((t,e,n,s,i)=>(o,r)=>{if(void 0===o.createConstantSource)return n(o,r);const a=o.createConstantSource();return Ft(a,r),Nt(a,r,"offset"),e(s,()=>s(o))||jt(a),e(i,()=>i(o))||Lt(a),t(o,a),a})(on,xe,qn,ae,he),Vn=((t,e,n,s,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...wt,...r},h=s(a,c),u=o(a),l=u?n():null;super(t,!1,h,l),this._constantSourceNodeRenderer=l,this._nativeConstantSourceNode=h,this._offset=e(this,u,h.offset,N,V),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){k(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),j(this)&&D(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Qe,pn,((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null;return{set start(t){r=t},set stop(t){a=t},render(c,h,u){const l=o.get(h);return void 0!==l?Promise.resolve(l):(async(c,h,u)=>{let l=n(c);const d=E(l,h);if(!d){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(h,t),null!==r&&l.start(r),null!==a&&l.stop(a)}return o.set(h,l),d?await t(h,c.offset,l.offset,u):await s(h,c.offset,l.offset,u),await i(c,h,l,u),l})(c,h,u)}}})(cn,Fn,st,ln,De),Fn,Ie,Ve,pe),Nn=((t,e)=>(n,s)=>{const i=n.createConvolver();if(Ft(i,s),s.disableNormalization===i.normalize&&(i.normalize=!s.disableNormalization),qt(i,s,"buffer"),s.channelCount>2)throw t();if(e(i,"channelCount",t=>()=>t.call(i),e=>n=>{if(n>2)throw t();return e.call(i,n)}),"max"===s.channelCountMode)throw t();return e(i,"channelCountMode",t=>()=>t.call(i),e=>n=>{if("max"===n)throw t();return e.call(i,n)}),i})($t,re),jn=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c={...Tt,...r},h=n(a,c);super(t,!1,h,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=h,null!==c.buffer&&o(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,o(this,0)}else this._isBufferNullified=!1,o(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Qe,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,e)}return s.set(o,a),$(a)?await n(i,o,a.inputs[0],r):await n(i,o,a,r),a})(i,o,r)}}})(Nn,st,De),Nn,Ie,Ve,yn),Ln=((t,e,n,s,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...Mt,...a},u=s(c,h),l=o(c);super(t,!1,u,l?n(h.maxDelayTime):null),this._delayTime=e(this,l,u.delayTime),r(this,h.maxDelayTime)}get delayTime(){return this._delayTime}})(Qe,pn,((t,e,n,s,i)=>o=>{const r=new WeakMap;return{render(a,c,h){const u=r.get(c);return void 0!==u?Promise.resolve(u):(async(a,c,h)=>{let u=n(a);const l=E(u,c);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:o};u=e(c,t)}return r.set(c,u),l?await t(c,a.delayTime,u.delayTime,h):await s(c,a.delayTime,u.delayTime,h),await i(a,c,u,h),u})(a,c,h)}}})(cn,Yt,st,ln,De),Yt,Ie,Ve,yn),zn=(Bn=$t,(t,e)=>{const n=t.createDynamicsCompressor();if(Ft(n,e),e.channelCount>2)throw Bn();if("max"===e.channelCountMode)throw Bn();return Nt(n,e,"attack"),Nt(n,e,"knee"),Nt(n,e,"ratio"),Nt(n,e,"release"),Nt(n,e,"threshold"),n});var Bn;const Wn=((t,e,n,s,i,o,r,a)=>class extends t{constructor(t,i){const c=o(t),h={...At,...i},u=s(c,h),l=r(c);super(t,!1,u,l?n():null),this._attack=e(this,l,u.attack),this._knee=e(this,l,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=e(this,l,u.ratio),this._release=e(this,l,u.release),this._threshold=e(this,l,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Qe,pn,((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=n(r);const u=E(h,a);if(!u){const t={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=e(a,t)}return o.set(a,h),u?(await t(a,r.attack,h.attack,c),await t(a,r.knee,h.knee,c),await t(a,r.ratio,h.ratio,c),await t(a,r.release,h.release,c),await t(a,r.threshold,h.threshold,c)):(await s(a,r.attack,h.attack,c),await s(a,r.knee,h.knee,c),await s(a,r.ratio,h.ratio,c),await s(a,r.release,h.release,c),await s(a,r.threshold,h.threshold,c)),await i(r,a,h,c),h})(r,a,c)}}})(cn,zn,st,ln,De),zn,$t,Ie,Ve,yn),Un=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...kt,...r},h=s(a,c),u=o(a);super(t,!1,h,u?n():null),this._gain=e(this,u,h.gain,N,V)}get gain(){return this._gain}})(Qe,pn,((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=n(r);const u=E(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.gain,h.gain,c):await s(a,r.gain,h.gain,c),await i(r,a,h,c),h})(r,a,c)}}})(cn,Qt,st,ln,De),Qt,Ie,Ve),Gn=((t,e,n,s)=>(i,o,{channelCount:r,channelCountMode:a,channelInterpretation:c,feedback:h,feedforward:u})=>{const l=zt(o,i.sampleRate),d=h instanceof Float64Array?h:new Float64Array(h),p=u instanceof Float64Array?u:new Float64Array(u),f=d.length,m=p.length,_=Math.min(f,m);if(0===f||f>20)throw s();if(0===d[0])throw e();if(0===m||m>20)throw s();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<m;t+=1)p[t]/=d[0];for(let t=1;t<f;t+=1)d[t]/=d[0]}const g=n(i,l,r,r);g.channelCount=r,g.channelCountMode=a,g.channelInterpretation=c;const y=[],v=[],x=[];for(let t=0;t<r;t+=1){y.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),v.push(t),x.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,s=e.numberOfChannels;for(let t=0;t<s;t+=1){const s=e.getChannelData(t),i=n.getChannelData(t);y[t]=Pt(d,f,p,m,_,v[t],x[t],y[t],32,s,i)}};const b=i.sampleRate/2;return Gt({get bufferSize(){return l},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,s){if(e.length!==n.length||n.length!==s.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/b),o=[Math.cos(i),Math.sin(i)],r=Zt(Xt(p,o),Xt(d,o));n[t]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),s[t]=Math.atan2(r[1],r[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Dt,Ct,Ht,$t),Yn=((t,e,n,s)=>i=>t(Rt,()=>Rt(i))?Promise.resolve(t(s,s)).then(t=>{if(!t){const t=n(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()}):new Promise(t=>{const n=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(i.destination),i.startRendering()}))(xe,Qt,Ht,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),s=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{n.oncomplete=()=>{s.disconnect(),t(0!==n.currentTime)},n.startRendering()})})(Qt,Fe)),Qn=((t,e,n,s,i)=>(o,r)=>{const a=new WeakMap;let c=null;const h=async(h,u,l)=>{let d=null,p=e(h);const f=E(p,u);if(void 0===u.createIIRFilter?d=t(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=u.createIIRFilter(r,o)),a.set(u,null===d?p:d),null!==d){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(h.context.destination.channelCount,h.context.length,u.sampleRate);c=(async()=>{await s(h,t,t.destination,l);return((t,e,n,s)=>{const i=n instanceof Float64Array?n:new Float64Array(n),o=s instanceof Float64Array?s:new Float64Array(s),r=i.length,a=o.length,c=Math.min(r,a);if(1!==i[0]){for(let t=0;t<r;t+=1)o[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const h=new Float32Array(32),u=new Float32Array(32),l=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let e=0;e<d;e+=1){const n=t.getChannelData(e),s=l.getChannelData(e);h.fill(0),u.fill(0),Pt(i,r,o,a,c,h,u,0,32,n,s)}return l})(await i(t),u,o,r)})()}const t=await c;return d.buffer=t,d.start(0),d}return await s(h,u,p,l),p};return{render(t,e,n){const s=a.get(e);return void 0!==s?Promise.resolve(s):h(t,e,n)}}})(hn,st,Fe,De,Yn);var Zn;const Xn=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=s(t),c=i(a),h={...Ot,...r},u=e(a,c?null:t.baseLatency,h);super(t,!1,u,c?n(h.feedback,h.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,s,i)=>{if(n.length!==s.length||s.length!==i.length)throw Dt();return e.call(t,n,s,i)})})(u),this._nativeIIRFilterNode=u,o(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Qe,(Zn=Gn,(t,e,n)=>{if(void 0===t.createIIRFilter)return Zn(t,e,n);const s=t.createIIRFilter(n.feedforward,n.feedback);return Ft(s,n),s}),Qn,Ie,Ve,yn),Hn=((t,e,n,s,i)=>(o,r)=>{const a=r.listener,{forwardX:c,forwardY:h,forwardZ:u,positionX:l,positionY:d,positionZ:p,upX:f,upY:m,upZ:_}=void 0===a.forwardX?(()=>{const c=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),h=i(r),u=s(r,256,9,0),l=(e,s)=>{const i=n(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:s});return i.connect(c,0,e),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>s}),t({context:o},h,i.offset,N,V)};let d=[0,0,-1,0,1,0],p=[0,0,0];return u.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some((t,e)=>t!==d[e])&&(a.setOrientation(...e),d=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some((t,e)=>t!==p[e])&&(a.setPosition(...n),p=n)},c.connect(u),{forwardX:l(0,0),forwardY:l(1,0),forwardZ:l(2,-1),positionX:l(6,0),positionY:l(7,0),positionZ:l(8,0),upX:l(3,0),upY:l(4,1),upZ:l(5,0)}})():a;return{get forwardX(){return c},get forwardY(){return h},get forwardZ(){return u},get positionX(){return l},get positionY(){return d},get positionZ(){return p},get upX(){return f},get upY(){return m},get upZ(){return _}}})(pn,En,Fn,Ht,Ve),$n=new WeakMap,Jn=((t,e,n,s,i,o)=>class extends n{constructor(n,o){super(n),this._nativeContext=n,p.set(this,n),s(n)&&i.set(n,new Set),this._destination=new t(this,o),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?o(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(_n,Hn,Le,Ve,$n,pe),Kn=((t,e,n,s,i,o)=>(r,a)=>{const c=r.createOscillator();return Ft(c,a),Nt(c,a,"detune"),Nt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):qt(c,a,"type"),e(n,()=>n(r))||jt(c),e(s,()=>s(r))||o(c,r),e(i,()=>i(r))||Lt(c),t(r,c),c})(on,xe,ae,ce,he,de),ts=((t,e,n,s,i,o,r)=>class extends t{constructor(t,r){const a=i(t),c={...Kt,...r},h=n(a,c),u=o(a),l=u?s():null,d=t.sampleRate/2;super(t,!1,h,l),this._detune=e(this,u,h.detune,153600,-153600),this._frequency=e(this,u,h.frequency,d,-d),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=l,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?r(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){k(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),j(this)&&D(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Qe,pn,Kn,((t,e,n,s,i)=>()=>{const o=new WeakMap;let r=null,a=null,c=null;return{set periodicWave(t){r=t},set start(t){a=t},set stop(t){c=t},render(h,u,l){const d=o.get(u);return void 0!==d?Promise.resolve(d):(async(h,u,l)=>{let d=n(h);const p=E(d,u);if(!p){const t={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===r?void 0:r,type:d.type};d=e(u,t),null!==a&&d.start(a),null!==c&&d.stop(c)}return o.set(u,d),p?(await t(u,h.detune,d.detune,l),await t(u,h.frequency,d.frequency,l)):(await s(u,h.detune,d.detune,l),await s(u,h.frequency,d.frequency,l)),await i(h,u,d,l),d})(h,u,l)}}})(cn,Kn,st,ln,De),Ie,Ve,pe),es=(ns=hn,(t,e)=>{const n=ns(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=t.createBuffer(1,2,44100);return n.buffer=s,n.loop=!0,n.connect(e),n.start(),()=>{n.stop(),n.disconnect(e)}});var ns;const ss=((t,e,n,s,i)=>(o,{curve:r,oversample:a,...c})=>{const h=o.createWaveShaper(),u=o.createWaveShaper();Ft(h,c),Ft(u,c);const l=n(o,{...c,gain:1}),d=n(o,{...c,gain:-1}),p=n(o,{...c,gain:1}),f=n(o,{...c,gain:-1});let m=null,_=!1,g=null;const y={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){l.channelCount=t,d.channelCount=t,h.channelCount=t,p.channelCount=t,u.channelCount=t,f.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){l.channelCountMode=t,d.channelCountMode=t,h.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t,d.channelInterpretation=t,h.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,f.channelInterpretation=t},get context(){return h.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)h.curve=n,u.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),s=new Float32Array(t+2-t%2);e[0]=n[0],s[0]=-n[t-1];const i=Math.ceil((t+1)/2),o=(t+1)/2-1;for(let r=1;r<i;r+=1){const a=r/i*o,c=Math.floor(a),h=Math.ceil(a);e[r]=c===h?n[c]:(1-(a-c))*n[c]+(1-(h-a))*n[h],s[r]=c===h?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(h-a))*n[t-1-h]}e[i]=t%2==1?n[i-1]:(n[i-2]+n[i-1])/2,h.curve=e,u.curve=s}g=n,_&&(s(g)&&null===m?m=t(o,l):null!==m&&(m(),m=null))},get inputs(){return[l]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(t){h.oversample=t,u.oversample=t},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};null!==r&&(y.curve=r instanceof Float32Array?r:new Float32Array(r)),a!==y.oversample&&(y.oversample=a);return i(Gt(y,p),()=>{l.connect(h).connect(p),l.connect(d).connect(u).connect(f).connect(p),_=!0,s(g)&&(m=t(o,l))},()=>{l.disconnect(h),h.disconnect(p),l.disconnect(d),d.disconnect(u),u.disconnect(f),f.disconnect(p),_=!1,null!==m&&(m(),m=null)})})(es,Ct,Qt,oe,Cn),is=((t,e,n,s,i,o,r)=>(a,c)=>{const h=a.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name)return n(a,c);Ft(h,c);const u=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==u&&u.length<2)throw e();qt(h,{curve:u},"curve"),qt(h,c,"oversample");let l=null,d=!1;r(h,"curve",t=>()=>t.call(h),e=>n=>(e.call(h,n),d&&(s(n)&&null===l?l=t(a,h):s(n)||null===l||(l(),l=null)),n));return i(h,()=>{d=!0,s(h.curve)&&(l=t(a,h))},()=>{d=!1,null!==l&&(l(),l=null)})})(es,Ct,ss,oe,Cn,Be,re),os=((t,e,n,s,i,o,r,a,c)=>(h,{coneInnerAngle:u,coneOuterAngle:l,coneOuterGain:d,distanceModel:p,maxDistance:f,orientationX:m,orientationY:_,orientationZ:g,panningModel:y,positionX:v,positionY:x,positionZ:b,refDistance:w,rolloffFactor:T,...M})=>{const S=h.createPanner();if(M.channelCount>2)throw r();if("max"===M.channelCountMode)throw r();Ft(S,M);const A={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},k=n(h,{...A,channelInterpretation:"speakers",numberOfInputs:6}),C=s(h,{...M,gain:1}),D=s(h,{...A,gain:1}),O=s(h,{...A,gain:0}),P=s(h,{...A,gain:0}),E=s(h,{...A,gain:0}),R=s(h,{...A,gain:0}),I=s(h,{...A,gain:0}),q=i(h,256,6,1),F=o(h,{...A,curve:new Float32Array([1,1]),oversample:"none"});let V=[m,_,g],N=[v,x,b];q.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some((t,e)=>t!==V[e])&&(S.setOrientation(...e),V=e);const n=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some((t,e)=>t!==N[e])&&(S.setPosition(...n),N=n)},Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0});const j={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(t){if(t>2)throw r();C.channelCount=t,S.channelCount=t},get channelCountMode(){return S.channelCountMode},set channelCountMode(t){if("max"===t)throw r();C.channelCountMode=t,S.channelCountMode=t},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(t){C.channelInterpretation=t,S.channelInterpretation=t},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(t){S.coneInnerAngle=t},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(t){S.coneOuterAngle=t},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();S.coneOuterGain=t},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(t){S.distanceModel=t},get inputs(){return[C]},get maxDistance(){return S.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;S.maxDistance=t},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return D.gain},get orientationY(){return O.gain},get orientationZ(){return P.gain},get panningModel(){return S.panningModel},set panningModel(t){S.panningModel=t},get positionX(){return E.gain},get positionY(){return R.gain},get positionZ(){return I.gain},get refDistance(){return S.refDistance},set refDistance(t){if(t<0)throw new RangeError;S.refDistance=t},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;S.rolloffFactor=t},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])};u!==j.coneInnerAngle&&(j.coneInnerAngle=u),l!==j.coneOuterAngle&&(j.coneOuterAngle=l),d!==j.coneOuterGain&&(j.coneOuterGain=d),p!==j.distanceModel&&(j.distanceModel=p),f!==j.maxDistance&&(j.maxDistance=f),m!==j.orientationX.value&&(j.orientationX.value=m),_!==j.orientationY.value&&(j.orientationY.value=_),g!==j.orientationZ.value&&(j.orientationZ.value=g),y!==j.panningModel&&(j.panningModel=y),v!==j.positionX.value&&(j.positionX.value=v),x!==j.positionY.value&&(j.positionY.value=x),b!==j.positionZ.value&&(j.positionZ.value=b),w!==j.refDistance&&(j.refDistance=w),T!==j.rolloffFactor&&(j.rolloffFactor=T),1===V[0]&&0===V[1]&&0===V[2]||S.setOrientation(...V),0===N[0]&&0===N[1]&&0===N[2]||S.setPosition(...N);return c(Gt(j,S),()=>{C.connect(S),t(C,F,0,0),F.connect(D).connect(k,0,0),F.connect(O).connect(k,0,1),F.connect(P).connect(k,0,2),F.connect(E).connect(k,0,3),F.connect(R).connect(k,0,4),F.connect(I).connect(k,0,5),k.connect(q).connect(h.destination)},()=>{C.disconnect(S),a(C,F,0,0),F.disconnect(D),D.disconnect(k),F.disconnect(O),O.disconnect(k),F.disconnect(P),P.disconnect(k),F.disconnect(E),E.disconnect(k),F.disconnect(R),R.disconnect(k),F.disconnect(I),I.disconnect(k),k.disconnect(q),q.disconnect(h.destination)})})(J,Ct,En,Qt,Ht,is,$t,nt,Cn),rs=(as=os,(t,e)=>{const n=t.createPanner();return void 0===n.orientationX?as(t,e):(Ft(n,e),Nt(n,e,"orientationX"),Nt(n,e,"orientationY"),Nt(n,e,"orientationZ"),Nt(n,e,"positionX"),Nt(n,e,"positionY"),Nt(n,e,"positionZ"),qt(n,e,"coneInnerAngle"),qt(n,e,"coneOuterAngle"),qt(n,e,"coneOuterGain"),qt(n,e,"distanceModel"),qt(n,e,"maxDistance"),qt(n,e,"panningModel"),qt(n,e,"refDistance"),qt(n,e,"rolloffFactor"),n)});var as;const cs=((t,e,n,s,i,o,r)=>class extends t{constructor(t,a){const c=i(t),h={...te,...a},u=n(c,h),l=o(c);super(t,!1,u,l?s():null),this._nativePannerNode=u,this._orientationX=e(this,l,u.orientationX,N,V),this._orientationY=e(this,l,u.orientationY,N,V),this._orientationZ=e(this,l,u.orientationZ,N,V),this._positionX=e(this,l,u.positionX,N,V),this._positionY=e(this,l,u.positionY,N,V),this._positionZ=e(this,l,u.positionZ,N,V),r(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Qe,pn,rs,((t,e,n,s,i,o,r,a,c,h)=>()=>{const u=new WeakMap;let l=null;return{render(d,p,f){const m=u.get(p);return void 0!==m?Promise.resolve(m):(async(d,p,f)=>{let m=null,_=o(d);const g={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},y={...g,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},v=E(_,p);if("bufferSize"in _)m=s(p,{...g,gain:1});else if(!v){const t={...y,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=i(p,t)}if(u.set(p,null===m?_:m),null!==m){if(null===l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new r(6,d.context.length,p.sampleRate),s=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});s.connect(t.destination),l=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(e,s)=>{const i=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===s?1:0});return await a(t,e,i.offset,f),i}));for(let t=0;t<6;t+=1)e[t].connect(s,0,t),e[t].start(0);return h(t)})()}const t=await l,o=s(p,{...g,gain:1});await c(d,p,o,f);const u=[];for(let e=0;e<t.numberOfChannels;e+=1)u.push(t.getChannelData(e));let _=[u[0][0],u[1][0],u[2][0]],v=[u[3][0],u[4][0],u[5][0]],x=s(p,{...g,gain:1}),b=i(p,{...y,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]});o.connect(x).connect(b.inputs[0]),b.connect(m);for(let e=128;e<t.length;e+=128){const t=[u[0][e],u[1][e],u[2][e]],n=[u[3][e],u[4][e],u[5][e]];if(t.some((t,e)=>t!==_[e])||n.some((t,e)=>t!==v[e])){_=t,v=n;const r=e/p.sampleRate;x.gain.setValueAtTime(0,r),x=s(p,{...g,gain:0}),b=i(p,{...y,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),x.gain.setValueAtTime(1,r),o.connect(x).connect(b.inputs[0]),b.connect(m)}}return m}return v?(await t(p,d.orientationX,_.orientationX,f),await t(p,d.orientationY,_.orientationY,f),await t(p,d.orientationZ,_.orientationZ,f),await t(p,d.positionX,_.positionX,f),await t(p,d.positionY,_.positionY,f),await t(p,d.positionZ,_.positionZ,f)):(await a(p,d.orientationX,_.orientationX,f),await a(p,d.orientationY,_.orientationY,f),await a(p,d.orientationZ,_.orientationZ,f),await a(p,d.positionX,_.positionX,f),await a(p,d.positionY,_.positionY,f),await a(p,d.positionZ,_.positionZ,f)),$(_)?await c(d,p,_.inputs[0],f):await c(d,p,_,f),_})(d,p,f)}}})(cn,En,Fn,Qt,rs,st,Fe,ln,De,Yn),Ie,Ve,yn),hs=((t,e,n,s)=>class i{constructor(i,o){const r=e(i),a=s({...ee,...o}),c=t(r,a);return n.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:s,real:i})=>{const o=s instanceof Float32Array?s:new Float32Array(s),r=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(r,o,{disableNormalization:n});if(Array.from(s).length<2)throw t();return a})(I),Ie,new WeakSet,t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}}),us=((t,e)=>(n,s)=>{const i=s.channelCountMode;if("clamped-max"===i)throw e();if(void 0===n.createStereoPanner)return t(n,s);const o=n.createStereoPanner();return Ft(o,s),Nt(o,s,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),o})(((t,e,n,s,i,o)=>{const r=new Float32Array([1,1]),a=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...c,oversample:"none"},u=(t,o,u,l,d)=>{if(1===o)return((t,e,i,o)=>{const u=new Float32Array(16385),l=new Float32Array(16385);for(let t=0;t<16385;t+=1){const e=t/16384*a;u[t]=Math.cos(e),l[t]=Math.sin(e)}const d=n(t,{...c,gain:0}),p=s(t,{...h,curve:u}),f=s(t,{...h,curve:r}),m=n(t,{...c,gain:0}),_=s(t,{...h,curve:l});return{connectGraph(){e.connect(d),e.connect(f.inputs[0]),e.connect(m),f.connect(i),i.connect(p.inputs[0]),i.connect(_.inputs[0]),p.connect(d.gain),_.connect(m.gain),d.connect(o,0,0),m.connect(o,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(f.inputs[0]),e.disconnect(m),f.disconnect(i),i.disconnect(p.inputs[0]),i.disconnect(_.inputs[0]),p.disconnect(d.gain),_.disconnect(m.gain),d.disconnect(o,0,0),m.disconnect(o,0,1)}}})(t,u,l,d);if(2===o)return((t,i,o,u)=>{const l=new Float32Array(16385),d=new Float32Array(16385),p=new Float32Array(16385),f=new Float32Array(16385),m=Math.floor(8192.5);for(let t=0;t<16385;t+=1)if(t>m){const e=(t-m)/(16384-m)*a;l[t]=Math.cos(e),d[t]=Math.sin(e),p[t]=0,f[t]=1}else{const e=t/(16384-m)*a;l[t]=1,d[t]=0,p[t]=Math.cos(e),f[t]=Math.sin(e)}const _=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),g=n(t,{...c,gain:0}),y=s(t,{...h,curve:l}),v=n(t,{...c,gain:0}),x=s(t,{...h,curve:d}),b=s(t,{...h,curve:r}),w=n(t,{...c,gain:0}),T=s(t,{...h,curve:p}),M=n(t,{...c,gain:0}),S=s(t,{...h,curve:f});return{connectGraph(){i.connect(_),i.connect(b.inputs[0]),_.connect(g,0),_.connect(v,0),_.connect(w,1),_.connect(M,1),b.connect(o),o.connect(y.inputs[0]),o.connect(x.inputs[0]),o.connect(T.inputs[0]),o.connect(S.inputs[0]),y.connect(g.gain),x.connect(v.gain),T.connect(w.gain),S.connect(M.gain),g.connect(u,0,0),w.connect(u,0,0),v.connect(u,0,1),M.connect(u,0,1)},disconnectGraph(){i.disconnect(_),i.disconnect(b.inputs[0]),_.disconnect(g,0),_.disconnect(v,0),_.disconnect(w,1),_.disconnect(M,1),b.disconnect(o),o.disconnect(y.inputs[0]),o.disconnect(x.inputs[0]),o.disconnect(T.inputs[0]),o.disconnect(S.inputs[0]),y.disconnect(g.gain),x.disconnect(v.gain),T.disconnect(w.gain),S.disconnect(M.gain),g.disconnect(u,0,0),w.disconnect(u,0,0),v.disconnect(u,0,1),M.disconnect(u,0,1)}}})(t,u,l,d);throw i()};return(e,{channelCount:s,channelCountMode:r,pan:a,...c})=>{if("max"===r)throw i();const h=t(e,{...c,channelCount:1,channelCountMode:r,numberOfInputs:2}),l=n(e,{...c,channelCount:s,channelCountMode:r,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:f}=u(e,s,l,d,h);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(_&&f(),({connectGraph:p,disconnectGraph:f}=u(e,t,l,d,h)),_&&p()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return d.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let _=!1;return o(Gt(m,h),()=>{p(),_=!0},()=>{f(),_=!1})}})(En,Ut,Qt,is,$t,Cn),$t),ls=((t,e,n,s,i,o)=>class extends t{constructor(t,r){const a=i(t),c={...ne,...r},h=n(a,c),u=o(a);super(t,!1,h,u?s():null),this._pan=e(this,u,h.pan)}get pan(){return this._pan}})(Qe,pn,us,((t,e,n,s,i)=>()=>{const o=new WeakMap;return{render(r,a,c){const h=o.get(a);return void 0!==h?Promise.resolve(h):(async(r,a,c)=>{let h=n(r);const u=E(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=e(a,t)}return o.set(a,h),u?await t(a,r.pan,h.pan,c):await s(a,r.pan,h.pan,c),$(h)?await i(r,a,h.inputs[0],c):await i(r,a,h,c),h})(r,a,c)}}})(cn,us,st,ln,De),Ie,Ve),ds=((t,e,n)=>()=>{const s=new WeakMap;return{render(i,o,r){const a=s.get(o);return void 0!==a?Promise.resolve(a):(async(i,o,r)=>{let a=e(i);if(!E(a,o)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,e)}return s.set(o,a),$(a)?await n(i,o,a.inputs[0],r):await n(i,o,a,r),a})(i,o,r)}}})(is,st,De),ps=((t,e,n,s,i,o,r)=>class extends t{constructor(t,e){const a=i(t),c={...ie,...e},h=n(a,c);super(t,!0,h,o(a)?s():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,r(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Qe,Ct,is,ds,Ie,Ve,yn),fs=(t=>null!==t&&t.isSecureContext)(Te),ms=(t=>(e,n,s)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return s()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Te),_s=new WeakMap,gs=((t,e)=>n=>{let s=t.get(n);if(void 0!==s)return s;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,8e3),t.set(n,s),s})(_s,Fe),ys=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Te),vs=fs?((t,e,n,s,i,o,r,a,c,h,u,l)=>(d,p,f={credentials:"omit"})=>{const m=o(d),g=new URL(p,l.location.href).toString();if(void 0!==m.audioWorklet)return Promise.all([i(p),Promise.resolve(t(u,u))]).then(([t,e])=>{const[n,s]=x(t,g),i=e?s:s.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),o=new Blob([`${n};(registerProcessor=>{${i}\n})((n,p)=>registerProcessor(n,class extends p{${e?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${e?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(o);return m.audioWorklet.addModule(c,f).then(()=>{if(a(m))return;return r(m).audioWorklet.addModule(c,f)}).finally(()=>URL.revokeObjectURL(c))});const y=h.get(d);if(void 0!==y&&y.has(p))return Promise.resolve();const v=c.get(d);if(void 0!==v){const t=v.get(p);if(void 0!==t)return t}const T=i(p).then(t=>{const[e,s]=x(t,g);return n(`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${s}\n})})(window,'_AWGS')`)}).then(()=>{const t=l._AWGS.pop();if(void 0===t)throw new SyntaxError;s(m.currentTime,m.sampleRate,()=>t(class{},void 0,(t,n)=>{if(""===t.trim())throw e();const s=_.get(m);if(void 0!==s){if(s.has(t))throw e();w(n),b(n.parameterDescriptors),s.set(t,n)}else w(n),b(n.parameterDescriptors),_.set(m,new Map([[t,n]]))},m.sampleRate,void 0,void 0))});return void 0===v?c.set(d,new Map([[p,T]])):v.set(p,T),T.then(()=>{const t=h.get(d);void 0===t?h.set(d,new Set([p])):t.add(p)}).finally(()=>{const t=c.get(d);void 0!==t&&t.delete(p)}),T})(xe,$t,(t=>e=>new Promise((n,s)=>{if(null===t)return void s(new SyntaxError);const i=t.document.head;if(null===i)s(new SyntaxError);else{const o=t.document.createElement("script"),r=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(r),c=t.onerror,h=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,i,o,r)=>n===a||n===t.location.href&&1===i&&1===o?(h(),s(r),!1):null!==c?c(e,n,i,o,r):void 0,o.onerror=()=>{h(),s(new SyntaxError)},o.onload=()=>{h(),n()},o.src=a,o.type="module",i.appendChild(o)}}))(Te),ms,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch{}throw t()})(()=>new DOMException("","AbortError")),Ie,gs,Ve,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,8e3),i=URL.createObjectURL(n);let o=!1,r=!1;try{await s.audioWorklet.addModule(i);const e=new t(s,"a",{numberOfOutputs:0}),n=s.createOscillator();e.port.onmessage=()=>o=!0,e.onprocessorerror=()=>r=!0,n.connect(e),await s.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return o&&!r})(ys,Fe),Te):void 0,xs=((t,e)=>n=>t(n)||e(n))(We,Ve),bs=((t,e,n,s,i,o,r,a,c,h,u,l,d,p,f,m,_,g,y,v)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,s){return new n({length:e,numberOfChannels:t,sampleRate:s})}createBufferSource(){return new s(this)}createChannelMerger(t=6){return new o(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new r(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new u(this,{maxDelayTime:t})}createDynamicsCompressor(){return new l(this)}createGain(){return new d(this)}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new _(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new y(this)}createWaveShaper(){return new v(this)}decodeAudioData(t,e,n){return h(this._nativeContext,t).then(t=>("function"==typeof e&&e(t),t)).catch(t=>{throw"function"==typeof n&&n(t),t})}})(vs,Xe,nn,mn,vn,Rn,In,Vn,jn,((t,e,n,s,i,o,r,a,c,h,u)=>(l,d)=>{const p=r(l)?l:o(l);if(i.has(d)){const t=n();return Promise.reject(t)}try{i.add(d)}catch{}return e(c,()=>c(p))?p.decodeAudioData(d).then(n=>(e(a,()=>a(n))||u(n),t.add(n),n)):new Promise((e,n)=>{const i=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(d)}catch{}},o=t=>{n(t),i()};try{p.decodeAudioData(d,n=>{"function"!=typeof n.copyFromChannel&&(h(n),q(n)),t.add(n),i(),e(n)},t=>{o(null===t?s():t)})}catch(t){o(t)}})})(He,xe,()=>new DOMException("","DataCloneError"),()=>new DOMException("","EncodingError"),new WeakSet,Ie,xs,R,Rt,tn,en),Ln,Wn,Un,Xn,Jn,ts,cs,hs,ls,ps),ws=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t),r=e(o,i);if(s(o))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Qe,(t,e)=>t.createMediaElementSource(e.mediaElement),Ie,Ve),Ts=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t);if(s(o))throw new TypeError;const r={...Et,...i},a=e(o,r);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Qe,(t,e)=>{const n=t.createMediaStreamDestination();return Ft(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},Ie,Ve),Ms=((t,e,n,s)=>class extends t{constructor(t,i){const o=n(t),r=e(o,i);if(s(o))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Qe,(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0);const s=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(i,"mediaStream",{value:e}),i},Ie,Ve),Ss=((t,e,n)=>class extends t{constructor(t,s){const i=n(t);super(t,!0,e(i,s),null)}})(Qe,((t,e)=>(n,{mediaStreamTrack:s})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(s);const i=new MediaStream([s]),o=n.createMediaStreamSource(i);if("audio"!==s.kind)throw t();if(e(n))throw new TypeError;return o})(Ct,Ve),Ie),As=((t,e,n,s,i,o,r,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw s();if(!G(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:i}=t,{sampleRate:o}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/o:"interactive"===i||void 0===i?256/o:"playback"===i?1024/o:128*Math.max(2,Math.min(128,Math.round(i*o/128)))/o,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),U(this)}))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(t){return new r(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}})(bs,Ct,$t,se,ws,Ts,Ms,Ss,Be),ks=(Cs=$n,t=>{const e=Cs.get(t);if(void 0===e)throw new Error("The context has no set of AudioWorkletNodes.");return e});var Cs;const Ds=(Os=ks,(t,e)=>{Os(t).add(e)});var Os;const Ps=(t=>(e,n,s=0,i=0)=>{const o=e[s];if(void 0===o)throw t();return ht(n)?o.connect(n,0,i):o.connect(n,0)})(I),Es=(t=>(e,n)=>{t(e).delete(n)})(ks),Rs=(t=>(e,n,s,i=0)=>void 0===n?e.forEach(t=>t.disconnect()):"number"==typeof n?St(t,e,n).disconnect():ht(n)?void 0===s?e.forEach(t=>t.disconnect(n)):void 0===i?St(t,e,s).disconnect(n,0):St(t,e,s).disconnect(n,0,i):void 0===s?e.forEach(t=>t.disconnect(n)):St(t,e,s).disconnect(n,0))(I),Is=new WeakMap,qs=((t,e)=>n=>e(t,n))(Is,T),Fs=((t,e,n,s,i,o,r,a,c,h,u,l,d)=>(p,f,m,_)=>{if(0===_.numberOfInputs&&0===_.numberOfOutputs)throw c();const y=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(y.some(t=>t<1))throw c();if(y.length!==_.numberOfOutputs)throw e();if("explicit"!==_.channelCountMode)throw c();const v=_.channelCount*_.numberOfInputs,x=y.reduce((t,e)=>t+e,0),b=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(v+b>6||x>6)throw c();const w=new MessageChannel,T=[],M=[];for(let t=0;t<_.numberOfInputs;t+=1)T.push(r(p,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),M.push(i(p,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const S=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:s}of m.parameterDescriptors){const i=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==_.parameterData[s]?_.parameterData[s]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?N:e},minValue:{get:()=>void 0===n?V:n}}),S.push(i)}const A=s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+b)}),k=zt(f,p.sampleRate),C=a(p,k,v+b,Math.max(1,x)),D=i(p,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),O=[];for(let t=0;t<_.numberOfOutputs;t+=1)O.push(s(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[t]}));for(let t=0;t<_.numberOfInputs;t+=1){T[t].connect(M[t]);for(let e=0;e<_.channelCount;e+=1)M[t].connect(A,e,t*_.channelCount+e)}const P=new pt(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map(({name:t},e)=>{const n=S[e];return n.connect(A,0,v+e),n.start(0),[t,n.offset]}));A.connect(C);let E=_.channelInterpretation,R=null;const I=0===_.numberOfOutputs?[C]:O,q={get bufferSize(){return k},get channelCount(){return _.channelCount},set channelCount(t){throw n()},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return E},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;E=t},get context(){return C.context},get inputs(){return T},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return R},set onprocessorerror(t){"function"==typeof R&&q.removeEventListener("processorerror",R),R="function"==typeof t?t:null,"function"==typeof R&&q.addEventListener("processorerror",R)},get parameters(){return P},get port(){return w.port2},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,I),disconnect:h.bind(null,I),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])},F=new Map;var j,L;w.port1.addEventListener=(j=w.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=F.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{u(p.currentTime,p.sampleRate,()=>e(t))},F.set(e,t[1]))}}return j.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(L=w.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=F.get(t[1]);void 0!==e&&(F.delete(t[1]),t[1]=e)}return L.call(w.port1,t[0],t[1],t[2])});let z=null;Object.defineProperty(w.port1,"onmessage",{get:()=>z,set:t=>{"function"==typeof z&&w.port1.removeEventListener("message",z),z="function"==typeof t?t:null,"function"==typeof z&&(w.port1.addEventListener("message",z),w.port1.start())}}),m.prototype.port=w.port1;let B=null;((t,e,n,s)=>{let i=g.get(t);void 0===i&&(i=new WeakMap,g.set(t,i));const o=Bt(n,s);return i.set(e,o),o})(p,q,m,_).then(t=>B=t);const W=gt(_.numberOfInputs,_.channelCount),U=gt(_.numberOfOutputs,y),G=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{});let Y=!0;const Q=()=>{_.numberOfOutputs>0&&C.disconnect(D);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const n=O[t];for(let s=0;s<y[t];s+=1)D.disconnect(n,e+s,s);e+=y[t]}},Z=new Map;C.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const n=l(q);for(let s=0;s<k;s+=128){for(let e=0;e<_.numberOfInputs;e+=1)for(let n=0;n<_.channelCount;n+=1)mt(t,W[e],n,n,s);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach(({name:e},n)=>{mt(t,G,e,v+n,s)});for(let t=0;t<_.numberOfInputs;t+=1)for(let e=0;e<y[t];e+=1)0===U[t][e].byteLength&&(U[t][e]=new Float32Array(128));try{const t=W.map((t,e)=>{if(n[e].size>0)return Z.set(e,k/128),t;const s=Z.get(e);return void 0===s?[]:(t.every(t=>t.every(t=>0===t))&&(1===s?Z.delete(e):Z.set(e,s-1)),t)}),i=u(p.currentTime+s/p.sampleRate,p.sampleRate,()=>B.process(t,U,G));Y=i;for(let t=0,n=0;t<_.numberOfOutputs;t+=1){for(let i=0;i<y[t];i+=1)_t(e,U[t],i,n+i,s);n+=y[t]}}catch(t){Y=!1,q.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!Y){for(let t=0;t<_.numberOfInputs;t+=1){T[t].disconnect(M[t]);for(let e=0;e<_.channelCount;e+=1)M[s].disconnect(A,e,t*_.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=S[e];t.disconnect(A,0,v+e),t.stop()}}A.disconnect(C),C.onaudioprocess=null,X?Q():J();break}}}};let X=!1;const H=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$=()=>C.connect(H).connect(p.destination),J=()=>{C.disconnect(H),H.disconnect()};return $(),d(q,()=>{if(Y){J(),_.numberOfOutputs>0&&C.connect(D);for(let t=0,e=0;t<_.numberOfOutputs;t+=1){const n=O[t];for(let s=0;s<y[t];s+=1)D.connect(n,e+s,s);e+=y[t]}}X=!0},()=>{Y&&($(),Q()),X=!1})})(Ps,I,Ct,En,Ut,Fn,Qt,Ht,$t,Rs,ms,qs,Cn),Vs=((t,e,n,s,i)=>(o,r,a,c,h,u)=>{if(null!==a)try{const e=new a(o,c,u),s=new Map;let r=null;if(Object.defineProperties(e,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>r,set:t=>{"function"==typeof r&&e.removeEventListener("processorerror",r),r="function"==typeof t?t:null,"function"==typeof r&&e.addEventListener("processorerror",r)}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=s.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},s.set(e,t[1]))}}return d.call(e,"error",t[1],t[2]),d.call(e,...t)}),e.removeEventListener=(l=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=s.get(t[1]);void 0!==e&&(s.delete(t[1]),t[1]=e)}return l.call(e,"error",t[1],t[2]),l.call(e,t[0],t[1],t[2])}),0!==u.numberOfOutputs){const t=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(o.destination);return i(e,()=>t.disconnect(),()=>t.connect(o.destination))}return e}catch(t){if(11===t.code)throw s();throw t}var l,d;if(void 0===h)throw s();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(u),e(o,r,h,u)})(Ct,Fs,Qt,$t,Cn),Ns=((t,e,n,s,i,o,r,a,c,h,u,l,d,p,f,m)=>(_,g,y)=>{const v=new WeakMap;let x=null;return{render(b,w,T){a(w,b);const M=v.get(w);return void 0!==M?Promise.resolve(M):(async(a,b,w)=>{let T=u(a),M=null;const S=E(T,b),A=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===l){const t=A.reduce((t,e)=>t+e,0),n=i(b,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),o=[];for(let t=0;t<a.numberOfOutputs;t+=1)o.push(s(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:A[t]}));const h=r(b,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=e.bind(null,o),h.disconnect=c.bind(null,o),M=[n,o,h]}else S||(T=new l(b,_));if(v.set(b,null===M?T:M[2]),null!==M){if(null===x){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=t+e,c=async()=>{const c=new d(n,128*Math.ceil(a.context.length/128),b.sampleRate),h=[],u=[];for(let t=0;t<g.numberOfInputs;t+=1)h.push(r(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),u.push(i(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const l=await Promise.all(Array.from(a.parameters.values()).map(async t=>{const e=o(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(c,t,e.offset,w),e})),_=s(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){h[t].connect(u[t]);for(let e=0;e<g.channelCount;e+=1)u[t].connect(_,e,t*g.channelCount+e)}for(const[e,n]of l.entries())n.connect(_,0,t+e),n.start(0);return _.connect(c.destination),await Promise.all(h.map(t=>f(a,c,t,w))),m(c)};x=yt(a,0===n?null:await c(),b,g,A,y,h)}const t=await x,e=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,u,l]=M;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=u[t];for(let s=0;s<A[t];s+=1)c.connect(n,e+s,s);e+=A[t]}return l}if(S)for(const[e,n]of a.parameters.entries())await t(b,n,T.parameters.get(e),w);else for(const[t,e]of a.parameters.entries())await p(b,e,T.parameters.get(t),w);return await f(a,b,T,w),T})(b,w,T)}}})(cn,Ps,hn,En,Ut,Fn,Qt,Es,Rs,ms,st,ys,Fe,ln,De,Yn),js=(t=>e=>t.get(e))(_s),Ls=(t=>(e,n)=>{t.set(e,n)})(Is),zs=fs?((t,e,n,s,i,o,r,a,c,h,u,l,d)=>class extends e{constructor(e,d,p){var f;const m=a(e),g=c(m),y=u({...ft,...p}),v=_.get(m),x=null==v?void 0:v.get(d),b=g||"closed"!==m.state?m:null!==(f=r(m))&&void 0!==f?f:m,w=i(b,g?null:e.baseLatency,h,d,x,y);super(e,!0,w,g?s(d,y,x):null);const T=[];w.parameters.forEach((t,e)=>{const s=n(this,g,t);T.push([e,s])}),this._nativeAudioWorkletNode=w,this._onprocessorerror=null,this._parameters=new pt(T),g&&t(m,this);const{activeInputs:M}=o(this);l(w,M)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Ds,Qe,pn,Ns,Vs,z,js,Ie,Ve,ys,t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Ls,pe):void 0,Bs=(((t,e,n,s,i)=>{})(Ct,$t,se,Jn,Be),((t,e)=>(n,s,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,s,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})($t,Fe)),Ws=((t,e,n,s,i,o,r,a)=>{const c=[];return(h,u)=>n(h).render(h,u,c).then(()=>Promise.all(Array.from(s(u)).map(t=>n(t).render(t,u,c)))).then(()=>i(u)).then(n=>("function"!=typeof n.copyFromChannel?(r(n),q(n)):e(o,()=>o(n))||a(n),t.add(n),n))})(He,xe,ke,ks,Yn,R,tn,en),Us=(((t,e,n,s,i)=>{})(xe,Ct,Bs,Jn,Ws),((t,e,n,s,i)=>class extends t{constructor(t,n,i){let o;if("number"==typeof t&&void 0!==n&&void 0!==i)o={length:n,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");o=t}const{length:r,numberOfChannels:a,sampleRate:c}={...Jt,...o},h=s(a,r,c);e(Rt,()=>Rt(h))||h.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(h.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(h,a),this._length=r,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,U(this)}))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t))}})(bs,xe,Ct,Bs,Ws)),Gs=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(p,We),Ys=(Qs=u,Zs=Ge,t=>Qs.has(t)||Zs(t));var Qs,Zs;const Xs=(Hs=d,$s=Ye,t=>Hs.has(t)||$s(t));var Hs,$s;const Js=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(p,Ve),Ks=()=>(async(t,e,n,s,i,o,r,a,c,h,u,l,d,p,f,m)=>{if(t(e,e)&&t(n,n)&&t(i,i)&&t(o,o)&&t(a,a)&&t(c,c)&&t(h,h)&&t(u,u)&&t(l,l)&&t(d,d)&&t(p,p)){return(await Promise.all([t(s,s),t(r,r),t(f,f),t(m,m)])).every(t=>t)}return!1})(xe,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch{return!1}return!0})(Fe),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,n=void 0!==e.close;try{e.close()}catch{}return n})(Be),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise(t=>{let n=!0;const s=s=>{n&&(n=!1,e.startRendering(),t(s instanceof TypeError))};let i;try{i=e.decodeAudioData(null,()=>{},s)}catch(t){s(t)}void 0!==i&&i.catch(s)})})(Fe),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Be),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n})(Fe),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,8e3),i=URL.createObjectURL(n);let o=!1;try{await s.audioWorklet.addModule(i);const e=new t(s,"a",{numberOfOutputs:0}),n=s.createOscillator();e.port.onmessage=()=>o=!0,n.connect(e),n.start(0),await s.startRendering(),o||await new Promise(t=>setTimeout(t,5))}catch{}finally{URL.revokeObjectURL(i)}return o})(ys,Fe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Fe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);if(void 0===e.createConstantSource)return!0;return e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Fe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Fe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Fe),ue,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(Te),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}})(Be),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const n=e.createConstantSource(),s=e.createStereoPanner();return n.channelCount=1,n.offset.value=1,s.channelCount=1,n.start(),n.connect(s).connect(e.destination),e.startRendering().then(t=>1!==t.getChannelData(0)[0])})(Fe),le);function ti(t,e){if(!t)throw new Error(e)}function ei(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function ni(t){t.isOffline||"running"===t.state||ri('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let si=console;function ii(t){si=t}function oi(...t){si.log(...t)}function ri(...t){si.warn(...t)}function ai(t){return void 0===t}function ci(t){return!ai(t)}function hi(t){return"function"==typeof t}function ui(t){return"number"==typeof t}function li(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function di(t){return"boolean"==typeof t}function pi(t){return Array.isArray(t)}function fi(t){return"string"==typeof t}function mi(t){return fi(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const _i="object"==typeof self?self:null,gi=_i&&(_i.hasOwnProperty("AudioContext")||_i.hasOwnProperty("webkitAudioContext"));function yi(t,e,n,s){var i,o=arguments.length,r=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,s);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,n,r):i(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r}function vi(t,e,n,s){return new(n||(n=Promise))((function(i,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function a(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((s=s.apply(t,e||[])).next())}))}Object.create;Object.create;class xi{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function bi(t){return Xs(t)}function wi(t){return Ys(t)}function Ti(t){return Js(t)}function Mi(t){return Gs(t)}function Si(t){return t instanceof AudioBuffer}function Ai(t,e){return"value"===t||bi(e)||wi(e)||Si(e)}function ki(t,...e){if(!e.length)return t;const n=e.shift();if(li(t)&&li(n))for(const e in n)Ai(e,n[e])?t[e]=n[e]:li(n[e])?(t[e]||Object.assign(t,{[e]:{}}),ki(t[e],n[e])):Object.assign(t,{[e]:n[e]});return ki(t,...e)}function Ci(t,e,n=[],s){const i={},o=Array.from(e);if(li(o[0])&&s&&!Reflect.has(o[0],s)){Object.keys(o[0]).some(e=>Reflect.has(t,e))||(ki(i,{[s]:o[0]}),n.splice(n.indexOf(s),1),o.shift())}if(1===o.length&&li(o[0]))ki(i,o[0]);else for(let t=0;t<n.length;t++)ci(o[t])&&(i[n[t]]=o[t]);return ki(t,i)}function Di(t,e){return ai(t)?e:t}function Oi(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e]}),t}
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Pi{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||_i&&this.toString()===_i.TONE_DEBUG_CLASS)&&oi(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Pi.version=r;function Ei(t,e){return t>e+1e-6}function Ri(t,e){return Ei(t,e)||qi(t,e)}function Ii(t,e){return t+1e-6<e}function qi(t,e){return Math.abs(t-e)<1e-6}function Fi(t,e,n){return Math.max(Math.min(t,n),e)}class Vi extends Pi{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Ci(Vi.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(ti(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];ti(Ri(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(qi(this._timeline[e].time,t)){for(let n=e;n>=0&&qi(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Ri(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][e]<=t)return s-1;for(;n<i;){let s=Math.floor(n+(i-n)/2);const o=this._timeline[s],r=this._timeline[s+1];if(qi(o[e],t)){for(let n=s;n<this._timeline.length;n++){if(!qi(this._timeline[n][e],t))break;s=n}return s}if(Ii(o[e],t)&&Ei(r[e],t))return s;Ei(o[e],t)?i=s:n=s+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let s=this._search(t),i=this._search(e);return-1!==s&&-1!==i?(this._timeline[s].time!==t&&(s+=1),this._timeline[i].time===e&&(i-=1),this._iterate(n,s,i)):-1===s&&this._iterate(n,0,i),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&qi(this._timeline[n].time,t)){let s=n;for(let e=n;e>=0&&qi(this._timeline[e].time,t);e--)s=e;this._iterate(t=>{e(t)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Ni=[];function ji(t){Ni.push(t)}const Li=[];function zi(t){Li.push(t)}class Bi extends Pi{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(t=>{ai(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)}),this}once(t,e){const n=(...s)=>{e(...s),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach(n=>{if(ai(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(ai(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,s=n.length;t<s;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const n=Object.getOwnPropertyDescriptor(Bi.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class Wi extends Bi{constructor(){super(...arguments),this.isOffline=!1}}class Ui extends Wi{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Vi,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Ci(Ui.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new As(t)}({latencyHint:t.latencyHint}),this._ticker=new xi(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Ni.forEach(e=>e(t)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){ti(Mi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaStreamDestination(){ti(Mi(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){ti(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){ti(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){ti(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){ti(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return ti(ci(zs),"This node only works in a secure context (https or localhost)"),new zs(t,e,n)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(this.rawContext,t,e)}addAudioWorkletModule(t,e){return vi(this,void 0,void 0,(function*(){ti(ci(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return vi(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,fi(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&Mi(this._context)?this._context.resume():Promise.resolve()}close(){return vi(this,void 0,void 0,(function*(){var t;Mi(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Li.forEach(e=>e(t)))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=e,s.loop=!0,s.start(0),this._constants.set(t,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),s()},id:n,time:i+e})};return s(),n}}function Gi(t,e){pi(e)?e.forEach(e=>Gi(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Yi(t,e){pi(e)?e.forEach(e=>Yi(t,e)):Object.defineProperty(t,e,{writable:!0})}const Qi=()=>{};class Zi extends Pi{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Qi;const t=Ci(Zi.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Si(t.url)||t.url instanceof Zi?this.set(t.url):fi(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Qi,onload:Qi,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ji().sampleRate}set(t){return t instanceof Zi?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return vi(this,void 0,void 0,(function*(){const e=Zi.load(t).then(t=>{this.set(t),this.onload(this)});Zi.downloads.push(e);try{yield e}finally{const t=Zi.downloads.indexOf(e);Zi.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=pi(t)&&t[0].length>0,n=e?t.length:1,s=e?t[0].length:t.length,i=Ji(),o=i.createBuffer(n,s,i.sampleRate),r=e||1!==n?t:[t];for(let t=0;t<n;t++)o.copyToChannel(r[t],t);return this._buffer=o,this}toMono(t){if(ui(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map(t=>t/e),this.fromArray(t)}return this}toArray(t){if(ui(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),s=Math.floor(e*this.sampleRate);ti(n<s,"The start time must be less than the end time");const i=s-n,o=Ji().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)o.copyToChannel(this.getChannelData(t).subarray(n,s),t);return new Zi(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Zi).fromArray(t)}static fromUrl(t){return vi(this,void 0,void 0,(function*(){const e=new Zi;return yield e.load(t)}))}static load(t){return vi(this,void 0,void 0,(function*(){const e=t.match(/\[(.+\|?)+\]$/);if(e){const n=e[1].split("|");let s=n[0];for(const t of n)if(Zi.supportsType(t)){s=t;break}t=t.replace(e[0],s)}const n=""===Zi.baseUrl||Zi.baseUrl.endsWith("/")?Zi.baseUrl:Zi.baseUrl+"/",s=yield fetch(n+t);if(!s.ok)throw new Error("could not load url: "+t);const i=yield s.arrayBuffer();return yield Ji().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return vi(this,void 0,void 0,(function*(){for(yield Promise.resolve();Zi.downloads.length;)yield Zi.downloads[0]}))}}Zi.baseUrl="",Zi.downloads=[];class Xi extends Ui{constructor(){var t,e,n;super({clockSource:"offline",context:Ti(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Us(t,e,n)),lookAhead:0,updateInterval:Ti(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Ti(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return vi(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise(t=>setTimeout(t,1)))}}))}render(t=!0){return vi(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Zi(e)}))}close(){return Promise.resolve()}}const Hi=new class extends Wi{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return vi(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let $i=Hi;function Ji(){return $i===Hi&&gi&&Ki(new Ui),$i}function Ki(t){$i=Mi(t)?new Ui(t):Ti(t)?new Xi(t):t}function to(){return $i.resume()}if(_i&&!_i.TONE_SILENCE_LOGGING){let t="v";"dev"===r&&(t="");const e=` * Tone.js ${t}${r} * `;console.log("%c"+e,"background: #000; color: #fff")}function eo(t){return Math.pow(10,t/20)}function no(t){return Math.log(t)/Math.LN10*20}function so(t){return Math.pow(2,t/12)}let io=440;function oo(t){return Math.round(ro(t))}function ro(t){return 69+12*Math.log2(t/io)}function ao(t){return io*Math.pow(2,(t-69)/12)}class co extends Pi{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),s="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let s=0;return t&&"0"!==t&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof co&&this.fromType(this._val),ai(this._val))return this._noArg();if(fi(this._val)&&ai(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(li(this._val)){let t=0;for(const e in this._val)if(ci(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(ci(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return fi(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class ho extends co{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new ho(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),s=this.valueOf();return s+(Math.round(s/n)*n-s)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],s=new ho(this.context,e[0]).toSeconds();return e.forEach(e=>{const i=new ho(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(s-t)&&(n=e,s=i)}),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let s=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=s.toString();i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3)));return[n,e,s].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return oo(this.toFrequency())}_now(){return this.context.now()}}function uo(t,e){return new ho(Ji(),t,e)}class lo extends ho{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return io}static set A4(t){!function(t){io=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:lo.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=po[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:lo.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let s=1;return t&&"0"!==t&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(t){return new lo(this.context,this.valueOf()*so(t))}harmonize(t){return t.map(t=>this.transpose(t))}toMidi(){return oo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/lo.A4);let n=Math.round(12*e)+57;const s=Math.floor(n/12);s<0&&(n+=-12*s);return fo[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return ao(t)}static ftom(t){return oo(t)}}const po={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},fo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function mo(t,e){return new lo(Ji(),t,e)}class _o extends ho{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function go(t,e){return new _o(Ji(),t,e)}class yo extends Pi{constructor(){super();const t=Ci(yo.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ji()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new ho(this.context,t).toSeconds()}toFrequency(t){return new lo(this.context,t).toFrequency()}toTicks(t){return new _o(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(n=>{ai(t[n])&&delete e[n]}),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const n=this[e];ci(n)&&ci(n.value)&&ci(n.setValueAtTime)?t[e]=n.value:n instanceof yo?t[e]=n._getPartialProperties(t[e]):pi(n)||ui(n)||fi(n)||di(n)?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&ci(this[e])&&(this[e]&&ci(this[e].value)&&ci(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof yo?this[e].set(t[e]):this[e]=t[e])}),this}}class vo extends Vi{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return ei(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class xo extends yo{constructor(){super(Ci(xo.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Ci(xo.getDefaults(),arguments,["param","units","convert"]);for(ti(ci(t.param)&&(bi(t.param)||t.param instanceof xo),"param must be an AudioParam");!bi(t.param);)t.param=t.param._param;this._swappable=!!ci(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Vi(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,ci(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(yo.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return ci(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return ci(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return ci(this.maxValue)&&ci(this.minValue)&&ei(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?eo(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?no(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),s=this._fromType(t);return ti(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),s=this._events.get(e);let i=this._initialValue;if(null===s)i=this._initialValue;else if("setTargetAtTime"!==s.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=s.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=s.value;if("setTargetAtTime"===s.type){const e=this._events.getBefore(s.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(s.time,t,n.time,n.value,e):this._exponentialInterpolate(s.time,t,n.time,n.value,e)}else i=s.value;else{const t=this._events.getBefore(s.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===s.type&&(i=this._exponentialApproach(s.time,n,s.value,s.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),s=this.toSeconds(e);return ti(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Math.max(this._minOutput,n),this._assertRange(n);const s=this.toSeconds(e);return ti(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,s),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const s=this._fromType(t);ti(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(s),ti(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",t,i,n),this._param.setTargetAtTime(s,i,n),this}setValueCurveAtTime(t,e,n,s=1){n=this.toSeconds(n),e=this.toSeconds(e);const i=this._fromType(t[0])*s;this.setValueAtTime(this._toType(i),e);const o=n/(t.length-1);for(let n=1;n<t.length;n++){const i=this._fromType(t[n])*s;this.linearRampToValueAtTime(this._toType(i),e+n*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return ti(isFinite(e),"Invalid argument to cancelScheduledValues: "+JSON.stringify(t)),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));ti(isFinite(e),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(t)),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const s=this._events.get(e),i=this._events.getAfter(e);return s&&qi(s.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const s=this._events.getAfter(n.time),i=s?s.time:e+2,o=(i-e)/10;for(let n=e;n<i;n+=o)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)}),this}setParam(t){ti(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,s,i){return n+(e-n)*Math.exp(-(i-t)/s)}_linearInterpolate(t,e,n,s,i){return e+(i-t)/(n-t)*(s-e)}_exponentialInterpolate(t,e,n,s,i){return e*Math.pow(s/e,(i-t)/(n-t))}}class bo extends yo{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ci(this.input)?bi(this.input)||this.input instanceof xo?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ci(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return ci(t)&&(t instanceof bo||wi(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();ti(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return To(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ri("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Mo(this,t,e,n),this}chain(...t){return wo(this,...t),this}fan(...t){return t.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),ci(this.input)&&(this.input instanceof bo?this.input.dispose():wi(this.input)&&this.input.disconnect()),ci(this.output)&&(this.output instanceof bo?this.output.dispose():wi(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function wo(...t){const e=t.shift();t.reduce((t,e)=>(t instanceof bo?t.connect(e):wi(t)&&To(t,e),e),e)}function To(t,e,n=0,s=0){for(ti(ci(t),"Cannot connect from undefined node"),ti(ci(e),"Cannot connect to undefined node"),(e instanceof bo||wi(e))&&ti(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ti(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof bo||e instanceof xo;)ci(e.input)&&(e=e.input);for(;t instanceof bo;)ci(t.output)&&(t=t.output);bi(e)?t.connect(e,n):t.connect(e,n,s)}function Mo(t,e,n=0,s=0){if(ci(e))for(;e instanceof bo;)e=e.input;for(;!wi(t);)ci(t.output)&&(t=t.output);bi(e)?t.disconnect(e,n):wi(e)?t.disconnect(e,n,s):t.disconnect()}class So extends bo{constructor(){super(Ci(So.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Ci(So.getDefaults(),arguments,["gain","units"]);this.gain=new xo({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Gi(this,"gain")}static getDefaults(){return Object.assign(bo.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ao extends bo{constructor(t){super(t),this.onended=Qi,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new So({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(bo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Qi})}_startGain(t,e=1){ti(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){ti(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Qi&&(this.onended(this),this.onended=Qi,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ti(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class ko extends Ao{constructor(){super(Ci(ko.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Ci(ko.getDefaults(),arguments,["offset"]);To(this._source,this._gainNode),this.offset=new xo({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Ao.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Co extends bo{constructor(){super(Ci(Co.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Ci(Co.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ko({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(bo.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Do(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,s){return this._param.setValueCurveAtTime(t,e,n,s),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Do(t,e,n,s){(e instanceof xo||bi(e)||e instanceof Co&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Co&&(e.overridden=!0)),To(t,e,n,s)}class Oo extends xo{constructor(){super(Ci(Oo.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Vi(1/0),this._multiplier=1;const t=Ci(Oo.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(xo.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const s=this._fromType(t),i=this._events.get(e),o=Math.round(Math.max(1/n,1));for(let t=0;t<=o;t++){const o=n*t+e,r=this._exponentialApproach(i.time,i.value,s,n,o);this.linearRampToValueAtTime(this._toType(r),o)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),s=this._events.get(e),i=Math.round(Math.max(10*(e-s.time),1)),o=(e-s.time)/i;for(let t=0;t<=i;t++){const i=o*t+s.time,r=this._exponentialInterpolate(s.time,s.value,e,n,i);this.linearRampToValueAtTime(this._toType(r),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ai(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let s=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(s=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+s)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(e);return this.getTimeOfTick(s+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const s=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-e.time),o=Math.sqrt(Math.pow(s,2)-2*i*(e.ticks-t)),r=(-s+o)/i,a=(-s-o)/i;return(r>0?r:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),s=this.toSeconds(t),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Po extends Co{constructor(){super(Ci(Po.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Ci(Po.getDefaults(),arguments,["value"]);this.input=this._param=new Oo({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Co.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Eo extends yo{constructor(){super(Ci(Eo.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new vo,this._tickOffset=new Vi;const t=Ci(Eo.getDefaults(),arguments,["frequency"]);this.frequency=new Po({context:this.context,units:t.units,value:t.frequency}),Gi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},yo.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ci(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);let i=n,o=0;return this._state.forEachBetween(n.time,e+this.sampleTime,t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(o=n.ticks,e=n.time),"started"===i.state&&"started"!==t.state&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t}),this._state.remove(s),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let s=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(i=n.seconds,e=n.time),"started"===s.state&&"started"!==t.state&&(i+=t.time-e),s=t}),this._state.remove(n),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),s=this._state.get(e),i=Math.max(n.time,s.time),o=this.frequency.getTicksAtTime(i)+t-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,n){let s=this._state.get(t);this._state.forEachBetween(t,e,e=>{s&&"started"===s.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(s.time,t),e.time-this.sampleTime,n),s=e});let i=null;if(s&&"started"===s.state){const o=Math.max(s.time,t),r=this.frequency.getTicksAtTime(o),a=r-this.frequency.getTicksAtTime(s.time);let c=Math.ceil(a)-a;c=qi(c,1)?0:c;let h=this.frequency.getTimeOfTick(r+c);for(;h<e;){try{n(h,Math.round(this.getTicksAtTime(h)))}catch(t){i=t;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Ro extends yo{constructor(){super(Ci(Ro.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Qi,this._lastUpdate=0,this._state=new vo("stopped"),this._boundLoop=this._loop.bind(this);const t=Ci(Ro.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Eo({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Gi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(yo.getDefaults(),{callback:Qi,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ni(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Bi.mixin(Ro);class Io extends bo{constructor(){super(Ci(Io.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=Ci(Io.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new xo({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),Gi(this,"delayTime")}static getDefaults(){return Object.assign(bo.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function qo(t,e,n=2,s=Ji().sampleRate){return vi(this,void 0,void 0,(function*(){const i=Ji(),o=new Xi(n,e,s);Ki(o),yield t(o);const r=o.render();Ki(i);const a=yield r;return new Zi(a)}))}class Fo extends Pi{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Ci(Fo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Qi,onload:Qi,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return ti(this.has(t),"ToneAudioBuffers has no buffer named: "+t),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,n=Qi,s=Qi){return fi(e)?this._buffers.set(t.toString(),new Zi(this.baseUrl+e,n,s)):this._buffers.set(t.toString(),new Zi(e,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class Vo extends lo{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return oo(super._frequencyToUnits(t))}_ticksToUnits(t){return oo(super._ticksToUnits(t))}_beatsToUnits(t){return oo(super._beatsToUnits(t))}_secondsToUnits(t){return oo(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return ao(this.toMidi())}transpose(t){return new Vo(this.context,this.toMidi()+t)}}function No(t,e){return new Vo(Ji(),t,e)}class jo extends _o{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function Lo(t,e){return new jo(Ji(),t,e)}class zo extends yo{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Vi,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ji(t=>{t.draw=new zo({context:t})}),zi(t=>{t.draw.dispose()});class Bo extends Pi{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){ti(ci(t.time),"Events must have a time property"),ti(ci(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Wo(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),s=t.right;s&&(t.right=s.left,s.left=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),s=t.left;s&&(t.left=s.right,s.right=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event)})}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach(t=>{t.event&&e(t.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class Wo{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Uo extends bo{constructor(){super(Ci(Uo.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Ci(Uo.getDefaults(),arguments,["volume"]);this.input=this.output=new So({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Gi(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Go extends bo{constructor(){super(Ci(Go.getDefaults(),arguments)),this.name="Destination",this.input=new Uo({context:this.context}),this.output=new So({context:this.context}),this.volume=this.input.volume;const t=Ci(Go.getDefaults(),arguments);wo(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),wo(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ji(t=>{t.destination=new Go({context:t})}),zi(t=>{t.destination.dispose()});class Yo extends Pi{constructor(t){super(),this.name="TimelineValue",this._timeline=new Vi({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Qo{constructor(t,e){this.id=Qo._eventId++;const n=Object.assign(Qo.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Qi,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Qo._eventId=0;class Zo extends Qo{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Zo.getDefaults(),e);this.duration=new jo(t.context,n.duration).valueOf(),this._interval=new jo(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Qo.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new jo(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Xo extends yo{constructor(){super(Ci(Xo.getDefaults(),arguments)),this.name="Transport",this._loop=new Yo(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Vi,this._repeatedEvents=new Bo,this._syncedSignals=[],this._swingAmount=0;const t=Ci(Xo.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Ro({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Gi(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(yo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),s=Math.sin(n*Math.PI)*this._swingAmount;t+=new jo(this.context,2*this._swingTicks/3).toSeconds()*s}this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,e=>e.invoke(t))}schedule(t,e){const n=new Qo(this,{callback:t,time:new _o(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,s=1/0){const i=new Zo(this,{callback:t,duration:new ho(this.context,s).toTicks(),interval:new ho(this.context,e).toTicks(),time:new _o(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const n=new Qo(this,{callback:t,once:!0,time:new _o(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new jo(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return ci(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){pi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new ho(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new ho(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new jo(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new jo(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),s=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",s),this._clock.setTicksAtTime(t,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const s=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/s}else e=0}const n=new So(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Yi(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Bi.mixin(Xo),ji(t=>{t.transport=new Xo({context:t})}),zi(t=>{t.transport.dispose()});class Ho extends bo{constructor(t){super(t),this.input=void 0,this._state=new vo("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Qi,this._syncedStop=Qi,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Uo({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Gi(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,onstop:Qi,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let s=ai(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(s=this._clampToCurrentTime(s),this._synced||"started"!==this._state.getValueAtTime(s))if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const t=this._state.get(s);t&&(t.offset=this.toSeconds(Di(e,0)),t.duration=n?this.toSeconds(n):void 0);const i=this.context.transport.schedule(t=>{this._start(t,e,n)},s);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else ni(this.context),this._start(s,e,n);else ti(Ei(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,e,n);return this}stop(t){let e=ai(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||ci(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const s=e-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-s),this._start(t,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Qi,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class $o extends Ao{constructor(){super(Ci($o.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Ci($o.getDefaults(),arguments,["url","onload"]);To(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new xo({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Zi(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ao.getDefaults(),{url:new Zi,loop:!1,loopEnd:0,loopStart:0,onload:Qi,onerror:Qi,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,s=1){ti(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,s),e=this.loop?Di(e,this.loopStart):Di(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;Ri(o,t)&&(o=(o-e)%n+e),qi(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Ii(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),ci(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Jo extends Ho{constructor(){super(Ci(Jo.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=Ci(Jo.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(ti(t in tr,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=tr[this._type];this._source=new $o({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Ko={brown:null,pink:null,white:null},tr={get brown(){if(!Ko.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;let s=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;n[t]=(s+.02*e)/1.02,s=n[t],n[t]*=3.5}}Ko.brown=(new Zi).fromArray(t)}return Ko.brown},get pink(){if(!Ko.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);let s,i,o,r,a,c,h;t[e]=n,s=i=o=r=a=c=h=0;for(let t=0;t<220500;t++){const e=2*Math.random()-1;s=.99886*s+.0555179*e,i=.99332*i+.0750759*e,o=.969*o+.153852*e,r=.8665*r+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,n[t]=s+i+o+r+a+c+h+.5362*e,n[t]*=.11,h=.115926*e}}Ko.pink=(new Zi).fromArray(t)}return Ko.pink},get white(){if(!Ko.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(220500);t[e]=n;for(let t=0;t<220500;t++)n[t]=2*Math.random()-1}Ko.white=(new Zi).fromArray(t)}return Ko.white}};class er extends bo{constructor(){super(Ci(er.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=Ci(er.getDefaults(),arguments,["volume"]);this._volume=this.output=new Uo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Gi(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,volume:0})}open(t){return vi(this,void 0,void 0,(function*(){ti(er.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield er.enumerateDevices();ui(t)?this._device=e[t]:(this._device=e.find(e=>e.label===t||e.deviceId===t),!this._device&&e.length>0&&(this._device=e[0]),ti(ci(this._device),"No matching device "+t));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const s=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=s;const t=this.context.createMediaStreamSource(s);To(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(t=>{t.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return vi(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>"audioinput"===t.kind)}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return ci(navigator.mediaDevices)&&ci(navigator.mediaDevices.getUserMedia)}}function nr(t,e){return vi(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,s=new Xi(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:s})).toDestination().start(0);return(yield s.render()).getChannelData(0)}))}class sr extends Ao{constructor(){super(Ci(sr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Ci(sr.getDefaults(),arguments,["frequency","type"]);To(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new xo({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new xo({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Gi(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ao.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ir extends Ho{constructor(){super(Ci(ir.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Ci(ir.getDefaults(),arguments,["frequency","type"]);this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency}),Gi(this,"frequency"),this.detune=new Co({context:this.context,units:"cents",value:t.detune}),Gi(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new sr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return ir._periodicWaveCache.find(t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every((t,e)=>n[e]===t));var e,n})}{const t=ir._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(ci(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),s=this.context.createPeriodicWave(e,n);this._wave=s,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),ir._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),ir._periodicWaveCache.length>100&&ir._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){ei(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach((t,n)=>e[n]=t),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const s=new Float32Array(n),i=new Float32Array(n);let o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,n=o,0===this._partials.length)return[s,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(o=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],o=Math.max(o,2),n=o):this._partialCount=0,this._partials=[]}for(let r=1;r<n;++r){const n=2/(r*Math.PI);let a;switch(t){case"sine":a=r<=o?1:0,this._partials[r-1]=a;break;case"square":a=1&r?2*n:0,this._partials[r-1]=a;break;case"sawtooth":a=n*(1&r?1:-1),this._partials[r-1]=a;break;case"triangle":a=1&r?n*n*2*(r-1>>1&1?-1:1):0,this._partials[r-1]=a;break;case"custom":a=this._partials[r-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(s[r]=-a*Math.sin(e*r),i[r]=a*Math.cos(e*r)):(s[r]=0,i[r]=0)}return[s,i]}_inverseFFT(t,e,n){let s=0;const i=t.length;for(let o=0;o<i;o++)s+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return s}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const s=2*Math.PI;for(let i=0;i<32;i++)n=Math.max(this._inverseFFT(t,e,i/32*s),n);return Fi(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ir._periodicWaveCache=[];class or extends bo{constructor(){super(Object.assign(Ci(or.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Do(this,t,e,n),this}}class rr extends or{constructor(){super(Object.assign(Ci(rr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Ci(rr.getDefaults(),arguments,["mapping","length"]);pi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):hi(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Co.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let s=0,i=e;s<i;s++){const e=s/(i-1)*2-1;n[s]=t(e,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){ti(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ar extends or{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new rr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class cr extends Co{constructor(){super(Object.assign(Ci(cr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Ci(cr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new So({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Co.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class hr extends Ho{constructor(){super(Ci(hr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new ar({context:this.context}),this._modulationNode=new So({context:this.context});const t=Ci(hr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ir({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Gi(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ir.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ur extends Ho{constructor(){super(Ci(ur.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new So({context:this.context,gain:0});const t=Ci(ur.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ir({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ir({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new cr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Gi(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ir.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class lr extends Ho{constructor(){super(Ci(lr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new So({context:this.context,gain:0}),this._thresh=new rr({context:this.context,mapping:t=>t<=0?-1:1});const t=Ci(lr.getDefaults(),arguments,["frequency","width"]);this.width=new Co({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Gi(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class dr extends Ho{constructor(){super(Ci(dr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Ci(dr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Co({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Gi(this,["frequency","detune"])}static getDefaults(){return Object.assign(ir.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach((t,s)=>t.detune.value=e+n*s)}}get count(){return this._oscillators.length}set count(t){if(ei(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const n=new ir({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Qi});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class pr extends Ho{constructor(){super(Ci(pr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new cr({context:this.context,value:2});const t=Ci(pr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new lr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ir({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Gi(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ho.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const fr={am:hr,fat:dr,fm:ur,oscillator:ir,pulse:lr,pwm:pr};class mr extends Ho{constructor(){super(Ci(mr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Ci(mr.getDefaults(),arguments,["frequency","type"]);this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Co({context:this.context,units:"cents",value:t.detune}),Gi(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ir.getDefaults(),ur.getDefaults(),hr.getDefaults(),dr.getDefaults(),lr.getDefaults(),pr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=fr[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout(()=>t.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof fr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&ui(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&ui(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&fi(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return vi(this,void 0,void 0,(function*(){return nr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class _r extends Co{constructor(){super(Object.assign(Ci(_r.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new So({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,wo(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Co.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class gr extends or{constructor(){super(Object.assign(Ci(gr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=Ci(gr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new cr({context:this.context,value:t.max-t.min}),this._add=this.output=new _r({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(or.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class yr extends or{constructor(){super(Object.assign(Ci(yr.getDefaults(),arguments))),this.name="Zero",this._gain=new So({context:this.context}),this.output=this._gain,this.input=void 0,To(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Mo(this.context.getConstant(0),this._gain),this}}class vr extends bo{constructor(){super(Ci(vr.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=xo.prototype._fromType,this._toType=xo.prototype._toType,this._is=xo.prototype._is,this._clampValue=xo.prototype._clampValue;const t=Ci(vr.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new ir({context:this.context,frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new So({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Co({context:this.context,units:"audioRange",value:0}),this._zeros=new yr({context:this.context}),this._a2g=new ar({context:this.context}),this._scaler=this.output=new gr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._a2g,this._amplitudeGain,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Gi(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(bo.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof xo||t instanceof Co)&&(this.convert=t.convert,this.units=t.units),Do(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function xr(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ei(s,t,e),n.set(this,s)}})}}function br(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ei(this.toSeconds(s),t,e),n.set(this,s)}})}}class wr extends Ho{constructor(){super(Ci(wr.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Ci(wr.getDefaults(),arguments,["url","onload"]);this._buffer=new Zi({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Qi,onerror:Qi,playbackRate:1,reverse:!1})}load(t){return vi(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=Qi){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Di(e,this._loopStart):Di(e,0);let s=this.toSeconds(e);this._synced&&(s*=this._playbackRate);const i=n;n=Di(n,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(n);o/=this._playbackRate,t=this.toSeconds(t);const r=new $o({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(r),this._loop&&ai(i)?r.start(t,s):r.start(t,s,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}yi([br(0)],wr.prototype,"fadeIn",void 0),yi([br(0)],wr.prototype,"fadeOut",void 0);class Tr extends bo{constructor(){super(Ci(Tr.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=Ci(Tr.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Uo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Gi(this,"volume"),this._buffers=new Fo({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ho.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Qi,onerror:Qi,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach(e=>{e.fadeIn=t})}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach(e=>{e.fadeOut=t})}get state(){return Array.from(this._players).some(([t,e])=>"started"===e.state)?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(ti(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new wr({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return ti(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach(e=>e.stop(t)),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach(t=>t.dispose()),this._buffers.dispose(),this}}class Mr extends Ho{constructor(){super(Ci(Mr.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=Ci(Mr.getDefaults(),arguments,["url","onload"]);this.buffer=new Zi({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Ro({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Ho.getDefaults(),{onload:Qi,onerror:Qi,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=Di(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const s=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/s),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach(e=>{e.fadeOut=0,e.stop(t)}),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const s=n<this._overlap?0:this._overlap,i=new $o({context:this.context,url:this.buffer,fadeIn:s,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:so(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){ei(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&ei(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);ei(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(t=>t.dispose()),this}}class Sr extends or{constructor(){super(...arguments),this.name="Abs",this._abs=new rr({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class Ar extends or{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new rr({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class kr extends or{constructor(){super(...arguments),this.name="Negate",this._multiply=new cr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Cr extends Co{constructor(){super(Object.assign(Ci(Cr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new So({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new kr({context:this.context}),this.subtrahend=this._param,wo(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Co.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class Dr extends or{constructor(){super(Object.assign(Ci(Dr.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new rr({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new cr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Or extends Co{constructor(){super(Object.assign(Ci(Or.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=Ci(Or.getDefaults(),arguments,["value"]);this._subtract=this.input=new Cr({context:this.context,value:t.value}),this._gtz=this.output=new Dr({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,Gi(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Co.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Pr extends or{constructor(){super(Object.assign(Ci(Pr.getDefaults(),arguments,["value"]))),this.name="Pow";const t=Ci(Pr.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new rr({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(or.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Er extends gr{constructor(){super(Object.assign(Ci(Er.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=Ci(Er.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Pr({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(gr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class Rr extends Co{constructor(){super(Ci(Co.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=Ci(Co.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new ko({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new _o(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const n=new _o(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){const n=new _o(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){const n=new _o(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){const s=new _o(this.context,e).toSeconds();return super.setTargetAtTime(t,s,n),this}cancelScheduledValues(t){const e=new _o(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,s){const i=new _o(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,i,n,s),this}cancelAndHoldAtTime(t){const e=new _o(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new _o(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){const s=new _o(this.context,n).toSeconds();return super.exponentialRampTo(t,e,s),this}linearRampTo(t,e,n){const s=new _o(this.context,n).toSeconds();return super.linearRampTo(t,e,s),this}targetRampTo(t,e,n){const s=new _o(this.context,n).toSeconds();return super.targetRampTo(t,e,s),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class Ir extends bo{constructor(){super(Ci(Ir.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Co({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Ci(Ir.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(bo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(fi(t))return t;{let n;for(n in qr)if(qr[n][e]===t)return n;return t}}_setCurve(t,e,n){if(fi(n)&&Reflect.has(qr,n)){const s=qr[n];li(s)?"_decayCurve"!==t&&(this[t]=s[e]):this[t]=s}else{if(!pi(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){ti(["linear","exponential"].some(e=>e===t),"Invalid envelope curve: "+t),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){n=(1-i)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let s=this._attackCurve;for(let t=1;t<s.length;t++)if(s[t-1]<=i&&i<=s[t]){s=this._attackCurve.slice(t),s[0]=i;break}this._sig.setValueCurveAtTime(s,t,n,e)}if(s&&this.sustain<1){const i=e*this.sustain,o=t+n;this.log("decay",o),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,s+o):this._sig.exponentialApproachValueAtTime(i,o,s)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(ti(pi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Do(this,t,e,n),this}asArray(t=1024){return vi(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Xi(1,e,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),o=.1*i,r=i+o,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/r,decay:e*this.toSeconds(this.decay)/r,release:e*this.toSeconds(this.release)/r,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(s+o)/r,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}yi([br(0)],Ir.prototype,"attack",void 0),yi([br(0)],Ir.prototype,"decay",void 0),yi([xr(0,1)],Ir.prototype,"sustain",void 0),yi([br(0)],Ir.prototype,"release",void 0);const qr=(()=>{let t,e;const n=[];for(t=0;t<128;t++)n[t]=Math.sin(t/127*(Math.PI/2));const s=[];for(t=0;t<127;t++){e=t/127;const n=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;s[t]=n/10+.83*e}s[127]=1;const i=[];for(t=0;t<128;t++)i[t]=Math.ceil(t/127*5)/5;const o=[];for(t=0;t<128;t++)e=t/127,o[t]=.5*(1-Math.cos(Math.PI*e));const r=[];for(t=0;t<128;t++){e=t/127;const n=4*Math.pow(e,3)+.2,s=Math.cos(n*Math.PI*2*e);r[t]=Math.abs(s*(1-e))}function a(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:a(r),Out:r},cosine:{In:n,Out:(c=n,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:s,Out:a(s)},sine:{In:o,Out:a(o)},step:{In:i,Out:a(i)}};var c})();class Fr extends bo{constructor(){super(Ci(Fr.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Ci(Fr.getDefaults(),arguments);this._volume=this.output=new Uo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Gi(this,"volume")}static getDefaults(){return Object.assign(bo.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const s=t[e],i=this.context.transport.schedule(s=>{t[e]=s,n.apply(this,t)},s);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,s){const i=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,i,s),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Vr extends Fr{constructor(){super(Ci(Vr.getDefaults(),arguments));const t=Ci(Vr.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Fr.getDefaults(),{detune:0,onsilence:Qi,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const s=this.toSeconds(e);return this._triggerEnvelopeAttack(s,n),this.setNote(t,s),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),s=t instanceof lo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,t,n)}else this.frequency.setValueAtTime(s,n);return this}}yi([br(0)],Vr.prototype,"portamento",void 0);class Nr extends Ir{constructor(){super(Ci(Nr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new So({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class jr extends Vr{constructor(){super(Ci(jr.getDefaults(),arguments)),this.name="Synth";const t=Ci(jr.getDefaults(),arguments);this.oscillator=new mr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Nr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Gi(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Vr.getDefaults(),{envelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Oi(mr.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Lr extends Vr{constructor(){super(Ci(Lr.getDefaults(),arguments)),this.name="ModulationSynth";const t=Ci(Lr.getDefaults(),arguments);this._carrier=new jr({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new jr({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Co({context:this.context,units:"frequency"}),this.detune=new Co({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new cr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new So({context:this.context,gain:0}),Gi(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Vr.getDefaults(),{harmonicity:3,oscillator:Object.assign(Oi(mr.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Oi(mr.getDefaults(),[...Object.keys(Ho.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class zr extends Lr{constructor(){super(Ci(zr.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new ar({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Br extends bo{constructor(){super(Ci(Br.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=Ci(Br.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new xo({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new xo({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new xo({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new xo({context:this.context,units:"gain",value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){ti(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const s=19980*Math.pow(n/t,2)+20;e[n]=s}const n=new Float32Array(t),s=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,n,s),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Wr extends bo{constructor(){super(Ci(Wr.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new So({context:this.context}),this.output=new So({context:this.context}),this._filters=[];const t=Ci(Wr.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Co({context:this.context,units:"positive",value:t.Q}),this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Co({context:this.context,units:"cents",value:t.detune}),this.gain=new Co({context:this.context,units:"decibels",value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,Gi(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){ti(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: "+t),this._type=t,this._filters.forEach(e=>e.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=ui(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let s=n.indexOf(e);ti(-1!==s,"rolloff can only be "+n.join(", ")),s+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(t=>t.disconnect()),this._filters=new Array(s);for(let t=0;t<s;t++){const e=new Br({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,wo(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Br({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((t,e)=>n[e]*=t)}),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),Yi(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Ur extends Ir{constructor(){super(Ci(Ur.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=Ci(Ur.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Pr({context:this.context,value:t.exponent}),this._scale=this.output=new gr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Ir.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);ei(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){ei(t,0),this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class Gr extends Vr{constructor(){super(Ci(Gr.getDefaults(),arguments)),this.name="MonoSynth";const t=Ci(Gr.getDefaults(),arguments);this.oscillator=new mr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new Ur(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Nr(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Gi(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Vr.getDefaults(),{envelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Oi(Wr.getDefaults(),Object.keys(bo.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Oi(Ur.getDefaults(),Object.keys(bo.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Oi(mr.getDefaults(),Object.keys(Ho.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Yr extends Vr{constructor(){super(Ci(Yr.getDefaults(),arguments)),this.name="DuoSynth";const t=Ci(Yr.getDefaults(),arguments);this.voice0=new Gr(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Gr(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new cr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new vr({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new So({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Co({context:this.context,units:"frequency",value:440}),this.detune=new Co({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),Gi(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return ki(Vr.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:ki(Oi(Gr.getDefaults(),Object.keys(Vr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:ki(Oi(Gr.getDefaults(),Object.keys(Vr.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class Qr extends Lr{constructor(){super(Ci(Qr.getDefaults(),arguments)),this.name="FMSynth";const t=Ci(Qr.getDefaults(),arguments);this.modulationIndex=new cr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Lr.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Zr=[1,1.483,1.932,2.546,2.63,3.897];class Xr extends Vr{constructor(){super(Ci(Xr.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=Ci(Xr.getDefaults(),arguments);this.detune=new Co({context:this.context,units:"cents",value:t.detune}),this.frequency=new Co({context:this.context,units:"frequency"}),this._amplitude=new So({context:this.context,gain:0}).connect(this.output),this._highpass=new Wr({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Zr.length;e++){const n=new ur({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):Qi,type:"square"});n.connect(this._highpass),this._oscillators[e]=n;const s=new cr({context:this.context,value:Zr[e]});this._freqMultipliers[e]=s,this.frequency.chain(s,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new gr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new Ir({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return ki(Vr.getDefaults(),{envelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach(e=>e.start(t)),0===this.envelope.sustain&&this._oscillators.forEach(e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach(e=>e.stop(t+this.toSeconds(this.envelope.release))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach(e=>e.modulationIndex.value=t)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach(e=>e.harmonicity.value=t)}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach(t=>t.dispose()),this._freqMultipliers.forEach(t=>t.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class Hr extends jr{constructor(){super(Ci(Hr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Ci(Hr.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Gi(this,["oscillator","envelope"])}static getDefaults(){return ki(Vr.getDefaults(),jr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),s=this.toFrequency(t instanceof lo?t.toFrequency():t),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}yi([xr(0)],Hr.prototype,"octaves",void 0),yi([br(0)],Hr.prototype,"pitchDecay",void 0);class $r extends Fr{constructor(){super(Ci($r.getDefaults(),arguments)),this.name="NoiseSynth";const t=Ci($r.getDefaults(),arguments);this.noise=new Jo(Object.assign({context:this.context},t.noise)),this.envelope=new Nr(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Fr.getDefaults(),{envelope:Object.assign(Oi(Ir.getDefaults(),Object.keys(bo.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Oi(Jo.getDefaults(),Object.keys(Ho.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Jr=new Set;function Kr(t){Jr.add(t)}function ta(t,e){const n=`registerProcessor("${t}", ${e})`;Jr.add(n)}class ea extends bo{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Qi;const e=URL.createObjectURL(new Blob([Array.from(Jr).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then(()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))})}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Kr('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Kr("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Kr("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");ta("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class na extends ea{constructor(){super(Ci(na.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=Ci(na.getDefaults(),arguments,["delayTime","resonance"]);this.input=new So({context:this.context}),this.output=new So({context:this.context}),this.delayTime=new xo({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new xo({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),Gi(this,["resonance","delayTime"])}_audioWorkletName(){return"feedback-comb-filter"}static getDefaults(){return Object.assign(bo.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){wo(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class sa extends bo{constructor(){super(Ci(sa.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=Ci(sa.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new So({context:this.context}),this.output=new So({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(bo.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const s=19980*Math.pow(n/t,2)+20;e[n]=s}const n=new Float32Array(t),s=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,s),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class ia extends bo{constructor(){super(Ci(ia.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=Ci(ia.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new na({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new sa({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(bo.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class oa extends Fr{constructor(){super(Ci(oa.getDefaults(),arguments)),this.name="PluckSynth";const t=Ci(oa.getDefaults(),arguments);this._noise=new Jo({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new ia({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return ki(Fr.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const n=this.toFrequency(t);e=this.toSeconds(e);const s=1/n;return this._lfcf.delayTime.setValueAtTime(s,e),this._noise.start(e),this._noise.stop(e+s*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class ra extends Fr{constructor(){super(Ci(ra.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=Ci(ra.getDefaults(),arguments,["voice","options"]);ti(!ui(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Fr.getDefaults(),{maxPolyphony:32,options:{},voice:jr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(e=>e.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}ri("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach(t=>{const s=new Vo(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,n),this._activeVoices.push({midi:s,voice:i,released:!1}),this.log("triggerAttack",t,e))})}_triggerRelease(t,e){t.forEach(t=>{const n=new Vo(this.context,t).toMidi(),s=this._activeVoices.find(({midi:t,released:e})=>t===n&&!e);s&&(s.voice.triggerRelease(e),s.released=!0,this.log("triggerRelease",t,e))})}_scheduleEvent(t,e,n,s){ti(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,s):this._triggerRelease(e,n):this.context.setTimeout(()=>{this._scheduleEvent(t,e,n,s)},n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("attack",t,s,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,s){const i=this.toSeconds(n);if(this.triggerAttack(t,i,s),pi(e)){ti(pi(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const s=e[Math.min(n,e.length-1)],o=this.toSeconds(s);ti(o>0,"The duration must be greater than 0"),this.triggerRelease(t[n],i+o)}}else{const n=this.toSeconds(e);ti(n>0,"The duration must be greater than 0"),this.triggerRelease(t,i+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Oi(t,["onsilence","context"]);return this.options=ki(this.options,e),this._voices.forEach(t=>t.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:t})=>{t.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class aa extends Fr{constructor(){super(Ci(aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Ci(aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(n=>{const s=parseInt(n,10);if(ti(mi(n)||ui(s)&&isFinite(s),"url key is neither a note or midi pitch: "+n),mi(n)){const s=new lo(this.context,n).toMidi();e[s]=t.urls[n]}else ui(s)&&isFinite(s)&&(e[s]=t.urls[s])}),this._buffers=new Fo({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Fr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Qi,onerror:Qi,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: "+t)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(t=>{const s=ro(new lo(this.context,t).toFrequency()),i=Math.round(s),o=s-i,r=this._findClosest(i),a=i-r,c=this._buffers.get(a),h=so(r+o),u=new $o({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);u.start(e,0,c.duration/h,n),pi(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(u);-1!==e&&t.splice(e,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{const n=new lo(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach(t=>{t.stop(e)}),this._activeSources.set(n,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;){t.shift().stop(e)}}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,s=1){const i=this.toSeconds(n);return this.triggerAttack(t,i,s),pi(e)?(ti(pi(t),"notes must be an array when duration is array"),t.forEach((t,n)=>{const s=e[Math.min(n,e.length-1)];this.triggerRelease(t,i+this.toSeconds(s))})):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,n){if(ti(mi(t)||isFinite(t),"note must be a pitch or midi: "+t),mi(t)){const s=new lo(this.context,t).toMidi();this._buffers.add(s,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}yi([br(0)],aa.prototype,"attack",void 0),yi([br(0)],aa.prototype,"release",void 0);class ca extends yo{constructor(){super(Ci(ca.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new vo("stopped"),this._startOffset=0;const t=Ci(ca.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(yo.getDefaults(),{callback:Qi,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||ui(this._loop)&&this._loop>1){e=1/0,ui(this._loop)&&(e=this._loop*this._getLoopDuration());const s=this._state.getAfter(n);null!==s&&(e=Math.min(e,s.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new jo(this.context,e));const i=new jo(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new jo(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new jo(this.context,n))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=Di(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,t=>{this.context.transport.clear(t.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;di(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new jo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new jo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class ha extends yo{constructor(){super(Ci(ha.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=Ci(ha.getDefaults(),arguments,["callback","interval"]);this._event=new ca({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(yo.getDefaults(),{interval:"4n",callback:Qi,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class ua extends ca{constructor(){super(Ci(ua.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new vo("stopped"),this._events=new Set;const t=Ci(ua.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach(t=>{pi(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(ca.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=Di(e,this._loop?this._loopStart:0),e=this._loop?Di(e,this._loopStart):Di(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach(e=>{this._startNote(e,n,t)})}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new jo(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new jo(this.context,e))):t.startOffset>=n&&t.start(new jo(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(e=>{e.stop(t)}),this}at(t,e){const n=new _o(this.context,t).toTicks(),s=new jo(this.context,1).toSeconds(),i=this._events.values();let o=i.next();for(;!o.done;){const t=o.value;if(Math.abs(n-t.startOffset)<s)return ci(e)&&(t.value=e),t;o=i.next()}return ci(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let s;return e instanceof ca?(s=e,s.callback=this._tick.bind(this)):s=new ca({callback:this._tick.bind(this),context:this.context,value:e}),s.startOffset=n,s.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(s),this._restartEvent(s),this}_restartEvent(t){this._state.forEach(e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new jo(this.context,e.time))})}remove(t,e){return li(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach(n=>{n.startOffset===t&&(ai(e)||ci(e)&&n.value===e)&&(this._events.delete(n),n.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof ua?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(n=>{n[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new jo(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new jo(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*la(t){let e=0;for(;e<t.length;)e=fa(e,t),yield t[e],e++}function*da(t){let e=t.length-1;for(;e>=0;)e=fa(e,t),yield t[e],e--}function*pa(t,e){for(;;)yield*e(t)}function fa(t,e){return Fi(t,0,e.length-1)}function*ma(t,e){let n=e?0:t.length-1;for(;;)n=fa(n,t),yield t[n],e?(n++,n>=t.length-1&&(e=!1)):(n--,n<=0&&(e=!0))}function*_a(t){let e=0,n=0;for(;e<t.length;)e=fa(e,t),yield t[e],n++,e+=n%2?2:-1}function*ga(t){let e=t.length-1,n=0;for(;e>=0;)e=fa(e,t),yield t[e],n++,e+=n%2?-2:1}function*ya(t){const e=[];for(let n=0;n<t.length;n++)e.push(n);for(;e.length>0;){const n=fa(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[n]}}function*va(t,e="up",n=0){switch(ti(t.length>0,"The array must have more than one value in it"),e){case"up":yield*pa(t,la);case"down":yield*pa(t,da);case"upDown":yield*ma(t,!0);case"downUp":yield*ma(t,!1);case"alternateUp":yield*pa(t,_a);case"alternateDown":yield*pa(t,ga);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*pa(t,ya);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class xa extends ha{constructor(){super(Ci(xa.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=Ci(xa.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=va(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(ha.getDefaults(),{pattern:"up",values:[],callback:Qi})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=va(this._values,this._type)}}class ba extends ca{constructor(){super(Ci(ba.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new ua({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=Ci(ba.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(Oi(ca.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new jo(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,n)=>(fi(e)&&isFinite(parseInt(e,10))&&pi(n)?t[e]=this._createSequence(n):t[e]=n,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach((t,s)=>{const i=s*e+n;if(pi(t))this._rescheduleSequence(t,e/t.length,i);else{const e=new jo(this.context,i,"i").toSeconds();this._part.add(e,t)}})}_indexTime(t){return new jo(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class wa extends bo{constructor(){super(Object.assign(Ci(wa.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Ar({context:this.context}),this.a=new So({context:this.context,gain:0}),this.b=new So({context:this.context,gain:0}),this.output=new So({context:this.context}),this._internalChannels=[this.a,this.b];const t=Ci(wa.getDefaults(),arguments,["fade"]);this.fade=new Co({context:this.context,units:"normalRange",value:t.fade}),Gi(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",To(this._split,this.a.gain,0),To(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(bo.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Ta extends bo{constructor(t){super(t),this.name="Effect",this._dryWet=new wa({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new So({context:this.context}),this.effectReturn=new So({context:this.context}),this.input=new So({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Gi(this,"wet")}static getDefaults(){return Object.assign(bo.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Ma extends Ta{constructor(t){super(t),this.name="LFOEffect",this._lfo=new vr({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,Gi(this,["frequency","depth"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Sa extends Ma{constructor(){super(Ci(Sa.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=Ci(Sa.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Wr(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Ma.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Aa extends bo{constructor(){super(Object.assign(Ci(Aa.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Ci(Aa.getDefaults(),arguments,["pan"]);this.pan=new xo({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Gi(this,"pan")}static getDefaults(){return Object.assign(bo.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class ka extends Ma{constructor(){super(Ci(ka.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=Ci(ka.getDefaults(),arguments,["frequency"]);this._panner=new Aa({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Ma.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class Ca extends bo{constructor(){super(Ci(Ca.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=Ci(Ca.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new Sr({context:this.context}),this._lowpass=this.output=new sa({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(bo.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Da extends Ta{constructor(){super(Ci(Da.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=Ci(Da.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new Ca({context:this.context,smoothing:t.follower}),this._sweepRange=new Er({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new So({context:this.context}),this._bandpass=new Wr({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Wr({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,Gi(this,["gain","Q"])}static getDefaults(){return Object.assign(Ta.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return no(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/eo(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}ta("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Oa extends Ta{constructor(){super(Ci(Oa.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=Ci(Oa.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new Pa({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Ta.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class Pa extends ea{constructor(){super(Ci(Pa.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=Ci(Pa.getDefaults(),arguments);this.input=new So({context:this.context}),this.output=new So({context:this.context}),this.bits=new xo({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(ea.getDefaults(),{bits:12})}_audioWorkletName(){return"bit-crusher"}onReady(t){wo(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class Ea extends Ta{constructor(){super(Ci(Ea.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=Ci(Ea.getDefaults(),arguments,["order"]);this._shaper=new rr({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap(e=>this._getCoefficient(e,t,new Map))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Ra extends bo{constructor(){super(Ci(Ra.getDefaults(),arguments,["channels"])),this.name="Split";const t=Ci(Ra.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(bo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Ia extends bo{constructor(){super(Ci(Ia.getDefaults(),arguments,["channels"])),this.name="Merge";const t=Ci(Ia.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(bo.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class qa extends bo{constructor(t){super(t),this.name="StereoEffect",this.input=new So({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new wa({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new Ra({context:this.context,channels:2}),this._merge=new Ia({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Gi(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),wo(...t),To(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),wo(...t),To(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(bo.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Fa extends qa{constructor(t){super(t),this.feedback=new Co({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new So({context:this.context}),this._feedbackR=new So({context:this.context}),this._feedbackSplit=new Ra({context:this.context,channels:2}),this._feedbackMerge=new Ia({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Gi(this,["feedback"])}static getDefaults(){return Object.assign(qa.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class Va extends Fa{constructor(){super(Ci(Va.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=Ci(Va.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new vr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new vr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Io({context:this.context}),this._delayNodeR=new Io({context:this.context}),this.frequency=this._lfoL.frequency,Gi(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(Fa.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Na extends Ta{constructor(){super(Ci(Na.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=Ci(Na.getDefaults(),arguments,["distortion"]);this._shaper=new rr({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(Ta.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,n=Math.PI/180;this._shaper.setMap(t=>Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class ja extends Ta{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new So({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Gi(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Ta.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class La extends ja{constructor(){super(Ci(La.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=Ci(La.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Io({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Gi(this,"delayTime")}static getDefaults(){return Object.assign(ja.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class za extends bo{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new So({context:this.context}),this.output=new So({context:this.context}),this.offset90=new So({context:this.context});this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),wo(this.input,...this._bank0,this._oneSampleDelay,this.output),wo(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map(t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])})}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach(t=>t.disconnect()),this._bank1.forEach(t=>t.disconnect()),this._oneSampleDelay.disconnect(),this}}class Ba extends Ta{constructor(){super(Ci(Ba.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=Ci(Ba.getDefaults(),arguments,["frequency"]);this.frequency=new Co({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new sr({context:this.context,type:"sine"}),this._cosine=new ir({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new cr({context:this.context}),this._cosineMultiply=new cr({context:this.context}),this._negate=new kr({context:this.context}),this._add=new _r({context:this.context}),this._phaseShifter=new za({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(Ta.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Wa=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Ua=[225,556,441,341];class Ga extends qa{constructor(){super(Ci(Ga.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=Ci(Ga.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new Co({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Ua.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._allpassFiltersR=Ua.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._combFilters=Wa.map((e,n)=>{const s=new ia({context:this.context,dampening:t.dampening,delayTime:e});return n<Wa.length/2?this.connectEffectLeft(s,...this._allpassFiltersL):this.connectEffectRight(s,...this._allpassFiltersR),this.roomSize.connect(s.resonance),s}),Gi(this,["roomSize"])}static getDefaults(){return Object.assign(qa.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach(e=>e.dampening=t)}dispose(){return super.dispose(),this._allpassFiltersL.forEach(t=>t.disconnect()),this._allpassFiltersR.forEach(t=>t.disconnect()),this._combFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this}}const Ya=[.06748,.06404,.08212,.09004],Qa=[.773,.802,.753,.733],Za=[347,113,37];class Xa extends qa{constructor(){super(Ci(Xa.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=Ci(Xa.getDefaults(),arguments,["roomSize"]);this.roomSize=new Co({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new gr({context:this.context,min:-.733,max:.197}),this._allpassFilters=Za.map(t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e}),this._feedbackCombFilters=Ya.map((t,e)=>{const n=new na({context:this.context,delayTime:t});return this._scaleRoomSize.connect(n.resonance),n.resonance.value=Qa[e],e<Ya.length/2?this.connectEffectLeft(...this._allpassFilters,n):this.connectEffectRight(...this._allpassFilters,n),n}),this.roomSize.connect(this._scaleRoomSize),Gi(this,["roomSize"])}static getDefaults(){return Object.assign(qa.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach(t=>t.disconnect()),this._feedbackCombFilters.forEach(t=>t.dispose()),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class Ha extends Fa{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),Gi(this,["feedback"])}}class $a extends Ha{constructor(){super(Ci($a.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=Ci($a.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new Io({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new Io({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new Io({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new Co({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),Gi(this,["delayTime"])}static getDefaults(){return Object.assign(Ha.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Ja extends ja{constructor(){super(Ci(Ja.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=Ci(Ja.getDefaults(),arguments,["pitch"]);this._frequency=new Co({context:this.context}),this._delayA=new Io({maxDelay:1,context:this.context}),this._lfoA=new vr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Io({maxDelay:1,context:this.context}),this._lfoB=new vr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new wa({context:this.context}),this._crossFadeLFO=new vr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Io({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,Gi(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(ja.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=so(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=so(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Ka extends qa{constructor(){super(Ci(Ka.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=Ci(Ka.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new vr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new vr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new Co({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),Gi(this,["frequency","Q"])}static getDefaults(){return Object.assign(qa.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const n=[];for(let s=0;s<t;s++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),n.push(t)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(t=>t.disconnect()),this._filtersR.forEach(t=>t.disconnect()),this.frequency.dispose(),this}}class tc extends Ta{constructor(){super(Ci(tc.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=Ci(tc.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Ta.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){ei(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){ei(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return vi(this,void 0,void 0,(function*(){const t=this.ready,e=new Xi(2,this._decay+this._preDelay,this.context.sampleRate),n=new Jo({context:e}),s=new Jo({context:e}),i=new Ia({context:e});n.connect(i,0,0),s.connect(i,0,1);const o=new So({context:e}).toDestination();i.connect(o),n.start(0),s.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const r=e.render();return this.ready=r.then(Qi),yield t,this._convolver.buffer=(yield r).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class ec extends bo{constructor(){super(Ci(ec.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Ra({channels:2,context:this.context}),this._midAdd=new _r({context:this.context}),this.mid=new cr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Cr({context:this.context}),this.side=new cr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class nc extends bo{constructor(){super(Ci(nc.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new So({context:this.context}),this.side=new So({context:this.context}),this._left=new _r({context:this.context}),this._leftMult=new cr({context:this.context,value:Math.SQRT1_2}),this._right=new Cr({context:this.context}),this._rightMult=new cr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Ia({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class sc extends Ta{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new nc({context:this.context}),this._midSideSplit=new ec({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class ic extends sc{constructor(){super(Ci(ic.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=Ci(ic.getDefaults(),arguments,["width"]);this.width=new Co({context:this.context,value:t.width,units:"normalRange"}),Gi(this,["width"]),this._twoTimesWidthMid=new cr({context:this.context,value:2}),this._twoTimesWidthSide=new cr({context:this.context,value:2}),this._midMult=new cr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Cr({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),To(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new cr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(sc.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class oc extends qa{constructor(){super(Ci(oc.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=Ci(oc.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new vr({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new vr({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new So({context:this.context}),this._amplitudeR=new So({context:this.context}),this.frequency=new Co({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new Co({context:this.context,value:t.depth,units:"normalRange"}),Gi(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(qa.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class rc extends Ta{constructor(){super(Ci(rc.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=Ci(rc.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new Io({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new vr({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,Gi(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Ta.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ac extends bo{constructor(){super(Ci(ac.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=Ci(ac.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new So({context:this.context}),this._split=new Ra({context:this.context,channels:t.channels}),this.input.connect(this._split),ei(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(bo.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)}),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)})}get channels(){return this._analysers.length}get type(){return this._type}set type(t){ti("waveform"===t||"fft"===t,"Analyser: invalid type: "+t),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t)}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this}}class cc extends bo{constructor(){super(Ci(cc.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new ac({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class hc extends cc{constructor(){super(Ci(hc.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=Ci(hc.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new ac({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(cc.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return ri("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(t=>{const e=t.reduce((t,e)=>t+e*e,0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:no(this._rms)});return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class uc extends cc{constructor(){super(Ci(uc.getDefaults(),arguments,["size"])),this.name="FFT";const t=Ci(uc.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(bo.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?eo(t):t)}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return ti(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than "+this.size),t*this.context.sampleRate/(2*this.size)}}class lc extends cc{constructor(){super(Ci(lc.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class dc extends cc{constructor(){super(Ci(dc.getDefaults(),arguments,["size"])),this.name="Waveform";const t=Ci(dc.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(cc.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class pc extends bo{constructor(){super(Ci(pc.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Ci(pc.getDefaults(),arguments,["solo"]);this.input=this.output=new So({context:this.context}),pc._allSolos.has(this.context)||pc._allSolos.set(this.context,new Set),pc._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(bo.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),pc._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){pc._soloed.has(this.context)||pc._soloed.set(this.context,new Set),pc._soloed.get(this.context).add(this)}_removeSolo(){pc._soloed.has(this.context)&&pc._soloed.get(this.context).delete(this)}_isSoloed(){return pc._soloed.has(this.context)&&pc._soloed.get(this.context).has(this)}_noSolos(){return!pc._soloed.has(this.context)||pc._soloed.has(this.context)&&0===pc._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),pc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}pc._allSolos=new Map,pc._soloed=new Map;class fc extends bo{constructor(){super(Ci(fc.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Ci(fc.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Aa({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Uo({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Gi(this,["pan","volume"])}static getDefaults(){return Object.assign(bo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class mc extends bo{constructor(){super(Ci(mc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Ci(mc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new pc({solo:t.solo,context:this.context}),this._panVol=this.output=new fc({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Gi(this,["pan","volume"])}static getDefaults(){return Object.assign(bo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return mc.buses.has(t)||mc.buses.set(t,new So({context:this.context})),mc.buses.get(t)}send(t,e=0){const n=this._getBus(t),s=new So({context:this.context,units:"decibels",gain:e});return this.connect(s),s.connect(n),s}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}mc.buses=new Map;class _c extends bo{constructor(){super(Ci(_c.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new So({context:this.context}),this.output=void 0,this.low=new Wr({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Wr({context:this.context,frequency:0,type:"highpass"}),this.mid=new Wr({context:this.context,frequency:0,type:"lowpass"}),this.high=new Wr({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=Ci(_c.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new Co({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new Co({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new Co({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Gi(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(bo.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Yi(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class gc extends bo{constructor(){super(...arguments),this.name="Listener",this.positionX=new xo({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new xo({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new xo({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new xo({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new xo({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new xo({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new xo({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new xo({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new xo({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(bo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ji(t=>{t.listener=new gc({context:t})}),zi(t=>{t.listener.dispose()});class yc extends bo{constructor(){super(Ci(yc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=Ci(yc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new xo({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new xo({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new xo({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new xo({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new xo({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new xo({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(bo.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class vc extends bo{constructor(){super(Ci(vc.getDefaults(),arguments)),this.name="Recorder";const t=Ci(vc.getDefaults(),arguments);this.input=new So({context:this.context}),ti(vc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return bo.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==_i&&Reflect.has(_i,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return vi(this,void 0,void 0,(function*(){ti("started"!==this.state,"Recorder is already started");const t=new Promise(t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)});return this._recorder.start(),yield t}))}stop(){return vi(this,void 0,void 0,(function*(){ti("stopped"!==this.state,"Recorder is not started");const t=new Promise(t=>{const e=n=>{this._recorder.removeEventListener("dataavailable",e,!1),t(n.data)};this._recorder.addEventListener("dataavailable",e,!1)});return this._recorder.stop(),yield t}))}pause(){return ti("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class xc extends bo{constructor(){super(Ci(xc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=Ci(xc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new xo({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new xo({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new xo({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new xo({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new xo({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),Gi(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(bo.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class bc extends bo{constructor(){super(Object.assign(Ci(bc.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=Ci(bc.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Ca({context:this.context,smoothing:t.smoothing}),this._gt=new Or({context:this.context,value:eo(t.threshold)}),this.input=new So({context:this.context}),this._gate=this.output=new So({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(bo.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return no(this._gt.value)}set threshold(t){this._gt.value=eo(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class wc extends bo{constructor(){super(Object.assign(Ci(wc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=Ci(wc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new xc({context:this.context,ratio:20,attack:0,release:0,threshold:t.threshold}),this.threshold=this._compressor.threshold,Gi(this,"threshold")}static getDefaults(){return Object.assign(bo.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class Tc extends bo{constructor(){super(Object.assign(Ci(Tc.getDefaults(),arguments))),this.name="MidSideCompressor";const t=Ci(Tc.getDefaults(),arguments);this._midSideSplit=this.input=new ec({context:this.context}),this._midSideMerge=this.output=new nc({context:this.context}),this.mid=new xc(Object.assign(t.mid,{context:this.context})),this.side=new xc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),Gi(this,["mid","side"])}static getDefaults(){return Object.assign(bo.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class Mc extends bo{constructor(){super(Object.assign(Ci(Mc.getDefaults(),arguments))),this.name="MultibandCompressor";const t=Ci(Mc.getDefaults(),arguments);this._splitter=this.input=new _c({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new So({context:this.context}),this.low=new xc(Object.assign(t.low,{context:this.context})),this.mid=new xc(Object.assign(t.mid,{context:this.context})),this.high=new xc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),Gi(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(bo.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class Sc extends bo{constructor(){super(Ci(Sc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new So({context:this.context}),this._internalChannels=[];const t=Ci(Sc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new _c({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new So({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new So({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new So({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Gi(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(bo.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Yi(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class Ac extends bo{constructor(){super(Ci(Ac.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=Ci(Ac.getDefaults(),arguments,["url","onload"]);this._buffer=new Zi(t.url,e=>{this.buffer=e,t.onload()}),this.input=new So({context:this.context}),this.output=new So({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(bo.getDefaults(),{normalize:!0,onload:Qi})}load(t){return vi(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function kc(){return Ji().now()}function Cc(){return Ji().immediate()}const Dc=Ji().transport;function Oc(){return Ji().transport}const Pc=Ji().destination,Ec=Ji().destination;function Rc(){return Ji().destination}const Ic=Ji().listener;function qc(){return Ji().listener}const Fc=Ji().draw;function Vc(){return Ji().draw}const Nc=Ji();function jc(){return Zi.loaded()}const Lc=Zi,zc=Fo,Bc=$o;var Wc=n(8),Uc=n.n(Wc);window.Tone=o;var Gc=document.getElementById("btn");console.log(Uc.a);new Uc.a.Session;Gc.addEventListener("click",(function(){Uc.a.clip({instrument:"PolySynth",pattern:"[xx][xR]".repeat(4),notes:Uc.a.arp({chords:"Dm BbM Am FM BbM FM CM Gm",count:8,order:"1032"})}).start(),Nc.resume().then((function(){return Dc.start()}))}))}]);